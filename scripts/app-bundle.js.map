{"version":3,"sources":["src/app.js","src/environment.js","src/main.js","src/rest-service.js","src/frame/frame-service.js","src/layouts/frame-admin-panel-layout.js","src/mattype/mattype-service.js","src/personalization/frame-canvas.js","src/picture/picture-service.js","src/resources/index.js","src/services/frame-service.js","src/services/picture-service.js","src/services/rest-service.js","src/services/session-service.js","src/services/user-service.js","src/user/user-service.js","src/components/frame/frame-detail-modal.js","src/components/frame/frame-gallery.js","src/components/frame/frame-list.js","src/components/frame/frame-thumbnail.js","src/components/frame/frame-update-data-form.js","src/components/frame/frame-upload-form.js","src/components/picture/canvas-test.js","src/components/picture/interact.js","src/components/picture/picture-test.js","src/components/picture/picture-upload.js","src/components/user/user-list.js","src/components/user/user-login.js","src/components/user/user-registration.js","src/frame/gallery/frame-gallery.js","src/frame/gallery/frame-thumbnail.js","src/frame/personalization/frame-list.js","src/layouts/main/login-modal.js","src/layouts/main/nav-bar.js","src/layouts/main/registration-modal.js","src/mattype/personalization/mattype-list.js","src/user/admin/user-list.js"],"names":["App","sessionService","configureRouter","config","router","options","pushState","title","map","route","moduleId","name","debug","testing","authenticationChangedEventName","currentUserRetrievedEventName","webApiUrl","webApiUserRegistrationPath","webApiUserLoginPath","webApiCurrentUserPath","webApiUsersPath","webApiPicturesPath","webApiFramesPath","webApiMattypesPath","configure","aurelia","use","standardConfiguration","feature","plugin","developmentLogging","start","then","setRoot","RestService","eventAggregator","httpClient","x","withBaseUrl","subscribeToAuthenticationEvent","subscribe","console","log","authState","token","authenticated","setAuthorizationHeader","authorizationHeader","withHeader","getClient","FrameService","restService","getFrames","page","size","_self","promise","Promise","resolve","reject","createRequest","asGet","withTimeout","withParams","send","success","statusCode","JSON","parse","response","getFrame","id","getFramesCount","FrameAdminPanelLayout","MattypeService","getMattypes","getMattype","getMattypesCount","FrameCanvas","PictureService","getPicture","uniquePictureName","originalSize","uniqueName","original","postPicture","file","formatName","onProgress","formData","FormData","append","asPost","withContent","withProgressCallback","evt","pageNumber","pageSize","timeout","postFrame","frame","deleteFrame","asDelete","restClient","isOriginalSize","putPicture","SessionService","init","getCookie","publishSessionChanged","fetchCurrentSessionUser","setCookie","cookieName","cookieValue","expirationDays","date","Date","setDate","getDate","expires","toUTCString","document","cookie","nameEQ","ca","split","i","length","c","charAt","substring","indexOf","login","userCredentials","headers","authorization","value","saveAuthorizationCookie","logout","publish","authenticaed","publishUserChanged","user","UserService","getUsers","getUser","postUser","getUsersCount","getCurrentUser","FrameDetailModal","FrameGallery","frameService","pictureService","frames","framesPerRow","error","isWorking","created","updateFrameList","concat","frameResponse","frameRows","Math","ceil","forEach","picture","imageKey","pictureResponse","failure","description","FrameList","showDetails","frameId","selectedFrame","imageUrl","frameDetailsViewModel","stringify","FrameThumbnail","attached","setHasLoaded","hasLoaded","FrameUpdateDataForm","of","validationController","serverError","validateTrigger","manual","ensure","required","withMessage","satisfies","on","upload","imageFiles","validate","validation","valid","setTimeout","FrameUploadForm","doUpload","imageUniqueName","imageFormatName","doUploadFrame","failureMessage","height","width","price","CanvasTest","rangeVal","showVal","recolor","rgbToHsl","drawImage","ctx","canvas","getContext","img","Image","crossOrigin","onload","src","colorshift","imgData","getImageData","data","red","green","blue","alpha","hsl","hue","h","newRgb","hslToRgb","s","l","r","g","b","putImageData","max","min","d","hue2rgb","p","q","t","round","realWindow","window","el","createTextNode","ownerDocument","wrap","DocumentFragment","blank","SVGElement","SVGSVGElement","SVGElementInstance","HTMLElement","Element","PointerEvent","MSPointerEvent","pEventTypes","hypot","y","sqrt","tmpXY","documents","interactables","interactions","dynamicDrop","delegatedEvents","defaultOptions","base","accept","actionChecker","styleCursor","preventDefault","origin","deltaSource","allowFrom","ignoreFrom","_context","dropChecker","drag","enabled","manualStart","Infinity","maxPerElement","snap","restrict","inertia","autoScroll","axis","drop","overlap","resize","square","preserveAspectRatio","margin","NaN","edges","invert","gesture","perAction","endOnly","range","targets","offsets","relativePoints","container","speed","resistance","minSpeed","endSpeed","allowResume","zeroResumeDelta","smoothEndDuration","_holdDuration","interaction","scroll","target","prepared","getWindow","element","now","getTime","dtx","prevTimeX","dty","prevTimeY","vx","vy","sx","sy","velocity","isWindow","scrollBy","scrollLeft","scrollTop","isScrolling","cancelFrame","reqFrame","stop","supportsTouch","DocumentTouch","supportsPointerEvent","pointerMoveTolerance","prevTouchTime","maxInteractions","actionCursors","all","atob","resizex","resizey","resizexy","resizetop","resizeleft","resizebottom","resizeright","resizetopleft","resizebottomright","resizetopright","resizebottomleft","actionIsEnabled","wheelEvent","eventTypes","globalEvents","isOperaMobile","navigator","appName","userAgent","match","isIOS7","test","platform","appVersion","prefixedMatchesSelector","prototype","ie8MatchesSelector","requestAnimationFrame","cancelAnimationFrame","events","useAttachEvent","addEvent","removeEvent","elements","attachedListeners","add","type","listener","useCapture","elementIndex","typeCount","push","supplied","wrapped","useCount","contains","ret","listeners","listenerIndex","event","immediatePropagationStopped","srcElement","currentTarget","preventDef","stopPropagation","stopProp","stopImmediatePropagation","stopImmProp","pageX","clientX","documentElement","pageY","clientY","Boolean","remove","hasOwnProperty","len","splice","returnValue","cancelBubble","_elements","_targets","_attachedListeners","isElement","o","_window","nodeType","nodeName","thing","Window","isDocFrag","isArray","isObject","undefined","isFunction","isNumber","isBool","isString","trySelector","querySelector","extend","dest","source","prop","prefixedPropREs","webkit","pointerExtend","deprecated","vendor","copyCoords","client","timeStamp","setEventXY","targetObj","pointers","pointer","pointerAverage","getPageXY","getClientXY","setEventDeltas","prev","cur","dt","isNativePointer","Event","Touch","getXY","xy","scrollX","scrollY","getScrollXY","win","getPointerId","pointerId","identifier","getActualElement","correspondingUseElement","node","rootNode","defaultView","parentWindow","getElementClientRect","clientRect","getBoundingClientRect","getClientRects","left","right","top","bottom","getElementRect","getTouchPair","touches","changedTouches","average","screenX","screenY","touchBBox","minX","minY","maxX","maxY","touchDistance","sourceX","sourceY","dx","dy","touchAngle","prevAngle","angle","atan","PI","dr","drClamped","getOriginXY","interactable","parentElement","getRect","closest","_getQBezierValue","p1","p2","p3","iT","getQuadraticCurvePoint","startX","startY","cpX","cpY","endX","endY","position","easeOutQuad","nodeContains","parent","child","parentNode","selector","matchesSelector","host","inContext","testIgnore","interactableElement","matchesUpTo","testAllow","checkAxis","thisAxis","checkSnap","action","checkRestrict","checkAutoScroll","withinInteractionLimit","maxActions","activeInteractions","targetCount","targetElementCount","otherAction","active","interacting","indexOfDeepestElement","dropzone","deepestZone","index","deepestZoneParents","dropzoneParents","n","unshift","ownerSVGElement","parents","lastChild","previousSibling","Interaction","dropTarget","dropElement","prevDropTarget","prevDropElement","matches","matchElements","inertiaStatus","smoothEnd","ending","startEvent","upCoords","xe","ye","t0","vx0","vys","duration","resumeDx","resumeDy","lambda_v0","one_ve_v0","Function","bind","boundInertiaFrame","inertiaFrame","boundSmoothEndFrame","smoothEndFrame","that","activeDrops","dropzones","rects","pointerIds","downTargets","downTimes","holdTimers","prevCoords","curCoords","startCoords","pointerDelta","downEvent","downPointer","_eventTarget","_curEventTarget","prevEvent","tapTime","prevTap","startOffset","restrictOffset","snapOffsets","startDistance","prevDistance","distance","scale","startAngle","snapStatus","realX","realY","snappedX","snappedY","locked","changed","restrictStatus","restrictedX","restrictedY","restricted","pointerIsDown","pointerWasMoved","gesturing","dragging","resizing","resizeAxes","mouse","ptr","pointerOver","eventTarget","curMatches","curMatchElements","prevTargetElement","addPointer","elementInteractable","get","elementAction","validateAction","getAction","pushCurMatches","forEachSelector","validateSelector","pointerHover","move","curEventTarget","_doc","style","cursor","getActionCursor","checkAndPreventDefault","pointerOut","selectorDown","eventCopy","pointerIndex","pointerHold","collectEventTargets","pushMatches","context","querySelectorAll","pointerDown","forceAction","_element","newAction","setModifications","coords","preEnd","shouldMove","shouldSnap","shouldRestrict","setSnapping","setRestriction","setStartOffsets","rect","snapOffset","offset","elementRect","pointerMove","pageUp","clientUp","inertiaPosition","recordPointer","duplicateMove","clearTimeout","InteractEvent","absX","abs","absY","targetAxis","thisInteraction","getDraggable","selectorInteractable","starting","autoScrollMove","dragStart","dragEvent","fire","setActiveDrops","dropEvents","getDropEvents","activate","fireActiveDrops","dragMove","draggableElement","getDrop","leave","enter","resizeStart","resizeEvent","startRect","linkedEdges","_linkedEdges","resizeStartAspectRatio","resizeRects","current","previous","delta","deltaRect","resizeMove","invertible","originalEdges","swap","edge","gestureStart","gestureEvent","ds","gestureMove","isNaN","pointerUp","pointerEnd","removePointer","pointerCancel","ie8Dblclick","endEvent","inertiaOptions","pointerSpeed","inertiaPossible","endSnap","endRestrict","snapRestrict","vy0","v0","calcInertia","statusObject","useStatusXY","modifiedXe","modifiedYe","deactivate","collectDrops","drops","dropElements","j","currentElement","prevElement","dragElement","possibleDrops","validDrops","dropCheck","dropIndex","pointerEvent","relatedTarget","draggable","dragLeave","prevDropzone","dragEnter","dragmove","currentAction","clearTargets","lambda","te","progress","exp","quadPoint","eventType","collectSelectors","els","_iEvents","interact","isSet","firePointers","interval","createNewDoubleTap","preventOriginalDefault","originalEvent","originalPointer","pointerType","double","propagationStopped","doubleTap","matchElement","pageCoords","status","relIndex","relative","inRange","snapChanged","restriction","prevent","inertiaDur","x0","y0","innerWidth","innerHeight","_updateEventTargets","getInteractionFromPointer","mouseEvent","doOnInteractions","method","path","phase","related","clientX0","clientY0","ctrlKey","altKey","shiftKey","metaKey","button","buttons","detail","axes","box","da","prevScale","velocityX","velocityY","atan2","up","down","swipe","cursorKey","edgeNames","checkResizeEdge","defaultActionChecker","shouldResize","resizeEdges","resizeOptions","actionName","interactionListeners","delegateListener","fakeEvent","delegated","selectors","contexts","delegateUseCapture","call","indexOfElement","interactableGet","callback","Interactable","Node","listenToDocument","set","setOnEvents","phases","ondrop","ondropactivate","ondropdeactivate","ondragenter","ondragleave","ondropmove","onstart","onmove","onend","oninertiastart","setPerAction","option","checker","dropped","dropOverlap","horizontal","vertical","dragRect","cx","cy","overlapArea","overlapRatio","newValue","resizable","squareResize","gesturable","actions","setOptions","thisOption","mode","createSnapGrid","gridOffset","grid","anchors","paths","elementOrigin","allActions","rectCheck","rectChecker","iEvent","onEvent","funcName","search","trim","off","eventList","matchFound","fn","useCap","methods","perActions","settings","setting","unset","warnOnce","message","warned","warn","apply","arguments","enableDragging","enableResizing","enableGesturing","downTime","getPointerAverage","getTouchBBox","getTouchDistance","getTouchAngle","newvalue","offsetX","offsetY","gridx","gridy","newX","newY","endAllInteractions","doc","over","out","cancel","frameElement","parentDoc","windowParentError","array","nodeList","replace","limit","elems","lastTime","vendors","currTime","timeToCall","exports","module","define","amd","PictureTest","pictureUrl","isLoaded","dragMoveListener","textEl","textContent","parseFloat","getAttribute","webkitTransform","transform","setAttribute","PictureUpload","selectedFiles","clearFiles","getElementById","UserList","userService","updateUserList","users","userResponse","UserLogin","email","password","resetFields","modalId","doLogin","username","result","$","modal","UserRegistration","firstName","lastName","minLength","register","LoginModal","NavBar","RegistrationModal","MattypeList","mattypeService","mattypes","updateMattypeList","mattypeResponse","currentPage","hasPreviousPage","hasNextPage","loadPage","working","doLoadPage","count","fail"],"mappings":"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","file":"app-bundle.js","sourcesContent":["import { inject } from 'aurelia-framework';\r\nimport { SessionService } from './services/session-service';\r\n\r\n@inject(SessionService)\r\nexport class App {\r\n\tconstructor(sessionService) {\r\n\t\tthis.sessionService = sessionService;\r\n\t}\r\n\r\n\tconfigureRouter(config, router) {\r\n\t\tconfig.options.pushState = true;\r\n\t\tconfig.title = 'WeFrame';\r\n\t\tconfig.map([\r\n\t\t\t{\r\n\t\t\t\troute: ['', '/'],\r\n\t\t\t\tmoduleId: './user/admin/user-list',\r\n\t\t\t\ttitle: 'Usuarios',\r\n\t\t\t\tname: 'index'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\troute: 'frame-gallery',\r\n\t\t\t\tmoduleId: './frame/gallery/frame-gallery',\r\n\t\t\t\ttitle: 'Galeria de marcos',\r\n\t\t\t\tname: 'frame-gallery'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\troute: 'frame-admin-list',\r\n\t\t\t\tmoduleId: './components/frame/frame-list',\r\n\t\t\t\ttitle: 'Panel de administrador',\r\n\t\t\t\tname: 'frame-admin-list'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\troute: 'frame-admin',\r\n\t\t\t\tmoduleId: './layouts/frame-admin-panel-layout',\r\n\t\t\t\ttitle: 'Panel de administrador',\r\n\t\t\t\tname: 'frame-admin'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\troute: 'user-admin-list',\r\n\t\t\t\tmoduleId: './components/user/user-list',\r\n\t\t\t\ttitle: 'Panel de administrador',\r\n\t\t\t\tname: 'user-admin-list'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\troute: 'frame-canvas',\r\n\t\t\t\tmoduleId: './personalization/frame-canvas',\r\n\t\t\t\ttitle: 'Personalizacion de marcos',\r\n\t\t\t\tname: 'frame-canvas'\r\n\t\t\t}\r\n\t\t]);\r\n\r\n\t\tthis.router = router;\r\n\t}\r\n}\r\n","export default {\n  debug: true,\n  testing: true,\n  // webApiUrl: 'http://weframers-franolea.rhcloud.com',\n  authenticationChangedEventName: \"authentication-changed\",\n  currentUserRetrievedEventName: \"current-user-retrieved\",\n  webApiUrl: 'http://localhost:8080',\n  webApiUserRegistrationPath: 'authentication/register',\n  webApiUserLoginPath: 'authentication/login',\n  webApiCurrentUserPath: 'authentication/me',\n  webApiUsersPath: 'users',\n  webApiPicturesPath: 'pictures',\n  webApiFramesPath: 'generic-product/frames',\n  webApiMattypesPath: 'generic-product/mat-types'\n};\n","import environment from './environment';\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources')\n    .plugin('aurelia-validation');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","import { HttpClient } from 'aurelia-http-client';\r\nimport { inject } from 'aurelia-framework';\r\nimport { EventAggregator } from 'aurelia-event-aggregator';\r\nimport environment from './environment';\r\n\r\n@inject(EventAggregator)\r\nexport class RestService {\r\n    constructor(eventAggregator) {\r\n        this.httpClient = new HttpClient()\r\n            .configure(x => {\r\n                x.withBaseUrl(environment.webApiUrl);\r\n                // x.withHeader('Authorization', '');\r\n            });\r\n\t\tthis.eventAggregator = eventAggregator;\r\n\t\tthis.subscribeToAuthenticationEvent();\r\n    }\r\n\r\n    subscribeToAuthenticationEvent() {\r\n        this.eventAggregator.subscribe(environment.authenticationChangedEventName, authState => {\r\n\t\t\tconsole.log(\"REST SERVICE NOTIFIED: \"+authState.token);\r\n\t\t\tthis.authenticated = authState.authenticated;\r\n            if(authState.token) {\r\n                this.setAuthorizationHeader(authState.token);\r\n            } else {\r\n                this.setAuthorizationHeader(null);\r\n            }\r\n\t\t});\r\n    }\r\n\r\n    setAuthorizationHeader(authorizationHeader) {\r\n        if(authorizationHeader) {\r\n            this.httpClient = new HttpClient()\r\n                .configure(x => {\r\n                x.withBaseUrl(environment.webApiUrl);\r\n                x.withHeader('Authorization', authorizationHeader);\r\n            });\r\n        } else {\r\n            this.httpClient = new HttpClient()\r\n                .configure(x => {\r\n                x.withBaseUrl(environment.webApiUrl);\r\n                // x.withHeader('Authorization', authorizationHeader);\r\n            });\r\n        }\r\n            \r\n    }\r\n\r\n    getClient() {\r\n        return this.httpClient;\r\n    }\r\n}","import { inject } from 'aurelia-framework';\r\nimport { RestService } from '../services/rest-service';\r\nimport environment from '../environment';\r\n\r\n@inject(RestService)\r\nexport class FrameService {\r\n    constructor(restService) {\r\n        this.restService = restService;\r\n    }\r\n\r\n    getFrames(page = 0, size = 10) {\r\n        console.log(\"[FrameService] Getting frames page \" + page + \" size \" + size);\r\n        var _self = this;\r\n        var promise = new Promise(function(resolve, reject) {\r\n            _self.restService.getClient().createRequest(environment.webApiFramesPath)\r\n                .asGet().withTimeout(5000)\r\n                .withParams({ page: page, size: size }).send()\r\n                .then(\r\n                    success => {\r\n                        console.log(\"[FrameService] Frame page response status \" + success.statusCode);\r\n                        if(success.statusCode == 200) {\r\n                            resolve(JSON.parse(success.response));\r\n                        } else {\r\n                            resolve([]);\r\n                        }\r\n                    },\r\n                    failure => {\r\n                        console.log(\"[FrameService] Frame page request FAILED\");\r\n                        reject();\r\n                    }\r\n                );\r\n        });\r\n        return promise;\r\n    }\r\n\r\n    getFrame(id) {\r\n        console.log(\"[FrameService] Getting frame \" + id);\r\n        var _self = this;\r\n        var promise = new Promise(function(resolve, reject) {\r\n            _self.restService.getClient().createRequest(environment.webApiFramesPath + `/${id}`)\r\n                .asGet().withTimeout(3000).send()\r\n                .then(\r\n                    success => {\r\n                        console.log(\"[FrameService] Frame response status \" + success.statusCode);\r\n                        if(success.statusCode == 200) {\r\n                            resolve(JSON.parse(success.response));\r\n                        } else {\r\n                            resolve({});\r\n                        }\r\n                    },\r\n                    failure => {\r\n                        console.log(\"[FrameService] Frame request FAILED\");\r\n                        reject();\r\n                    }\r\n                );\r\n        });\r\n    }\r\n\r\n    getFramesCount() {\r\n        console.log(\"[FrameService] Getting Frames count\");\r\n        var _self = this;\r\n        var promise = new Promise(function(resolve, reject) {\r\n            _self.restService.getClient().createRequest(environment.webApiFramesPath + `/count`)\r\n                .asGet().withTimeout(3000).send()\r\n                .then(\r\n                    success => {\r\n                        console.log(\"[FrameService] Frames count response status \" + success.statusCode);\r\n                        if(success.statusCode == 200) {\r\n                            resolve(success.response);\r\n                        } else {\r\n                            resolve({});\r\n                        }\r\n                    },\r\n                    failure => {\r\n                        console.log(\"[FrameService] Frame count request FAILED\");\r\n                        reject();\r\n                    }\r\n                );\r\n        });\r\n        return promise;\r\n    }\r\n\r\n}","export class FrameAdminPanelLayout {\r\n    \r\n}","import { inject } from 'aurelia-framework';\r\nimport { RestService } from '../services/rest-service';\r\nimport environment from '../environment';\r\n\r\n@inject(RestService)\r\nexport class MattypeService {\r\n    constructor(restService) {\r\n        this.restService = restService;\r\n    }\r\n\r\n    getMattypes(page = 0, size = 10) {\r\n        console.log(\"[MattypeService] Getting frames page \" + page + \" size \" + size);\r\n        var _self = this;\r\n        var promise = new Promise(function(resolve, reject) {\r\n            _self.restService.getClient().createRequest(environment.webApiMattypesPath)\r\n                .asGet().withTimeout(5000)\r\n                .withParams({ page: page, size: size }).send()\r\n                .then(\r\n                    success => {\r\n                        console.log(\"[MattypeService] Mattype page response status \" + success.statusCode);\r\n                        if(success.statusCode == 200) {\r\n                            resolve(JSON.parse(success.response));\r\n                        } else {\r\n                            resolve([]);\r\n                        }\r\n                    },\r\n                    failure => {\r\n                        console.log(\"[MattypeService] Mattype page request FAILED\");\r\n                        reject();\r\n                    }\r\n                );\r\n        });\r\n        return promise;\r\n    }\r\n\r\n    getMattype(id) {\r\n        console.log(\"[MattypeService] Getting frame \" + id);\r\n        var _self = this;\r\n        var promise = new Promise(function(resolve, reject) {\r\n            _self.restService.getClient().createRequest(environment.webApiMattypesPath + `/${id}`)\r\n                .asGet().withTimeout(3000).send()\r\n                .then(\r\n                    success => {\r\n                        console.log(\"[MattypeService] Mattype response status \" + success.statusCode);\r\n                        if(success.statusCode == 200) {\r\n                            resolve(JSON.parse(success.response));\r\n                        } else {\r\n                            resolve({});\r\n                        }\r\n                    },\r\n                    failure => {\r\n                        console.log(\"[MattypeService] Mattype request FAILED\");\r\n                        reject();\r\n                    }\r\n                );\r\n        });\r\n    }\r\n\r\n    getMattypesCount() {\r\n        console.log(\"[MattypeService] Getting Mattypes count\");\r\n        var _self = this;\r\n        var promise = new Promise(function(resolve, reject) {\r\n            _self.restService.getClient().createRequest(environment.webApiMattypesPath + `/count`)\r\n                .asGet().withTimeout(3000).send()\r\n                .then(\r\n                    success => {\r\n                        console.log(\"[MattypeService] Mattypes count response status \" + success.statusCode);\r\n                        if(success.statusCode == 200) {\r\n                            resolve(success.response);\r\n                        } else {\r\n                            resolve({});\r\n                        }\r\n                    },\r\n                    failure => {\r\n                        console.log(\"[MattypeService] Mattype count request FAILED\");\r\n                        reject();\r\n                    }\r\n                );\r\n        });\r\n        return promise;\r\n    }\r\n\r\n}","export class FrameCanvas {\r\n    \r\n}","import { inject } from 'aurelia-framework';\r\nimport { RestService } from '../rest-service';\r\nimport environment from '../environment';\r\n\r\n@inject(RestService)\r\nexport class PictureService {\r\n\r\n    constructor(restService) {\r\n        this.restService = restService;\r\n    }\r\n\r\n    getPicture(uniquePictureName, originalSize) {\r\n        console.log(\"[PictureService] Getting picture \" + uniquePictureName + \" original size [\" + originalSize + \"]\");\r\n        var _self = this;\r\n        var promise = new Promise(function(resolve, reject) {\r\n            _self.restService.getClient().createRequest(environment.webApiPicturesPath)\r\n                .asGet().withTimeout(5000)\r\n                .withParams({ uniqueName: uniquePictureName, original: originalSize}).send()\r\n                .then(\r\n                    success => {\r\n                        console.log(\"[PictureService] Picture response status \" + success.statusCode);\r\n                        if(success.statusCode == 200) {\r\n                            resolve(JSON.parse(success.response));\r\n                        } else {\r\n                            resolve({});\r\n                        }\r\n                    },\r\n                    failure => {\r\n                        console.log(\"[PictureService] Picture request FAILED\");\r\n                    }\r\n                );\r\n        });\r\n        return promise;\r\n    }\r\n\r\n    postPicture(uniqueName, file, formatName, onProgress) {\r\n        console.log(\"[PictureService] Posting picture \" + uniqueName);\r\n        var formData = new FormData();\r\n        formData.append('uniqueName', uniqueName);\r\n        formData.append('file', file);\r\n        formData.append('formatName', formatName);\r\n        var _self = this;\r\n        var promise = new Promise(function(resolve, reject) {\r\n            _self.restService.getClient().createRequest(environment.webApiPicturesPath)\r\n                .asPost().withTimeout(20000)\r\n                .withContent(formData)\r\n                .withProgressCallback((evt)=>console.log(evt))\r\n                .send().then(\r\n                    success => {\r\n                        console.log(\"[PictureService] Picture post response status \" + success.statusCode);\r\n                        if(success.statusCode == 200) {\r\n                            resolve(true);\r\n                        } else {\r\n                            resolve(false);\r\n                        }\r\n                    },\r\n                    failure => {\r\n                        console.log(\"[PictureService] Picture post request FAILED\");\r\n                        reject();\r\n                    }\r\n                );\r\n        });\r\n        return promise;\r\n    }\r\n}","export function configure(config) {\n  //config.globalResources([]);\n}\n","import {inject} from 'aurelia-framework';\r\nimport {RestService} from './rest-service';\r\nimport environment from '../environment';\r\n\r\n@inject(RestService)\r\nexport class FrameService {\r\n    constructor(restService) {\r\n        this.restService = restService;\r\n    }\r\n\r\n    getFrames(pageNumber, pageSize, timeout = 5000) {\r\n        return this.restService.getClient()\r\n                .createRequest(environment.webApiFramesPath)\r\n                .withHeader('page', pageNumber)\r\n                .withHeader('size', pageSize)\r\n                .asGet()\r\n                // .withTimeout(timeout)\r\n                .send()\r\n    }\r\n\r\n    getFrame(id, timeout = 2000) {\r\n        return this.restService.getClient()\r\n                .createRequest(environment.webApiFramesPath + `/${id}`)\r\n                .asGet()\r\n                .withTimeout(timeout)\r\n                .send()\r\n    }\r\n\r\n    postFrame(frame, timeout = 3000) {\r\n        return this.restService.getClient()\r\n                .createRequest(environment.webApiFramesPath)\r\n                .asPost()\r\n                .withContent(frame)\r\n                .withTimeout(timeout)\r\n                .send()\r\n    }\r\n\r\n    deleteFrame(id, timeout = 3000) {\r\n        return this.restService.getClient()\r\n                .createRequest(environment.webApiFramesPath + `/${id}`)\r\n                .asDelete()\r\n                .withTimeout(timeout)\r\n                .send();\r\n    }\r\n}","import {HttpClient} from 'aurelia-http-client';\r\nimport environment from '../environment';\r\n\r\nexport class PictureService {\r\n    constructor() {\r\n        this.restClient = new HttpClient();\r\n    }\r\n\r\n    getPicture(uniquePictureName, isOriginalSize) {\r\n        return this.restClient.createRequest(environment.webApiPicturesPath)\r\n                .asGet()\r\n                .withParams({\r\n                    uniqueName: uniquePictureName,\r\n                    original: isOriginalSize\r\n                })\r\n                .withBaseUrl(environment.webApiUrl)\r\n                .withTimeout(5000)\r\n                .send();\r\n    }\r\n\r\n    putPicture(uniqueName, file, formatName, onProgress) {\r\n        var formData = new FormData();\r\n        formData.append('uniqueName', uniqueName);\r\n        formData.append('file', file);\r\n        formData.append('formatName', formatName);\r\n\r\n        return this.restClient.createRequest(environment.webApiPicturesPath)\r\n            .asPost()\r\n            .withContent(formData)\r\n            .withBaseUrl(environment.webApiUrl)\r\n            .withProgressCallback((evt)=>console.log(evt))\r\n            .send();\r\n    }\r\n}","import { HttpClient } from 'aurelia-http-client';\r\nimport { inject } from 'aurelia-framework';\r\nimport { EventAggregator } from 'aurelia-event-aggregator';\r\nimport environment from '../environment';\r\n\r\n@inject(EventAggregator)\r\nexport class RestService {\r\n    constructor(eventAggregator) {\r\n        this.httpClient = new HttpClient()\r\n            .configure(x => {\r\n                x.withBaseUrl(environment.webApiUrl);\r\n                // x.withHeader('Authorization', '');\r\n            });\r\n\t\tthis.eventAggregator = eventAggregator;\r\n\t\tthis.subscribeToAuthenticationEvent();\r\n    }\r\n\r\n    subscribeToAuthenticationEvent() {\r\n        this.eventAggregator.subscribe(environment.authenticationChangedEventName, authState => {\r\n\t\t\tconsole.log(\"REST SERVICE NOTIFIED: \"+authState.token);\r\n\t\t\tthis.authenticated = authState.authenticated;\r\n            if(authState.token) {\r\n                this.setAuthorizationHeader(authState.token);\r\n            } else {\r\n                this.setAuthorizationHeader(null);\r\n            }\r\n\t\t});\r\n    }\r\n\r\n    setAuthorizationHeader(authorizationHeader) {\r\n        if(authorizationHeader) {\r\n            this.httpClient = new HttpClient()\r\n                .configure(x => {\r\n                x.withBaseUrl(environment.webApiUrl);\r\n                x.withHeader('Authorization', authorizationHeader);\r\n            });\r\n        } else {\r\n            this.httpClient = new HttpClient()\r\n                .configure(x => {\r\n                x.withBaseUrl(environment.webApiUrl);\r\n                // x.withHeader('Authorization', authorizationHeader);\r\n            });\r\n        }\r\n            \r\n    }\r\n\r\n    getClient() {\r\n        return this.httpClient;\r\n    }\r\n}","import {inject} from 'aurelia-framework';\r\nimport { EventAggregator } from 'aurelia-event-aggregator';\r\nimport {RestService} from './rest-service';\r\nimport environment from '../environment';\r\n\r\n@inject(RestService, EventAggregator)\r\nexport class SessionService {\r\n    \r\n    constructor(restService, eventAggregator) {\r\n        this.restService = restService;\r\n        this.eventAggregator = eventAggregator;\r\n    }\r\n\r\n    init() {\r\n        var token = this.getCookie(\"Authorization\");\r\n        if(token) {\r\n            console.log(\"TOKEN FOUND: \"+token);\r\n            this.publishSessionChanged(true, token);\r\n            this.fetchCurrentSessionUser();\r\n        }\r\n    }\r\n\r\n    setCookie(cookieName, cookieValue, expirationDays) {\r\n        var date = new Date();\r\n        date.setDate(date.getDate() + (expirationDays * 24 * 60 * 60 * 1000));\r\n        var expires = \"expires=\" + date.toUTCString();\r\n        document.cookie = cookieName + \"=\" + cookieValue + \";\" + expires + \";path=/\";\r\n    }\r\n\r\n    getCookie(cookieName) {\r\n        var nameEQ = cookieName + \"=\";\r\n        var ca = document.cookie.split(';');\r\n        for(var i=0;i < ca.length;i++) {\r\n            var c = ca[i];\r\n            while (c.charAt(0)==' ') c = c.substring(1,c.length);\r\n            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    login(userCredentials) {\r\n        var _self = this;\r\n        var promise = new Promise(function(resolve, reject) {\r\n            _self.restService.getClient()\r\n                .createRequest(environment.webApiUserLoginPath)\r\n                .asPost().withContent(userCredentials)\r\n                .send().then(\r\n                    success => {\r\n                        var token = success.headers.headers.authorization.value;\r\n                        _self.saveAuthorizationCookie(token, 1);\r\n                        _self.publishSessionChanged(true, token);\r\n                        _self.fetchCurrentSessionUser();\r\n                        resolve(true);\r\n                    },\r\n                    failure => {\r\n                        _self.publishSessionChanged(false);\r\n                        resolve(false);\r\n                    }\r\n                );\r\n        });\r\n        return promise;\r\n    }\r\n\r\n    logout() {\r\n        console.log(\"logout pressed\");\r\n        this.eventAggregator.publish(environment.authenticationChangedEventName, {\r\n            authenticaed: false,\r\n            token: null\r\n        });\r\n        this.saveAuthorizationCookie(null);\r\n    }\r\n\r\n    saveAuthorizationCookie(token, expirationDays = -1) {\r\n        this.setCookie(\r\n            \"Authorization\", \r\n            token,\r\n            expirationDays\r\n        );\r\n    }\r\n\r\n    publishSessionChanged(authenticated, token = null) {\r\n        this.eventAggregator.publish(environment.authenticationChangedEventName, {\r\n            authenticated: authenticated,\r\n            token: token\r\n        });\r\n    }\r\n\r\n    publishUserChanged(user) {\r\n        this.eventAggregator.publish(\r\n            environment.currentUserRetrievedEventName, \r\n            user\r\n        );\r\n    }\r\n\r\n    fetchCurrentSessionUser() {\r\n        this.restService.getClient()\r\n                .createRequest(environment.webApiCurrentUserPath)\r\n                .asGet()\r\n                .send()\r\n                .then(\r\n                    success => {\r\n                        if(success.statusCode == 200) {\r\n                            var user = JSON.parse(success.response);\r\n                            this.publishUserChanged(user);\r\n                        } else {\r\n                            this.publishUserChanged(null);\r\n                            this.publishSessionChanged(false);\r\n                        }\r\n                    },\r\n                    failue => {\r\n                        this.publishUserChanged(null);\r\n                        this.publishSessionChanged(false);\r\n                        this.saveAuthorizationCookie(null);\r\n                    }\r\n                );\r\n    }\r\n}","import {HttpClient} from 'aurelia-http-client';\r\nimport environment from '../environment';\r\n\r\nexport class UserService {\r\n    constructor() {\r\n        this.restClient = new HttpClient();\r\n    }\r\n\r\n    getUsers() {\r\n        return getUsers(0, 10);\r\n    }\r\n\r\n    getUsers(pageNumber, pageSize) {\r\n        return this.restClient.createRequest(environment.webApiUsersPath)\r\n                .asGet()\r\n                .withBaseUrl(environment.webApiUrl)\r\n                .withTimeout(5000)\r\n                .send()\r\n    }\r\n\r\n    getUser(id) {\r\n        return this.restClient.createRequest(environment.webApiUsersPath + `/${id}`)\r\n                .asGet()\r\n                .withBaseUrl(environment.webApiUrl)\r\n                .withTimeout(2000)\r\n                .send()\r\n    }\r\n\r\n    postUser(user) {\r\n        return this.restClient.createRequest(environment.webApiUsersPath)\r\n                .asPost()\r\n                .withBaseUrl(environment.webApiUrl)\r\n                .withContent(user)\r\n                .withTimeout(3000)\r\n                .send()\r\n    }\r\n\r\n}","import { inject } from 'aurelia-framework';\r\nimport { RestService } from '../rest-service';\r\nimport environment from '../environment';\r\n\r\n@inject(RestService)\r\nexport class UserService {\r\n\r\n    constructor(restService) {\r\n        this.restService = restService;\r\n    }\r\n\r\n    getUsers(page = 0, size = 10) {\r\n        console.log(\"[UserService] Getting users page \" + page + \" size \" + size);\r\n        var _self = this;\r\n        var promise = new Promise(function(resolve, reject) {\r\n            _self.restService.getClient().createRequest(environment.webApiUsersPath)\r\n                .asGet().withTimeout(5000)\r\n                .withParams({ page: page, size: size }).send()\r\n                .then(\r\n                    success => {\r\n                        console.log(\"[UserService] User page response status \" + success.statusCode);\r\n                        if(success.statusCode == 200) {\r\n                            resolve(JSON.parse(success.response));\r\n                        } else {\r\n                            resolve([]);\r\n                        }\r\n                    },\r\n                    failure => {\r\n                        console.log(\"[UserService] User page request FAILED\");\r\n                        reject();\r\n                    }\r\n                );\r\n        });\r\n        return promise;\r\n    }\r\n\r\n    getUser(id) {\r\n        console.log(\"[UserService] Getting user \" + id);\r\n        var _self = this;\r\n        var promise = new Promise(function(resolve, reject) {\r\n            _self.restService.getClient().createRequest(environment.webApiUsersPath + `/${id}`)\r\n                .asGet().withTimeout(3000).send()\r\n                .then(\r\n                    success => {\r\n                        console.log(\"[UserService] User response status \" + success.statusCode);\r\n                        if(success.statusCode == 200) {\r\n                            resolve(JSON.parse(success.response));\r\n                        } else {\r\n                            resolve({});\r\n                        }\r\n                    },\r\n                    failure => {\r\n                        console.log(\"[UserService] User request FAILED\");\r\n                        reject();\r\n                    }\r\n                );\r\n        });\r\n    }\r\n\r\n    getUsersCount() {\r\n        console.log(\"[UserService] Getting users count\");\r\n        var _self = this;\r\n        var promise = new Promise(function(resolve, reject) {\r\n            _self.restService.getClient().createRequest(environment.webApiUsersPath + `/count`)\r\n                .asGet().withTimeout(3000).send()\r\n                .then(\r\n                    success => {\r\n                        console.log(\"[UserService] Users count response status \" + success.statusCode);\r\n                        if(success.statusCode == 200) {\r\n                            resolve(success.response);\r\n                        } else {\r\n                            resolve({});\r\n                        }\r\n                    },\r\n                    failure => {\r\n                        console.log(\"[UserService] User count request FAILED\");\r\n                        reject();\r\n                    }\r\n                );\r\n        });\r\n        return promise;\r\n    }\r\n\r\n    getCurrentUser() {\r\n        console.log(\"[UserService] Getting current user\");\r\n        var _self = this;\r\n        var promise = new Promise(function(resolve, reject) {\r\n            _self.restService.getClient().createRequest(environment.webApiUsersPath + `/me`)\r\n                .asGet().withTimeout(3000).send()\r\n                .then(\r\n                    success => {\r\n                        console.log(\"[UserService] Current user response status \" + success.statusCode);\r\n                        if(success.statusCode == 200) {\r\n                            resolve(JSON.parse(success.response));\r\n                        } else {\r\n                            resolve({});\r\n                        }\r\n                    },\r\n                    failure => {\r\n                        console.log(\"[UserService] Current user page request FAILED\");\r\n                        reject();\r\n                    }\r\n                );\r\n        });\r\n    }\r\n\r\n    postUser(user) {\r\n        console.log(\"[UserService] Posting user\");\r\n        var _self = this;\r\n        var promise = new Promise(function(resolve, reject) {\r\n            _self.restService.getClient().createRequest(environment.webApiUsersPath)\r\n                .asPost().withContent(user).withTimeout(3000).send()\r\n                .then(\r\n                    success => {\r\n                        console.log(\"[UserService] User post response status \" + success.statusCode);\r\n                        if(success.statusCode == 200) {\r\n                            resolve(true);\r\n                        } else {\r\n                            resolve(false);\r\n                        }\r\n                    },\r\n                    failure => {\r\n                        console.log(\"[UserService] User post request FAILED\");\r\n                        reject();\r\n                    }\r\n                );\r\n        });\r\n    }\r\n}","import {bindable} from 'aurelia-framework';\r\nimport {inject} from 'aurelia-framework';\r\n\r\nexport class FrameDetailModal {\r\n    \r\n    // @bindable frame;\r\n\r\n    constructor() {\r\n    }\r\n}","import {inject} from 'aurelia-framework';\r\nimport {FrameService} from '../../services/frame-service';\r\nimport {PictureService} from '../../services/picture-service';\r\n\r\n@inject(FrameService, PictureService)\r\nexport class FrameGallery {\r\n    constructor(frameService, pictureService) {\r\n        this.frameService = frameService;\r\n        this.pictureService = pictureService;\r\n        this.frames = [];\r\n        this.framesPerRow = 6;\r\n        this.error = {};\r\n        this.isWorking = false;\r\n    }\r\n\r\n    created() {\r\n        this.updateFrameList(1,10);\r\n    }\r\n\r\n    updateFrameList(page, size) {\r\n        this.isWorking = true;\r\n        this.frameService.getFrames(page, size).then(\r\n            frameResponse => {\r\n                this.frames = this.frames.concat(JSON.parse(frameResponse.response));\r\n                this.frameRows = Math.ceil(this.frames.length / this.framesPerRow);\r\n                this.frames.forEach((frame) => {\r\n                    this.pictureService.getPicture(frame.picture.imageKey, false).then(\r\n                        (pictureResponse) => {\r\n                            frame.picture = JSON.parse(pictureResponse.response);\r\n                        },\r\n                        (failure) => {\r\n                            console.log(failure);\r\n                        }\r\n                    );\r\n                }, this);\r\n                this.isWorking = false;\r\n            }, \r\n            errorResponse => {\r\n                this.error.title = 'Ups';\r\n                this.error.description = 'Parece que el sistema no response, por favor intenta nuevamente mas tarde.';\r\n                this.isWorking = false;\r\n            }\r\n        );\r\n    }\r\n}","import {inject} from 'aurelia-framework';\r\nimport {FrameService} from '../../services/frame-service';\r\nimport {PictureService} from '../../services/picture-service';\r\n\r\n@inject(FrameService, PictureService)\r\nexport class FrameList {\r\n    constructor(frameService, pictureService) {\r\n        this.frameService = frameService;\r\n        this.pictureService = pictureService;\r\n        // this.frames = [];\r\n        this.error = {};\r\n        this.isWorking = false;\r\n    }\r\n\r\n    created() {\r\n        this.updateFrameList(0,10);\r\n    }\r\n\r\n    updateFrameList(page, size) {\r\n        this.isWorking = true;\r\n        this.frameService.getFrames(page, size)\r\n                .then(\r\n                    frameResponse => {\r\n                        this.frames = JSON.parse(frameResponse.response);\r\n                        this.isWorking = false;\r\n                    }, \r\n                    errorResponse => {\r\n                        this.error.title = 'Ups';\r\n                        this.error.description = 'Parece que el sistema no response, por favor intenta nuevamente mas tarde.';\r\n                        this.isWorking = false;\r\n                    }\r\n                );\r\n    }\r\n\r\n    showDetails(frameId) {\r\n        this.frames.forEach(function(frame) {\r\n            if(frame.id == frameId) {\r\n                this.selectedFrame = frame;\r\n                this.pictureService.getPicture(this.selectedFrame.picture.imageKey, true).then(\r\n                    (success) => {\r\n                        this.selectedFrame.picture.imageUrl = JSON.parse(success.response).imageUrl;\r\n                        this.frameDetailsViewModel.frame = JSON.parse(JSON.stringify(this.selectedFrame));\r\n                        console.log(this.frameDetailsViewModel);\r\n                    },\r\n                    (failure) => {\r\n                        console.log(failure);\r\n                    }\r\n                )\r\n            }\r\n        }, this);\r\n    }\r\n}","import {bindable} from 'aurelia-framework';\r\n\r\nexport class FrameThumbnail {\r\n\r\n    @bindable frame;\r\n\r\n    constructor() {\r\n    }\r\n\r\n    created() {\r\n    }\r\n    \r\n    attached() {\r\n        \r\n    }\r\n\r\n    setHasLoaded() {\r\n        this.hasLoaded = true;\r\n    }\r\n\r\n}","import {bindable} from 'aurelia-framework';\r\nimport {inject, NewInstance} from 'aurelia-framework';\r\nimport {ValidationController, validateTrigger, ValidationRules} from 'aurelia-validation';\r\nimport {FrameService} from '../../services/frame-service';\r\n\r\n@inject(FrameService,NewInstance.of(ValidationController))\r\nexport class FrameUpdateDataForm {\r\n    \r\n    @bindable frame;\r\n\r\n    constructor(frameService, validationController) {\r\n        this.frameService = frameService;\r\n        this.validationController = validationController;\r\n        this.isWorking = false;\r\n        this.success = false;\r\n        this.serverError = {};\r\n    }\r\n\r\n    created() {\r\n        this.validationController.validateTrigger = validateTrigger.manual;\r\n\r\n        ValidationRules\r\n            .ensure(\"frame.name\")\r\n                    .required()\r\n                    .withMessage(\"El nombre unico no puede estar vacio.\")\r\n            .ensure(\"frame.description\")\r\n                    .required()\r\n                    .withMessage(\"La descripcion no puede estar vacia.\")\r\n            .ensure(\"frame.height\")\r\n                    .required()\r\n                    .satisfies(value => value > 0)\r\n                    .withMessage(\"El alto del marco no puede estar vacio o ser menor a 0.\")\r\n            .ensure(\"frame.length\")\r\n                    .required()\r\n                    .satisfies(value => value > 0)\r\n                    .withMessage(\"El ancho del marco no puede estar vacio o ser menor a 0.\")\r\n            .ensure(\"frame.prive\")\r\n                    .required()\r\n                    .satisfies(value => value > 0)\r\n                    .withMessage(\"El precio del marco no puede estar vacio o ser menor a 0.\")\r\n            .on(this);\r\n    }\r\n\r\n    upload() {\r\n        this.success = false;\r\n        this.isWorking = true;\r\n\r\n        console.log(this.imageFiles);\r\n\r\n        this.validationController.validate().then((validation) => {\r\n            if(validation.valid) {\r\n                // this.doUpload();\r\n                setTimeout(() => {\r\n                    this.success = true;\r\n                }, 1000).then(() => this.isWorking = false);\r\n            } else {\r\n                this.isWorking = false\r\n            }\r\n        });\r\n    }\r\n\r\n}","import {inject, NewInstance} from 'aurelia-framework';\r\nimport {ValidationController, validateTrigger, ValidationRules} from 'aurelia-validation';\r\nimport {PictureService} from '../../services/picture-service';\r\nimport {FrameService} from '../../services/frame-service';\r\n\r\n@inject(PictureService,FrameService,NewInstance.of(ValidationController))\r\nexport class FrameUploadForm {\r\n\r\n    constructor(pictureService, frameService, validationController) {\r\n        this.pictureService = pictureService;\r\n        this.frameService = frameService;\r\n        this.validationController = validationController;\r\n        this.isWorking = false;\r\n        this.success = false;\r\n        this.serverError = {};\r\n    }\r\n\r\n    created() {\r\n        this.validationController.validateTrigger = validateTrigger.manual;\r\n\r\n        ValidationRules\r\n            .ensure(\"name\")\r\n                    .required()\r\n                    .withMessage(\"El nombre unico no puede estar vacio.\")\r\n            .ensure(\"uniqueName\")\r\n                    .required()\r\n                    .withMessage(\"El nombre unico no puede estar vacio.\")\r\n            .ensure(\"imageUniqueName\")\r\n                    .required()\r\n                    .withMessage(\"El nombre unico de la imagen no puede estar vacio.\")\r\n            .ensure(\"imageFile\")\r\n                    .required()\r\n                    .withMessage(\"El archivo no puede estar vacio.\")\r\n            .ensure(\"imageFormatName\")\r\n                    .required()\r\n                    .withMessage(\"El nombre del formato de archivo de imagen no puede estar vacio.\")\r\n            .on(this);\r\n    }\r\n\r\n    upload() {\r\n        this.success = false;\r\n        this.isWorking = true;\r\n\r\n        console.log(this.imageFiles);\r\n\r\n        this.validationController.validate().then((validation) => {\r\n            if(validation.valid) {\r\n                this.doUpload();\r\n                // setTimeout(() => {\r\n                //     this.success = true;\r\n                // }, 1000).then(() => this.isWorking = false);\r\n            } else {\r\n                this.isWorking = false\r\n            }\r\n        });\r\n    }\r\n\r\n    doUpload() {\r\n        return this.pictureService.putPicture(\r\n            this.imageUniqueName,\r\n            this.imageFiles[0],\r\n            this.imageFormatName,\r\n            null)\r\n            .then(\r\n                () => {\r\n                    this.doUploadFrame();\r\n                },\r\n                failure => {\r\n                    var failureMessage = JSON.parse(failure.response);\r\n                    this.serverError = {\r\n                        title: failureMessage.title,\r\n                        description: failureMessage.description\r\n                    };\r\n                }\r\n            );\r\n    }\r\n\r\n    doUploadFrame() {\r\n        var frame = {\r\n            name: this.name,\r\n            uniqueName: this.uniqueName,\r\n            description: this.description,\r\n            height: this.height,\r\n            length: this.width,\r\n            picture: {\r\n                imageKey: this.imageUniqueName\r\n            },\r\n            price: this.price\r\n        };\r\n\r\n        this.frameService.postFrame(frame).then(\r\n            () => {\r\n                this.success = true;\r\n            },\r\n            failure => {\r\n                var failureMessage = JSON.parse(failure.response);\r\n                this.serverError = {\r\n                    title: failureMessage.title,\r\n                    description: failureMessage.description\r\n                };\r\n            }\r\n        ).then(() => this.isWorking = false);\r\n    }\r\n\r\n}","import {inject} from 'aurelia-framework';\r\nimport {PictureService} from '../../services/picture-service';\r\n\r\n@inject(PictureService)\r\nexport class CanvasTest {\r\n    constructor(pictureService) {\r\n        this.pictureService = pictureService;\r\n        this.rangeVal = 0;\r\n    }\r\n\r\n    showVal() {\r\n        // console.log(this.rangeVal);\r\n        this.recolor(this.rangeVal);\r\n    }\r\n\r\n    created() {\r\n        console.log(this.rgbToHsl(0,0,0));\r\n        console.log(this.rgbToHsl(255,255,0));\r\n        console.log(this.rgbToHsl(255,255,255));\r\n        this.pictureService.getPicture('testPicture', false).then(\r\n            (success) => {\r\n                console.log('SUCCESS');\r\n                console.log(success);\r\n                var response = JSON.parse(success.response);\r\n                this.drawImage(response.imageUrl);\r\n            },\r\n            (failure) => {\r\n                console.log('FAILURE');\r\n                console.log(failure);\r\n            }\r\n        )\r\n    }\r\n\r\n    drawImage(imageUrl) {\r\n        this.ctx = this.canvas.getContext(\"2d\");\r\n        \r\n        var img = new Image();\r\n        img.crossOrigin = \"anonymous\";\r\n        img.onload = () => {\r\n            this.ctx.drawImage(img, 0, 0, 600, 400);\r\n            this.ctx.drawImage(img, 0, 400, 600, 400);\r\n            // shift blueish colors to greenish colors\r\n            this.recolor(.33);\r\n        };\r\n        img.src = imageUrl;\r\n    }\r\n\r\n    recolor(colorshift) {\r\n        var imgData = this.ctx.getImageData(0, 0, 600, 400);\r\n        var data = imgData.data;\r\n\r\n        for (var i = 0; i < data.length; i += 4) {\r\n            var red = data[i + 0];\r\n            var green = data[i + 1];\r\n            var blue = data[i + 2];\r\n            var alpha = data[i + 3];\r\n\r\n            // skip transparent/semiTransparent pixels\r\n            if (alpha < 200) {\r\n                continue;\r\n            }\r\n\r\n            var hsl = this.rgbToHsl(red, green, blue);\r\n            var hue = hsl.h * 360;\r\n\r\n            // change blueish pixels to the new color\r\n            if (hue > 200 && hue < 300) {\r\n                var newRgb = this.hslToRgb(hsl.h + colorshift, hsl.s, hsl.l);\r\n                data[i + 0] = newRgb.r;\r\n                data[i + 1] = newRgb.g;\r\n                data[i + 2] = newRgb.b;\r\n                data[i + 3] = 255;\r\n            }\r\n        }\r\n        this.ctx.putImageData(imgData, 400, 0);\r\n    }\r\n\r\n\r\n    rgbToHsl(r, g, b) {\r\n        r /= 255, g /= 255, b /= 255;\r\n        var max = Math.max(r, g, b),\r\n            min = Math.min(r, g, b);\r\n        var h, s, l = (max + min) / 2;\r\n\r\n        if (max == min) {\r\n            h = s = 0; // achromatic\r\n        } else {\r\n            var d = max - min;\r\n            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n            switch (max) {\r\n                case r:\r\n                    h = (g - b) / d + (g < b ? 6 : 0);\r\n                    break;\r\n                case g:\r\n                    h = (b - r) / d + 2;\r\n                    break;\r\n                case b:\r\n                    h = (r - g) / d + 4;\r\n                    break;\r\n            }\r\n            h /= 6;\r\n        }\r\n\r\n        return ({\r\n            h: h,\r\n            s: s,\r\n            l: l,\r\n        });\r\n    }\r\n\r\n\r\n    hslToRgb(h, s, l) {\r\n        var r, g, b;\r\n\r\n        if (s == 0) {\r\n            r = g = b = l; // achromatic\r\n        } else {\r\n            function hue2rgb(p, q, t) {\r\n                if (t < 0) t += 1;\r\n                if (t > 1) t -= 1;\r\n                if (t < 1 / 6) return p + (q - p) * 6 * t;\r\n                if (t < 1 / 2) return q;\r\n                if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\r\n                return p;\r\n            }\r\n\r\n            var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n            var p = 2 * l - q;\r\n            r = hue2rgb(p, q, h + 1 / 3);\r\n            g = hue2rgb(p, q, h);\r\n            b = hue2rgb(p, q, h - 1 / 3);\r\n        }\r\n\r\n        return ({\r\n            r: Math.round(r * 255),\r\n            g: Math.round(g * 255),\r\n            b: Math.round(b * 255),\r\n        });\r\n    }\r\n    \r\n}","/**\r\n * interact.js v1.2.6\r\n *\r\n * Copyright (c) 2012-2015 Taye Adeyemi <dev@taye.me>\r\n * Open source under the MIT License.\r\n * https://raw.github.com/taye/interact.js/master/LICENSE\r\n */\r\n(function (realWindow) {\r\n    'use strict';\r\n\r\n    // return early if there's no window to work with (eg. Node.js)\r\n    if (!realWindow) { return; }\r\n\r\n    var // get wrapped window if using Shadow DOM polyfill\r\n        window = (function () {\r\n            // create a TextNode\r\n            var el = realWindow.document.createTextNode('');\r\n\r\n            // check if it's wrapped by a polyfill\r\n            if (el.ownerDocument !== realWindow.document\r\n                && typeof realWindow.wrap === 'function'\r\n                && realWindow.wrap(el) === el) {\r\n                // return wrapped window\r\n                return realWindow.wrap(realWindow);\r\n            }\r\n\r\n            // no Shadow DOM polyfil or native implementation\r\n            return realWindow;\r\n        }()),\r\n\r\n        document           = window.document,\r\n        DocumentFragment   = window.DocumentFragment   || blank,\r\n        SVGElement         = window.SVGElement         || blank,\r\n        SVGSVGElement      = window.SVGSVGElement      || blank,\r\n        SVGElementInstance = window.SVGElementInstance || blank,\r\n        HTMLElement        = window.HTMLElement        || window.Element,\r\n\r\n        PointerEvent = (window.PointerEvent || window.MSPointerEvent),\r\n        pEventTypes,\r\n\r\n        hypot = Math.hypot || function (x, y) { return Math.sqrt(x * x + y * y); },\r\n\r\n        tmpXY = {},     // reduce object creation in getXY()\r\n\r\n        documents       = [],   // all documents being listened to\r\n\r\n        interactables   = [],   // all set interactables\r\n        interactions    = [],   // all interactions\r\n\r\n        dynamicDrop     = false,\r\n\r\n        // {\r\n        //      type: {\r\n        //          selectors: ['selector', ...],\r\n        //          contexts : [document, ...],\r\n        //          listeners: [[listener, useCapture], ...]\r\n        //      }\r\n        //  }\r\n        delegatedEvents = {},\r\n\r\n        defaultOptions = {\r\n            base: {\r\n                accept        : null,\r\n                actionChecker : null,\r\n                styleCursor   : true,\r\n                preventDefault: 'auto',\r\n                origin        : { x: 0, y: 0 },\r\n                deltaSource   : 'page',\r\n                allowFrom     : null,\r\n                ignoreFrom    : null,\r\n                _context      : document,\r\n                dropChecker   : null\r\n            },\r\n\r\n            drag: {\r\n                enabled: false,\r\n                manualStart: true,\r\n                max: Infinity,\r\n                maxPerElement: 1,\r\n\r\n                snap: null,\r\n                restrict: null,\r\n                inertia: null,\r\n                autoScroll: null,\r\n\r\n                axis: 'xy'\r\n            },\r\n\r\n            drop: {\r\n                enabled: false,\r\n                accept: null,\r\n                overlap: 'pointer'\r\n            },\r\n\r\n            resize: {\r\n                enabled: false,\r\n                manualStart: false,\r\n                max: Infinity,\r\n                maxPerElement: 1,\r\n\r\n                snap: null,\r\n                restrict: null,\r\n                inertia: null,\r\n                autoScroll: null,\r\n\r\n                square: false,\r\n                preserveAspectRatio: false,\r\n                axis: 'xy',\r\n\r\n                // use default margin\r\n                margin: NaN,\r\n\r\n                // object with props left, right, top, bottom which are\r\n                // true/false values to resize when the pointer is over that edge,\r\n                // CSS selectors to match the handles for each direction\r\n                // or the Elements for each handle\r\n                edges: null,\r\n\r\n                // a value of 'none' will limit the resize rect to a minimum of 0x0\r\n                // 'negate' will alow the rect to have negative width/height\r\n                // 'reposition' will keep the width/height positive by swapping\r\n                // the top and bottom edges and/or swapping the left and right edges\r\n                invert: 'none'\r\n            },\r\n\r\n            gesture: {\r\n                manualStart: false,\r\n                enabled: false,\r\n                max: Infinity,\r\n                maxPerElement: 1,\r\n\r\n                restrict: null\r\n            },\r\n\r\n            perAction: {\r\n                manualStart: false,\r\n                max: Infinity,\r\n                maxPerElement: 1,\r\n\r\n                snap: {\r\n                    enabled     : false,\r\n                    endOnly     : false,\r\n                    range       : Infinity,\r\n                    targets     : null,\r\n                    offsets     : null,\r\n\r\n                    relativePoints: null\r\n                },\r\n\r\n                restrict: {\r\n                    enabled: false,\r\n                    endOnly: false\r\n                },\r\n\r\n                autoScroll: {\r\n                    enabled     : false,\r\n                    container   : null,     // the item that is scrolled (Window or HTMLElement)\r\n                    margin      : 60,\r\n                    speed       : 300       // the scroll speed in pixels per second\r\n                },\r\n\r\n                inertia: {\r\n                    enabled          : false,\r\n                    resistance       : 10,    // the lambda in exponential decay\r\n                    minSpeed         : 100,   // target speed must be above this for inertia to start\r\n                    endSpeed         : 10,    // the speed at which inertia is slow enough to stop\r\n                    allowResume      : true,  // allow resuming an action in inertia phase\r\n                    zeroResumeDelta  : true,  // if an action is resumed after launch, set dx/dy to 0\r\n                    smoothEndDuration: 300    // animate to snap/restrict endOnly if there's no inertia\r\n                }\r\n            },\r\n\r\n            _holdDuration: 600\r\n        },\r\n\r\n        // Things related to autoScroll\r\n        autoScroll = {\r\n            interaction: null,\r\n            i: null,    // the handle returned by window.setInterval\r\n            x: 0, y: 0, // Direction each pulse is to scroll in\r\n\r\n            // scroll the window by the values in scroll.x/y\r\n            scroll: function () {\r\n                var options = autoScroll.interaction.target.options[autoScroll.interaction.prepared.name].autoScroll,\r\n                    container = options.container || getWindow(autoScroll.interaction.element),\r\n                    now = new Date().getTime(),\r\n                    // change in time in seconds\r\n                    dtx = (now - autoScroll.prevTimeX) / 1000,\r\n                    dty = (now - autoScroll.prevTimeY) / 1000,\r\n                    vx, vy, sx, sy;\r\n\r\n                // displacement\r\n                if (options.velocity) {\r\n                  vx = options.velocity.x;\r\n                  vy = options.velocity.y;\r\n                }\r\n                else {\r\n                  vx = vy = options.speed\r\n                }\r\n \r\n                sx = vx * dtx;\r\n                sy = vy * dty;\r\n\r\n                if (sx >= 1 || sy >= 1) {\r\n                    if (isWindow(container)) {\r\n                        container.scrollBy(autoScroll.x * sx, autoScroll.y * sy);\r\n                    }\r\n                    else if (container) {\r\n                        container.scrollLeft += autoScroll.x * sx;\r\n                        container.scrollTop  += autoScroll.y * sy;\r\n                    }\r\n\r\n                    if (sx >=1) autoScroll.prevTimeX = now;\r\n                    if (sy >= 1) autoScroll.prevTimeY = now;\r\n                }\r\n\r\n                if (autoScroll.isScrolling) {\r\n                    cancelFrame(autoScroll.i);\r\n                    autoScroll.i = reqFrame(autoScroll.scroll);\r\n                }\r\n            },\r\n\r\n            isScrolling: false,\r\n            prevTimeX: 0,\r\n            prevTimeY: 0,\r\n\r\n            start: function (interaction) {\r\n                autoScroll.isScrolling = true;\r\n                cancelFrame(autoScroll.i);\r\n\r\n                autoScroll.interaction = interaction;\r\n                autoScroll.prevTimeX = new Date().getTime();\r\n                autoScroll.prevTimeY = new Date().getTime();\r\n                autoScroll.i = reqFrame(autoScroll.scroll);\r\n            },\r\n\r\n            stop: function () {\r\n                autoScroll.isScrolling = false;\r\n                cancelFrame(autoScroll.i);\r\n            }\r\n        },\r\n\r\n        // Does the browser support touch input?\r\n        supportsTouch = (('ontouchstart' in window) || window.DocumentTouch && document instanceof window.DocumentTouch),\r\n\r\n        // Does the browser support PointerEvents\r\n        supportsPointerEvent = !!PointerEvent,\r\n\r\n        // Less Precision with touch input\r\n        margin = supportsTouch || supportsPointerEvent? 20: 10,\r\n\r\n        pointerMoveTolerance = 1,\r\n\r\n        // for ignoring browser's simulated mouse events\r\n        prevTouchTime = 0,\r\n\r\n        // Allow this many interactions to happen simultaneously\r\n        maxInteractions = Infinity,\r\n\r\n        // Check if is IE9 or older\r\n        actionCursors = (document.all && !window.atob) ? {\r\n            drag    : 'move',\r\n            resizex : 'e-resize',\r\n            resizey : 's-resize',\r\n            resizexy: 'se-resize',\r\n\r\n            resizetop        : 'n-resize',\r\n            resizeleft       : 'w-resize',\r\n            resizebottom     : 's-resize',\r\n            resizeright      : 'e-resize',\r\n            resizetopleft    : 'se-resize',\r\n            resizebottomright: 'se-resize',\r\n            resizetopright   : 'ne-resize',\r\n            resizebottomleft : 'ne-resize',\r\n\r\n            gesture : ''\r\n        } : {\r\n            drag    : 'move',\r\n            resizex : 'ew-resize',\r\n            resizey : 'ns-resize',\r\n            resizexy: 'nwse-resize',\r\n\r\n            resizetop        : 'ns-resize',\r\n            resizeleft       : 'ew-resize',\r\n            resizebottom     : 'ns-resize',\r\n            resizeright      : 'ew-resize',\r\n            resizetopleft    : 'nwse-resize',\r\n            resizebottomright: 'nwse-resize',\r\n            resizetopright   : 'nesw-resize',\r\n            resizebottomleft : 'nesw-resize',\r\n\r\n            gesture : ''\r\n        },\r\n\r\n        actionIsEnabled = {\r\n            drag   : true,\r\n            resize : true,\r\n            gesture: true\r\n        },\r\n\r\n        // because Webkit and Opera still use 'mousewheel' event type\r\n        wheelEvent = 'onmousewheel' in document? 'mousewheel': 'wheel',\r\n\r\n        eventTypes = [\r\n            'dragstart',\r\n            'dragmove',\r\n            'draginertiastart',\r\n            'dragend',\r\n            'dragenter',\r\n            'dragleave',\r\n            'dropactivate',\r\n            'dropdeactivate',\r\n            'dropmove',\r\n            'drop',\r\n            'resizestart',\r\n            'resizemove',\r\n            'resizeinertiastart',\r\n            'resizeend',\r\n            'gesturestart',\r\n            'gesturemove',\r\n            'gestureinertiastart',\r\n            'gestureend',\r\n\r\n            'down',\r\n            'move',\r\n            'up',\r\n            'cancel',\r\n            'tap',\r\n            'doubletap',\r\n            'hold'\r\n        ],\r\n\r\n        globalEvents = {},\r\n\r\n        // Opera Mobile must be handled differently\r\n        isOperaMobile = navigator.appName == 'Opera' &&\r\n            supportsTouch &&\r\n            navigator.userAgent.match('Presto'),\r\n\r\n        // scrolling doesn't change the result of getClientRects on iOS 7\r\n        isIOS7 = (/iP(hone|od|ad)/.test(navigator.platform)\r\n                         && /OS 7[^\\d]/.test(navigator.appVersion)),\r\n\r\n        // prefix matchesSelector\r\n        prefixedMatchesSelector = 'matches' in Element.prototype?\r\n                'matches': 'webkitMatchesSelector' in Element.prototype?\r\n                    'webkitMatchesSelector': 'mozMatchesSelector' in Element.prototype?\r\n                        'mozMatchesSelector': 'oMatchesSelector' in Element.prototype?\r\n                            'oMatchesSelector': 'msMatchesSelector',\r\n\r\n        // will be polyfill function if browser is IE8\r\n        ie8MatchesSelector,\r\n\r\n        // native requestAnimationFrame or polyfill\r\n        reqFrame = realWindow.requestAnimationFrame,\r\n        cancelFrame = realWindow.cancelAnimationFrame,\r\n\r\n        // Events wrapper\r\n        events = (function () {\r\n            var useAttachEvent = ('attachEvent' in window) && !('addEventListener' in window),\r\n                addEvent       = useAttachEvent?  'attachEvent': 'addEventListener',\r\n                removeEvent    = useAttachEvent?  'detachEvent': 'removeEventListener',\r\n                on             = useAttachEvent? 'on': '',\r\n\r\n                elements          = [],\r\n                targets           = [],\r\n                attachedListeners = [];\r\n\r\n            function add (element, type, listener, useCapture) {\r\n                var elementIndex = indexOf(elements, element),\r\n                    target = targets[elementIndex];\r\n\r\n                if (!target) {\r\n                    target = {\r\n                        events: {},\r\n                        typeCount: 0\r\n                    };\r\n\r\n                    elementIndex = elements.push(element) - 1;\r\n                    targets.push(target);\r\n\r\n                    attachedListeners.push((useAttachEvent ? {\r\n                            supplied: [],\r\n                            wrapped : [],\r\n                            useCount: []\r\n                        } : null));\r\n                }\r\n\r\n                if (!target.events[type]) {\r\n                    target.events[type] = [];\r\n                    target.typeCount++;\r\n                }\r\n\r\n                if (!contains(target.events[type], listener)) {\r\n                    var ret;\r\n\r\n                    if (useAttachEvent) {\r\n                        var listeners = attachedListeners[elementIndex],\r\n                            listenerIndex = indexOf(listeners.supplied, listener);\r\n\r\n                        var wrapped = listeners.wrapped[listenerIndex] || function (event) {\r\n                            if (!event.immediatePropagationStopped) {\r\n                                event.target = event.srcElement;\r\n                                event.currentTarget = element;\r\n\r\n                                event.preventDefault = event.preventDefault || preventDef;\r\n                                event.stopPropagation = event.stopPropagation || stopProp;\r\n                                event.stopImmediatePropagation = event.stopImmediatePropagation || stopImmProp;\r\n\r\n                                if (/mouse|click/.test(event.type)) {\r\n                                    event.pageX = event.clientX + getWindow(element).document.documentElement.scrollLeft;\r\n                                    event.pageY = event.clientY + getWindow(element).document.documentElement.scrollTop;\r\n                                }\r\n\r\n                                listener(event);\r\n                            }\r\n                        };\r\n\r\n                        ret = element[addEvent](on + type, wrapped, Boolean(useCapture));\r\n\r\n                        if (listenerIndex === -1) {\r\n                            listeners.supplied.push(listener);\r\n                            listeners.wrapped.push(wrapped);\r\n                            listeners.useCount.push(1);\r\n                        }\r\n                        else {\r\n                            listeners.useCount[listenerIndex]++;\r\n                        }\r\n                    }\r\n                    else {\r\n                        ret = element[addEvent](type, listener, useCapture || false);\r\n                    }\r\n                    target.events[type].push(listener);\r\n\r\n                    return ret;\r\n                }\r\n            }\r\n\r\n            function remove (element, type, listener, useCapture) {\r\n                var i,\r\n                    elementIndex = indexOf(elements, element),\r\n                    target = targets[elementIndex],\r\n                    listeners,\r\n                    listenerIndex,\r\n                    wrapped = listener;\r\n\r\n                if (!target || !target.events) {\r\n                    return;\r\n                }\r\n\r\n                if (useAttachEvent) {\r\n                    listeners = attachedListeners[elementIndex];\r\n                    listenerIndex = indexOf(listeners.supplied, listener);\r\n                    wrapped = listeners.wrapped[listenerIndex];\r\n                }\r\n\r\n                if (type === 'all') {\r\n                    for (type in target.events) {\r\n                        if (target.events.hasOwnProperty(type)) {\r\n                            remove(element, type, 'all');\r\n                        }\r\n                    }\r\n                    return;\r\n                }\r\n\r\n                if (target.events[type]) {\r\n                    var len = target.events[type].length;\r\n\r\n                    if (listener === 'all') {\r\n                        for (i = 0; i < len; i++) {\r\n                            remove(element, type, target.events[type][i], Boolean(useCapture));\r\n                        }\r\n                        return;\r\n                    } else {\r\n                        for (i = 0; i < len; i++) {\r\n                            if (target.events[type][i] === listener) {\r\n                                element[removeEvent](on + type, wrapped, useCapture || false);\r\n                                target.events[type].splice(i, 1);\r\n\r\n                                if (useAttachEvent && listeners) {\r\n                                    listeners.useCount[listenerIndex]--;\r\n                                    if (listeners.useCount[listenerIndex] === 0) {\r\n                                        listeners.supplied.splice(listenerIndex, 1);\r\n                                        listeners.wrapped.splice(listenerIndex, 1);\r\n                                        listeners.useCount.splice(listenerIndex, 1);\r\n                                    }\r\n                                }\r\n\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if (target.events[type] && target.events[type].length === 0) {\r\n                        target.events[type] = null;\r\n                        target.typeCount--;\r\n                    }\r\n                }\r\n\r\n                if (!target.typeCount) {\r\n                    targets.splice(elementIndex, 1);\r\n                    elements.splice(elementIndex, 1);\r\n                    attachedListeners.splice(elementIndex, 1);\r\n                }\r\n            }\r\n\r\n            function preventDef () {\r\n                this.returnValue = false;\r\n            }\r\n\r\n            function stopProp () {\r\n                this.cancelBubble = true;\r\n            }\r\n\r\n            function stopImmProp () {\r\n                this.cancelBubble = true;\r\n                this.immediatePropagationStopped = true;\r\n            }\r\n\r\n            return {\r\n                add: add,\r\n                remove: remove,\r\n                useAttachEvent: useAttachEvent,\r\n\r\n                _elements: elements,\r\n                _targets: targets,\r\n                _attachedListeners: attachedListeners\r\n            };\r\n        }());\r\n\r\n    function blank () {}\r\n\r\n    function isElement (o) {\r\n        if (!o || (typeof o !== 'object')) { return false; }\r\n\r\n        var _window = getWindow(o) || window;\r\n\r\n        return (/object|function/.test(typeof _window.Element)\r\n            ? o instanceof _window.Element //DOM2\r\n            : o.nodeType === 1 && typeof o.nodeName === \"string\");\r\n    }\r\n    function isWindow (thing) { return thing === window || !!(thing && thing.Window) && (thing instanceof thing.Window); }\r\n    function isDocFrag (thing) { return !!thing && thing instanceof DocumentFragment; }\r\n    function isArray (thing) {\r\n        return isObject(thing)\r\n                && (typeof thing.length !== undefined)\r\n                && isFunction(thing.splice);\r\n    }\r\n    function isObject   (thing) { return !!thing && (typeof thing === 'object'); }\r\n    function isFunction (thing) { return typeof thing === 'function'; }\r\n    function isNumber   (thing) { return typeof thing === 'number'  ; }\r\n    function isBool     (thing) { return typeof thing === 'boolean' ; }\r\n    function isString   (thing) { return typeof thing === 'string'  ; }\r\n\r\n    function trySelector (value) {\r\n        if (!isString(value)) { return false; }\r\n\r\n        // an exception will be raised if it is invalid\r\n        document.querySelector(value);\r\n        return true;\r\n    }\r\n\r\n    function extend (dest, source) {\r\n        for (var prop in source) {\r\n            dest[prop] = source[prop];\r\n        }\r\n        return dest;\r\n    }\r\n\r\n    var prefixedPropREs = {\r\n      webkit: /(Movement[XY]|Radius[XY]|RotationAngle|Force)$/\r\n    };\r\n\r\n    function pointerExtend (dest, source) {\r\n        for (var prop in source) {\r\n          var deprecated = false;\r\n\r\n          // skip deprecated prefixed properties\r\n          for (var vendor in prefixedPropREs) {\r\n            if (prop.indexOf(vendor) === 0 && prefixedPropREs[vendor].test(prop)) {\r\n              deprecated = true;\r\n              break;\r\n            }\r\n          }\r\n\r\n          if (!deprecated) {\r\n            dest[prop] = source[prop];\r\n          }\r\n        }\r\n        return dest;\r\n    }\r\n\r\n    function copyCoords (dest, src) {\r\n        dest.page = dest.page || {};\r\n        dest.page.x = src.page.x;\r\n        dest.page.y = src.page.y;\r\n\r\n        dest.client = dest.client || {};\r\n        dest.client.x = src.client.x;\r\n        dest.client.y = src.client.y;\r\n\r\n        dest.timeStamp = src.timeStamp;\r\n    }\r\n\r\n    function setEventXY (targetObj, pointers, interaction) {\r\n        var pointer = (pointers.length > 1\r\n                       ? pointerAverage(pointers)\r\n                       : pointers[0]);\r\n\r\n        getPageXY(pointer, tmpXY, interaction);\r\n        targetObj.page.x = tmpXY.x;\r\n        targetObj.page.y = tmpXY.y;\r\n\r\n        getClientXY(pointer, tmpXY, interaction);\r\n        targetObj.client.x = tmpXY.x;\r\n        targetObj.client.y = tmpXY.y;\r\n\r\n        targetObj.timeStamp = new Date().getTime();\r\n    }\r\n\r\n    function setEventDeltas (targetObj, prev, cur) {\r\n        targetObj.page.x     = cur.page.x      - prev.page.x;\r\n        targetObj.page.y     = cur.page.y      - prev.page.y;\r\n        targetObj.client.x   = cur.client.x    - prev.client.x;\r\n        targetObj.client.y   = cur.client.y    - prev.client.y;\r\n        targetObj.timeStamp = new Date().getTime() - prev.timeStamp;\r\n\r\n        // set pointer velocity\r\n        var dt = Math.max(targetObj.timeStamp / 1000, 0.001);\r\n        targetObj.page.speed   = hypot(targetObj.page.x, targetObj.page.y) / dt;\r\n        targetObj.page.vx      = targetObj.page.x / dt;\r\n        targetObj.page.vy      = targetObj.page.y / dt;\r\n\r\n        targetObj.client.speed = hypot(targetObj.client.x, targetObj.page.y) / dt;\r\n        targetObj.client.vx    = targetObj.client.x / dt;\r\n        targetObj.client.vy    = targetObj.client.y / dt;\r\n    }\r\n\r\n    function isNativePointer (pointer) {\r\n        return (pointer instanceof window.Event\r\n            || (supportsTouch && window.Touch && pointer instanceof window.Touch));\r\n    }\r\n\r\n    // Get specified X/Y coords for mouse or event.touches[0]\r\n    function getXY (type, pointer, xy) {\r\n        xy = xy || {};\r\n        type = type || 'page';\r\n\r\n        xy.x = pointer[type + 'X'];\r\n        xy.y = pointer[type + 'Y'];\r\n\r\n        return xy;\r\n    }\r\n\r\n    function getPageXY (pointer, page) {\r\n        page = page || {};\r\n\r\n        // Opera Mobile handles the viewport and scrolling oddly\r\n        if (isOperaMobile && isNativePointer(pointer)) {\r\n            getXY('screen', pointer, page);\r\n\r\n            page.x += window.scrollX;\r\n            page.y += window.scrollY;\r\n        }\r\n        else {\r\n            getXY('page', pointer, page);\r\n        }\r\n\r\n        return page;\r\n    }\r\n\r\n    function getClientXY (pointer, client) {\r\n        client = client || {};\r\n\r\n        if (isOperaMobile && isNativePointer(pointer)) {\r\n            // Opera Mobile handles the viewport and scrolling oddly\r\n            getXY('screen', pointer, client);\r\n        }\r\n        else {\r\n          getXY('client', pointer, client);\r\n        }\r\n\r\n        return client;\r\n    }\r\n\r\n    function getScrollXY (win) {\r\n        win = win || window;\r\n        return {\r\n            x: win.scrollX || win.document.documentElement.scrollLeft,\r\n            y: win.scrollY || win.document.documentElement.scrollTop\r\n        };\r\n    }\r\n\r\n    function getPointerId (pointer) {\r\n        return isNumber(pointer.pointerId)? pointer.pointerId : pointer.identifier;\r\n    }\r\n\r\n    function getActualElement (element) {\r\n        return (element instanceof SVGElementInstance\r\n            ? element.correspondingUseElement\r\n            : element);\r\n    }\r\n\r\n    function getWindow (node) {\r\n        if (isWindow(node)) {\r\n            return node;\r\n        }\r\n\r\n        var rootNode = (node.ownerDocument || node);\r\n\r\n        return rootNode.defaultView || rootNode.parentWindow || window;\r\n    }\r\n\r\n    function getElementClientRect (element) {\r\n        var clientRect = (element instanceof SVGElement\r\n                            ? element.getBoundingClientRect()\r\n                            : element.getClientRects()[0]);\r\n\r\n        return clientRect && {\r\n            left  : clientRect.left,\r\n            right : clientRect.right,\r\n            top   : clientRect.top,\r\n            bottom: clientRect.bottom,\r\n            width : clientRect.width || clientRect.right - clientRect.left,\r\n            height: clientRect.height || clientRect.bottom - clientRect.top\r\n        };\r\n    }\r\n\r\n    function getElementRect (element) {\r\n        var clientRect = getElementClientRect(element);\r\n\r\n        if (!isIOS7 && clientRect) {\r\n            var scroll = getScrollXY(getWindow(element));\r\n\r\n            clientRect.left   += scroll.x;\r\n            clientRect.right  += scroll.x;\r\n            clientRect.top    += scroll.y;\r\n            clientRect.bottom += scroll.y;\r\n        }\r\n\r\n        return clientRect;\r\n    }\r\n\r\n    function getTouchPair (event) {\r\n        var touches = [];\r\n\r\n        // array of touches is supplied\r\n        if (isArray(event)) {\r\n            touches[0] = event[0];\r\n            touches[1] = event[1];\r\n        }\r\n        // an event\r\n        else {\r\n            if (event.type === 'touchend') {\r\n                if (event.touches.length === 1) {\r\n                    touches[0] = event.touches[0];\r\n                    touches[1] = event.changedTouches[0];\r\n                }\r\n                else if (event.touches.length === 0) {\r\n                    touches[0] = event.changedTouches[0];\r\n                    touches[1] = event.changedTouches[1];\r\n                }\r\n            }\r\n            else {\r\n                touches[0] = event.touches[0];\r\n                touches[1] = event.touches[1];\r\n            }\r\n        }\r\n\r\n        return touches;\r\n    }\r\n\r\n    function pointerAverage (pointers) {\r\n        var average = {\r\n            pageX  : 0,\r\n            pageY  : 0,\r\n            clientX: 0,\r\n            clientY: 0,\r\n            screenX: 0,\r\n            screenY: 0\r\n        };\r\n        var prop;\r\n\r\n        for (var i = 0; i < pointers.length; i++) {\r\n            for (prop in average) {\r\n                average[prop] += pointers[i][prop];\r\n            }\r\n        }\r\n        for (prop in average) {\r\n            average[prop] /= pointers.length;\r\n        }\r\n\r\n        return average;\r\n    }\r\n\r\n    function touchBBox (event) {\r\n        if (!event.length && !(event.touches && event.touches.length > 1)) {\r\n            return;\r\n        }\r\n\r\n        var touches = getTouchPair(event),\r\n            minX = Math.min(touches[0].pageX, touches[1].pageX),\r\n            minY = Math.min(touches[0].pageY, touches[1].pageY),\r\n            maxX = Math.max(touches[0].pageX, touches[1].pageX),\r\n            maxY = Math.max(touches[0].pageY, touches[1].pageY);\r\n\r\n        return {\r\n            x: minX,\r\n            y: minY,\r\n            left: minX,\r\n            top: minY,\r\n            width: maxX - minX,\r\n            height: maxY - minY\r\n        };\r\n    }\r\n\r\n    function touchDistance (event, deltaSource) {\r\n        deltaSource = deltaSource || defaultOptions.deltaSource;\r\n\r\n        var sourceX = deltaSource + 'X',\r\n            sourceY = deltaSource + 'Y',\r\n            touches = getTouchPair(event);\r\n\r\n\r\n        var dx = touches[0][sourceX] - touches[1][sourceX],\r\n            dy = touches[0][sourceY] - touches[1][sourceY];\r\n\r\n        return hypot(dx, dy);\r\n    }\r\n\r\n    function touchAngle (event, prevAngle, deltaSource) {\r\n        deltaSource = deltaSource || defaultOptions.deltaSource;\r\n\r\n        var sourceX = deltaSource + 'X',\r\n            sourceY = deltaSource + 'Y',\r\n            touches = getTouchPair(event),\r\n            dx = touches[0][sourceX] - touches[1][sourceX],\r\n            dy = touches[0][sourceY] - touches[1][sourceY],\r\n            angle = 180 * Math.atan(dy / dx) / Math.PI;\r\n\r\n        if (isNumber(prevAngle)) {\r\n            var dr = angle - prevAngle,\r\n                drClamped = dr % 360;\r\n\r\n            if (drClamped > 315) {\r\n                angle -= 360 + (angle / 360)|0 * 360;\r\n            }\r\n            else if (drClamped > 135) {\r\n                angle -= 180 + (angle / 360)|0 * 360;\r\n            }\r\n            else if (drClamped < -315) {\r\n                angle += 360 + (angle / 360)|0 * 360;\r\n            }\r\n            else if (drClamped < -135) {\r\n                angle += 180 + (angle / 360)|0 * 360;\r\n            }\r\n        }\r\n\r\n        return  angle;\r\n    }\r\n\r\n    function getOriginXY (interactable, element) {\r\n        var origin = interactable\r\n                ? interactable.options.origin\r\n                : defaultOptions.origin;\r\n\r\n        if (origin === 'parent') {\r\n            origin = parentElement(element);\r\n        }\r\n        else if (origin === 'self') {\r\n            origin = interactable.getRect(element);\r\n        }\r\n        else if (trySelector(origin)) {\r\n            origin = closest(element, origin) || { x: 0, y: 0 };\r\n        }\r\n\r\n        if (isFunction(origin)) {\r\n            origin = origin(interactable && element);\r\n        }\r\n\r\n        if (isElement(origin))  {\r\n            origin = getElementRect(origin);\r\n        }\r\n\r\n        origin.x = ('x' in origin)? origin.x : origin.left;\r\n        origin.y = ('y' in origin)? origin.y : origin.top;\r\n\r\n        return origin;\r\n    }\r\n\r\n    // http://stackoverflow.com/a/5634528/2280888\r\n    function _getQBezierValue(t, p1, p2, p3) {\r\n        var iT = 1 - t;\r\n        return iT * iT * p1 + 2 * iT * t * p2 + t * t * p3;\r\n    }\r\n\r\n    function getQuadraticCurvePoint(startX, startY, cpX, cpY, endX, endY, position) {\r\n        return {\r\n            x:  _getQBezierValue(position, startX, cpX, endX),\r\n            y:  _getQBezierValue(position, startY, cpY, endY)\r\n        };\r\n    }\r\n\r\n    // http://gizma.com/easing/\r\n    function easeOutQuad (t, b, c, d) {\r\n        t /= d;\r\n        return -c * t*(t-2) + b;\r\n    }\r\n\r\n    function nodeContains (parent, child) {\r\n        while (child) {\r\n            if (child === parent) {\r\n                return true;\r\n            }\r\n\r\n            child = child.parentNode;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    function closest (child, selector) {\r\n        var parent = parentElement(child);\r\n\r\n        while (isElement(parent)) {\r\n            if (matchesSelector(parent, selector)) { return parent; }\r\n\r\n            parent = parentElement(parent);\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    function parentElement (node) {\r\n        var parent = node.parentNode;\r\n\r\n        if (isDocFrag(parent)) {\r\n            // skip past #shado-root fragments\r\n            while ((parent = parent.host) && isDocFrag(parent)) {}\r\n\r\n            return parent;\r\n        }\r\n\r\n        return parent;\r\n    }\r\n\r\n    function inContext (interactable, element) {\r\n        return interactable._context === element.ownerDocument\r\n                || nodeContains(interactable._context, element);\r\n    }\r\n\r\n    function testIgnore (interactable, interactableElement, element) {\r\n        var ignoreFrom = interactable.options.ignoreFrom;\r\n\r\n        if (!ignoreFrom || !isElement(element)) { return false; }\r\n\r\n        if (isString(ignoreFrom)) {\r\n            return matchesUpTo(element, ignoreFrom, interactableElement);\r\n        }\r\n        else if (isElement(ignoreFrom)) {\r\n            return nodeContains(ignoreFrom, element);\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    function testAllow (interactable, interactableElement, element) {\r\n        var allowFrom = interactable.options.allowFrom;\r\n\r\n        if (!allowFrom) { return true; }\r\n\r\n        if (!isElement(element)) { return false; }\r\n\r\n        if (isString(allowFrom)) {\r\n            return matchesUpTo(element, allowFrom, interactableElement);\r\n        }\r\n        else if (isElement(allowFrom)) {\r\n            return nodeContains(allowFrom, element);\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    function checkAxis (axis, interactable) {\r\n        if (!interactable) { return false; }\r\n\r\n        var thisAxis = interactable.options.drag.axis;\r\n\r\n        return (axis === 'xy' || thisAxis === 'xy' || thisAxis === axis);\r\n    }\r\n\r\n    function checkSnap (interactable, action) {\r\n        var options = interactable.options;\r\n\r\n        if (/^resize/.test(action)) {\r\n            action = 'resize';\r\n        }\r\n\r\n        return options[action].snap && options[action].snap.enabled;\r\n    }\r\n\r\n    function checkRestrict (interactable, action) {\r\n        var options = interactable.options;\r\n\r\n        if (/^resize/.test(action)) {\r\n            action = 'resize';\r\n        }\r\n\r\n        return  options[action].restrict && options[action].restrict.enabled;\r\n    }\r\n\r\n    function checkAutoScroll (interactable, action) {\r\n        var options = interactable.options;\r\n\r\n        if (/^resize/.test(action)) {\r\n            action = 'resize';\r\n        }\r\n\r\n        return  options[action].autoScroll && options[action].autoScroll.enabled;\r\n    }\r\n\r\n    function withinInteractionLimit (interactable, element, action) {\r\n        var options = interactable.options,\r\n            maxActions = options[action.name].max,\r\n            maxPerElement = options[action.name].maxPerElement,\r\n            activeInteractions = 0,\r\n            targetCount = 0,\r\n            targetElementCount = 0;\r\n\r\n        for (var i = 0, len = interactions.length; i < len; i++) {\r\n            var interaction = interactions[i],\r\n                otherAction = interaction.prepared.name,\r\n                active = interaction.interacting();\r\n\r\n            if (!active) { continue; }\r\n\r\n            activeInteractions++;\r\n\r\n            if (activeInteractions >= maxInteractions) {\r\n                return false;\r\n            }\r\n\r\n            if (interaction.target !== interactable) { continue; }\r\n\r\n            targetCount += (otherAction === action.name)|0;\r\n\r\n            if (targetCount >= maxActions) {\r\n                return false;\r\n            }\r\n\r\n            if (interaction.element === element) {\r\n                targetElementCount++;\r\n\r\n                if (otherAction !== action.name || targetElementCount >= maxPerElement) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return maxInteractions > 0;\r\n    }\r\n\r\n    // Test for the element that's \"above\" all other qualifiers\r\n    function indexOfDeepestElement (elements) {\r\n        var dropzone,\r\n            deepestZone = elements[0],\r\n            index = deepestZone? 0: -1,\r\n            parent,\r\n            deepestZoneParents = [],\r\n            dropzoneParents = [],\r\n            child,\r\n            i,\r\n            n;\r\n\r\n        for (i = 1; i < elements.length; i++) {\r\n            dropzone = elements[i];\r\n\r\n            // an element might belong to multiple selector dropzones\r\n            if (!dropzone || dropzone === deepestZone) {\r\n                continue;\r\n            }\r\n\r\n            if (!deepestZone) {\r\n                deepestZone = dropzone;\r\n                index = i;\r\n                continue;\r\n            }\r\n\r\n            // check if the deepest or current are document.documentElement or document.rootElement\r\n            // - if the current dropzone is, do nothing and continue\r\n            if (dropzone.parentNode === dropzone.ownerDocument) {\r\n                continue;\r\n            }\r\n            // - if deepest is, update with the current dropzone and continue to next\r\n            else if (deepestZone.parentNode === dropzone.ownerDocument) {\r\n                deepestZone = dropzone;\r\n                index = i;\r\n                continue;\r\n            }\r\n\r\n            if (!deepestZoneParents.length) {\r\n                parent = deepestZone;\r\n                while (parent.parentNode && parent.parentNode !== parent.ownerDocument) {\r\n                    deepestZoneParents.unshift(parent);\r\n                    parent = parent.parentNode;\r\n                }\r\n            }\r\n\r\n            // if this element is an svg element and the current deepest is\r\n            // an HTMLElement\r\n            if (deepestZone instanceof HTMLElement\r\n                && dropzone instanceof SVGElement\r\n                && !(dropzone instanceof SVGSVGElement)) {\r\n\r\n                if (dropzone === deepestZone.parentNode) {\r\n                    continue;\r\n                }\r\n\r\n                parent = dropzone.ownerSVGElement;\r\n            }\r\n            else {\r\n                parent = dropzone;\r\n            }\r\n\r\n            dropzoneParents = [];\r\n\r\n            while (parent.parentNode !== parent.ownerDocument) {\r\n                dropzoneParents.unshift(parent);\r\n                parent = parent.parentNode;\r\n            }\r\n\r\n            n = 0;\r\n\r\n            // get (position of last common ancestor) + 1\r\n            while (dropzoneParents[n] && dropzoneParents[n] === deepestZoneParents[n]) {\r\n                n++;\r\n            }\r\n\r\n            var parents = [\r\n                dropzoneParents[n - 1],\r\n                dropzoneParents[n],\r\n                deepestZoneParents[n]\r\n            ];\r\n\r\n            child = parents[0].lastChild;\r\n\r\n            while (child) {\r\n                if (child === parents[1]) {\r\n                    deepestZone = dropzone;\r\n                    index = i;\r\n                    deepestZoneParents = [];\r\n\r\n                    break;\r\n                }\r\n                else if (child === parents[2]) {\r\n                    break;\r\n                }\r\n\r\n                child = child.previousSibling;\r\n            }\r\n        }\r\n\r\n        return index;\r\n    }\r\n\r\n    function Interaction () {\r\n        this.target          = null; // current interactable being interacted with\r\n        this.element         = null; // the target element of the interactable\r\n        this.dropTarget      = null; // the dropzone a drag target might be dropped into\r\n        this.dropElement     = null; // the element at the time of checking\r\n        this.prevDropTarget  = null; // the dropzone that was recently dragged away from\r\n        this.prevDropElement = null; // the element at the time of checking\r\n\r\n        this.prepared        = {     // action that's ready to be fired on next move event\r\n            name : null,\r\n            axis : null,\r\n            edges: null\r\n        };\r\n\r\n        this.matches         = [];   // all selectors that are matched by target element\r\n        this.matchElements   = [];   // corresponding elements\r\n\r\n        this.inertiaStatus = {\r\n            active       : false,\r\n            smoothEnd    : false,\r\n            ending       : false,\r\n\r\n            startEvent: null,\r\n            upCoords: {},\r\n\r\n            xe: 0, ye: 0,\r\n            sx: 0, sy: 0,\r\n\r\n            t0: 0,\r\n            vx0: 0, vys: 0,\r\n            duration: 0,\r\n\r\n            resumeDx: 0,\r\n            resumeDy: 0,\r\n\r\n            lambda_v0: 0,\r\n            one_ve_v0: 0,\r\n            i  : null\r\n        };\r\n\r\n        if (isFunction(Function.prototype.bind)) {\r\n            this.boundInertiaFrame = this.inertiaFrame.bind(this);\r\n            this.boundSmoothEndFrame = this.smoothEndFrame.bind(this);\r\n        }\r\n        else {\r\n            var that = this;\r\n\r\n            this.boundInertiaFrame = function () { return that.inertiaFrame(); };\r\n            this.boundSmoothEndFrame = function () { return that.smoothEndFrame(); };\r\n        }\r\n\r\n        this.activeDrops = {\r\n            dropzones: [],      // the dropzones that are mentioned below\r\n            elements : [],      // elements of dropzones that accept the target draggable\r\n            rects    : []       // the rects of the elements mentioned above\r\n        };\r\n\r\n        // keep track of added pointers\r\n        this.pointers    = [];\r\n        this.pointerIds  = [];\r\n        this.downTargets = [];\r\n        this.downTimes   = [];\r\n        this.holdTimers  = [];\r\n\r\n        // Previous native pointer move event coordinates\r\n        this.prevCoords = {\r\n            page     : { x: 0, y: 0 },\r\n            client   : { x: 0, y: 0 },\r\n            timeStamp: 0\r\n        };\r\n        // current native pointer move event coordinates\r\n        this.curCoords = {\r\n            page     : { x: 0, y: 0 },\r\n            client   : { x: 0, y: 0 },\r\n            timeStamp: 0\r\n        };\r\n\r\n        // Starting InteractEvent pointer coordinates\r\n        this.startCoords = {\r\n            page     : { x: 0, y: 0 },\r\n            client   : { x: 0, y: 0 },\r\n            timeStamp: 0\r\n        };\r\n\r\n        // Change in coordinates and time of the pointer\r\n        this.pointerDelta = {\r\n            page     : { x: 0, y: 0, vx: 0, vy: 0, speed: 0 },\r\n            client   : { x: 0, y: 0, vx: 0, vy: 0, speed: 0 },\r\n            timeStamp: 0\r\n        };\r\n\r\n        this.downEvent   = null;    // pointerdown/mousedown/touchstart event\r\n        this.downPointer = {};\r\n\r\n        this._eventTarget    = null;\r\n        this._curEventTarget = null;\r\n\r\n        this.prevEvent = null;      // previous action event\r\n        this.tapTime   = 0;         // time of the most recent tap event\r\n        this.prevTap   = null;\r\n\r\n        this.startOffset    = { left: 0, right: 0, top: 0, bottom: 0 };\r\n        this.restrictOffset = { left: 0, right: 0, top: 0, bottom: 0 };\r\n        this.snapOffsets    = [];\r\n\r\n        this.gesture = {\r\n            start: { x: 0, y: 0 },\r\n\r\n            startDistance: 0,   // distance between two touches of touchStart\r\n            prevDistance : 0,\r\n            distance     : 0,\r\n\r\n            scale: 1,           // gesture.distance / gesture.startDistance\r\n\r\n            startAngle: 0,      // angle of line joining two touches\r\n            prevAngle : 0       // angle of the previous gesture event\r\n        };\r\n\r\n        this.snapStatus = {\r\n            x       : 0, y       : 0,\r\n            dx      : 0, dy      : 0,\r\n            realX   : 0, realY   : 0,\r\n            snappedX: 0, snappedY: 0,\r\n            targets : [],\r\n            locked  : false,\r\n            changed : false\r\n        };\r\n\r\n        this.restrictStatus = {\r\n            dx         : 0, dy         : 0,\r\n            restrictedX: 0, restrictedY: 0,\r\n            snap       : null,\r\n            restricted : false,\r\n            changed    : false\r\n        };\r\n\r\n        this.restrictStatus.snap = this.snapStatus;\r\n\r\n        this.pointerIsDown   = false;\r\n        this.pointerWasMoved = false;\r\n        this.gesturing       = false;\r\n        this.dragging        = false;\r\n        this.resizing        = false;\r\n        this.resizeAxes      = 'xy';\r\n\r\n        this.mouse = false;\r\n\r\n        interactions.push(this);\r\n    }\r\n\r\n    Interaction.prototype = {\r\n        getPageXY  : function (pointer, xy) { return   getPageXY(pointer, xy, this); },\r\n        getClientXY: function (pointer, xy) { return getClientXY(pointer, xy, this); },\r\n        setEventXY : function (target, ptr) { return  setEventXY(target, ptr, this); },\r\n\r\n        pointerOver: function (pointer, event, eventTarget) {\r\n            if (this.prepared.name || !this.mouse) { return; }\r\n\r\n            var curMatches = [],\r\n                curMatchElements = [],\r\n                prevTargetElement = this.element;\r\n\r\n            this.addPointer(pointer);\r\n\r\n            if (this.target\r\n                && (testIgnore(this.target, this.element, eventTarget)\r\n                    || !testAllow(this.target, this.element, eventTarget))) {\r\n                // if the eventTarget should be ignored or shouldn't be allowed\r\n                // clear the previous target\r\n                this.target = null;\r\n                this.element = null;\r\n                this.matches = [];\r\n                this.matchElements = [];\r\n            }\r\n\r\n            var elementInteractable = interactables.get(eventTarget),\r\n                elementAction = (elementInteractable\r\n                                 && !testIgnore(elementInteractable, eventTarget, eventTarget)\r\n                                 && testAllow(elementInteractable, eventTarget, eventTarget)\r\n                                 && validateAction(\r\n                                     elementInteractable.getAction(pointer, event, this, eventTarget),\r\n                                     elementInteractable));\r\n\r\n            if (elementAction && !withinInteractionLimit(elementInteractable, eventTarget, elementAction)) {\r\n                 elementAction = null;\r\n            }\r\n\r\n            function pushCurMatches (interactable, selector) {\r\n                if (interactable\r\n                    && inContext(interactable, eventTarget)\r\n                    && !testIgnore(interactable, eventTarget, eventTarget)\r\n                    && testAllow(interactable, eventTarget, eventTarget)\r\n                    && matchesSelector(eventTarget, selector)) {\r\n\r\n                    curMatches.push(interactable);\r\n                    curMatchElements.push(eventTarget);\r\n                }\r\n            }\r\n\r\n            if (elementAction) {\r\n                this.target = elementInteractable;\r\n                this.element = eventTarget;\r\n                this.matches = [];\r\n                this.matchElements = [];\r\n            }\r\n            else {\r\n                interactables.forEachSelector(pushCurMatches);\r\n\r\n                if (this.validateSelector(pointer, event, curMatches, curMatchElements)) {\r\n                    this.matches = curMatches;\r\n                    this.matchElements = curMatchElements;\r\n\r\n                    this.pointerHover(pointer, event, this.matches, this.matchElements);\r\n                    events.add(eventTarget,\r\n                                        PointerEvent? pEventTypes.move : 'mousemove',\r\n                                        listeners.pointerHover);\r\n                }\r\n                else if (this.target) {\r\n                    if (nodeContains(prevTargetElement, eventTarget)) {\r\n                        this.pointerHover(pointer, event, this.matches, this.matchElements);\r\n                        events.add(this.element,\r\n                                            PointerEvent? pEventTypes.move : 'mousemove',\r\n                                            listeners.pointerHover);\r\n                    }\r\n                    else {\r\n                        this.target = null;\r\n                        this.element = null;\r\n                        this.matches = [];\r\n                        this.matchElements = [];\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        // Check what action would be performed on pointerMove target if a mouse\r\n        // button were pressed and change the cursor accordingly\r\n        pointerHover: function (pointer, event, eventTarget, curEventTarget, matches, matchElements) {\r\n            var target = this.target;\r\n\r\n            if (!this.prepared.name && this.mouse) {\r\n\r\n                var action;\r\n\r\n                // update pointer coords for defaultActionChecker to use\r\n                this.setEventXY(this.curCoords, [pointer]);\r\n\r\n                if (matches) {\r\n                    action = this.validateSelector(pointer, event, matches, matchElements);\r\n                }\r\n                else if (target) {\r\n                    action = validateAction(target.getAction(this.pointers[0], event, this, this.element), this.target);\r\n                }\r\n\r\n                if (target && target.options.styleCursor) {\r\n                    if (action) {\r\n                        target._doc.documentElement.style.cursor = getActionCursor(action);\r\n                    }\r\n                    else {\r\n                        target._doc.documentElement.style.cursor = '';\r\n                    }\r\n                }\r\n            }\r\n            else if (this.prepared.name) {\r\n                this.checkAndPreventDefault(event, target, this.element);\r\n            }\r\n        },\r\n\r\n        pointerOut: function (pointer, event, eventTarget) {\r\n            if (this.prepared.name) { return; }\r\n\r\n            // Remove temporary event listeners for selector Interactables\r\n            if (!interactables.get(eventTarget)) {\r\n                events.remove(eventTarget,\r\n                                       PointerEvent? pEventTypes.move : 'mousemove',\r\n                                       listeners.pointerHover);\r\n            }\r\n\r\n            if (this.target && this.target.options.styleCursor && !this.interacting()) {\r\n                this.target._doc.documentElement.style.cursor = '';\r\n            }\r\n        },\r\n\r\n        selectorDown: function (pointer, event, eventTarget, curEventTarget) {\r\n            var that = this,\r\n                // copy event to be used in timeout for IE8\r\n                eventCopy = events.useAttachEvent? extend({}, event) : event,\r\n                element = eventTarget,\r\n                pointerIndex = this.addPointer(pointer),\r\n                action;\r\n\r\n            this.holdTimers[pointerIndex] = setTimeout(function () {\r\n                that.pointerHold(events.useAttachEvent? eventCopy : pointer, eventCopy, eventTarget, curEventTarget);\r\n            }, defaultOptions._holdDuration);\r\n\r\n            this.pointerIsDown = true;\r\n\r\n            // Check if the down event hits the current inertia target\r\n            if (this.inertiaStatus.active && this.target.selector) {\r\n                // climb up the DOM tree from the event target\r\n                while (isElement(element)) {\r\n\r\n                    // if this element is the current inertia target element\r\n                    if (element === this.element\r\n                        // and the prospective action is the same as the ongoing one\r\n                        && validateAction(this.target.getAction(pointer, event, this, this.element), this.target).name === this.prepared.name) {\r\n\r\n                        // stop inertia so that the next move will be a normal one\r\n                        cancelFrame(this.inertiaStatus.i);\r\n                        this.inertiaStatus.active = false;\r\n\r\n                        this.collectEventTargets(pointer, event, eventTarget, 'down');\r\n                        return;\r\n                    }\r\n                    element = parentElement(element);\r\n                }\r\n            }\r\n\r\n            // do nothing if interacting\r\n            if (this.interacting()) {\r\n                this.collectEventTargets(pointer, event, eventTarget, 'down');\r\n                return;\r\n            }\r\n\r\n            function pushMatches (interactable, selector, context) {\r\n                var elements = ie8MatchesSelector\r\n                    ? context.querySelectorAll(selector)\r\n                    : undefined;\r\n\r\n                if (inContext(interactable, element)\r\n                    && !testIgnore(interactable, element, eventTarget)\r\n                    && testAllow(interactable, element, eventTarget)\r\n                    && matchesSelector(element, selector, elements)) {\r\n\r\n                    that.matches.push(interactable);\r\n                    that.matchElements.push(element);\r\n                }\r\n            }\r\n\r\n            // update pointer coords for defaultActionChecker to use\r\n            this.setEventXY(this.curCoords, [pointer]);\r\n            this.downEvent = event;\r\n\r\n            while (isElement(element) && !action) {\r\n                this.matches = [];\r\n                this.matchElements = [];\r\n\r\n                interactables.forEachSelector(pushMatches);\r\n\r\n                action = this.validateSelector(pointer, event, this.matches, this.matchElements);\r\n                element = parentElement(element);\r\n            }\r\n\r\n            if (action) {\r\n                this.prepared.name  = action.name;\r\n                this.prepared.axis  = action.axis;\r\n                this.prepared.edges = action.edges;\r\n\r\n                this.collectEventTargets(pointer, event, eventTarget, 'down');\r\n\r\n                return this.pointerDown(pointer, event, eventTarget, curEventTarget, action);\r\n            }\r\n            else {\r\n                // do these now since pointerDown isn't being called from here\r\n                this.downTimes[pointerIndex] = new Date().getTime();\r\n                this.downTargets[pointerIndex] = eventTarget;\r\n                pointerExtend(this.downPointer, pointer);\r\n\r\n                copyCoords(this.prevCoords, this.curCoords);\r\n                this.pointerWasMoved = false;\r\n            }\r\n\r\n            this.collectEventTargets(pointer, event, eventTarget, 'down');\r\n        },\r\n\r\n        // Determine action to be performed on next pointerMove and add appropriate\r\n        // style and event Listeners\r\n        pointerDown: function (pointer, event, eventTarget, curEventTarget, forceAction) {\r\n            if (!forceAction && !this.inertiaStatus.active && this.pointerWasMoved && this.prepared.name) {\r\n                this.checkAndPreventDefault(event, this.target, this.element);\r\n\r\n                return;\r\n            }\r\n\r\n            this.pointerIsDown = true;\r\n            this.downEvent = event;\r\n\r\n            var pointerIndex = this.addPointer(pointer),\r\n                action;\r\n\r\n            // If it is the second touch of a multi-touch gesture, keep the\r\n            // target the same and get a new action if a target was set by the\r\n            // first touch\r\n            if (this.pointerIds.length > 1 && this.target._element === this.element) {\r\n                var newAction = validateAction(forceAction || this.target.getAction(pointer, event, this, this.element), this.target);\r\n\r\n                if (withinInteractionLimit(this.target, this.element, newAction)) {\r\n                    action = newAction;\r\n                }\r\n\r\n                this.prepared.name = null;\r\n            }\r\n            // Otherwise, set the target if there is no action prepared\r\n            else if (!this.prepared.name) {\r\n                var interactable = interactables.get(curEventTarget);\r\n\r\n                if (interactable\r\n                    && !testIgnore(interactable, curEventTarget, eventTarget)\r\n                    && testAllow(interactable, curEventTarget, eventTarget)\r\n                    && (action = validateAction(forceAction || interactable.getAction(pointer, event, this, curEventTarget), interactable, eventTarget))\r\n                    && withinInteractionLimit(interactable, curEventTarget, action)) {\r\n                    this.target = interactable;\r\n                    this.element = curEventTarget;\r\n                }\r\n            }\r\n\r\n            var target = this.target,\r\n                options = target && target.options;\r\n\r\n            if (target && (forceAction || !this.prepared.name)) {\r\n                action = action || validateAction(forceAction || target.getAction(pointer, event, this, curEventTarget), target, this.element);\r\n\r\n                this.setEventXY(this.startCoords, this.pointers);\r\n\r\n                if (!action) { return; }\r\n\r\n                if (options.styleCursor) {\r\n                    target._doc.documentElement.style.cursor = getActionCursor(action);\r\n                }\r\n\r\n                this.resizeAxes = action.name === 'resize'? action.axis : null;\r\n\r\n                if (action === 'gesture' && this.pointerIds.length < 2) {\r\n                    action = null;\r\n                }\r\n\r\n                this.prepared.name  = action.name;\r\n                this.prepared.axis  = action.axis;\r\n                this.prepared.edges = action.edges;\r\n\r\n                this.snapStatus.snappedX = this.snapStatus.snappedY =\r\n                    this.restrictStatus.restrictedX = this.restrictStatus.restrictedY = NaN;\r\n\r\n                this.downTimes[pointerIndex] = new Date().getTime();\r\n                this.downTargets[pointerIndex] = eventTarget;\r\n                pointerExtend(this.downPointer, pointer);\r\n\r\n                copyCoords(this.prevCoords, this.startCoords);\r\n                this.pointerWasMoved = false;\r\n\r\n                this.checkAndPreventDefault(event, target, this.element);\r\n            }\r\n            // if inertia is active try to resume action\r\n            else if (this.inertiaStatus.active\r\n                && curEventTarget === this.element\r\n                && validateAction(target.getAction(pointer, event, this, this.element), target).name === this.prepared.name) {\r\n\r\n                cancelFrame(this.inertiaStatus.i);\r\n                this.inertiaStatus.active = false;\r\n\r\n                this.checkAndPreventDefault(event, target, this.element);\r\n            }\r\n        },\r\n\r\n        setModifications: function (coords, preEnd) {\r\n            var target         = this.target,\r\n                shouldMove     = true,\r\n                shouldSnap     = checkSnap(target, this.prepared.name)     && (!target.options[this.prepared.name].snap.endOnly     || preEnd),\r\n                shouldRestrict = checkRestrict(target, this.prepared.name) && (!target.options[this.prepared.name].restrict.endOnly || preEnd);\r\n\r\n            if (shouldSnap    ) { this.setSnapping   (coords); } else { this.snapStatus    .locked     = false; }\r\n            if (shouldRestrict) { this.setRestriction(coords); } else { this.restrictStatus.restricted = false; }\r\n\r\n            if (shouldSnap && this.snapStatus.locked && !this.snapStatus.changed) {\r\n                shouldMove = shouldRestrict && this.restrictStatus.restricted && this.restrictStatus.changed;\r\n            }\r\n            else if (shouldRestrict && this.restrictStatus.restricted && !this.restrictStatus.changed) {\r\n                shouldMove = false;\r\n            }\r\n\r\n            return shouldMove;\r\n        },\r\n\r\n        setStartOffsets: function (action, interactable, element) {\r\n            var rect = interactable.getRect(element),\r\n                origin = getOriginXY(interactable, element),\r\n                snap = interactable.options[this.prepared.name].snap,\r\n                restrict = interactable.options[this.prepared.name].restrict,\r\n                width, height;\r\n\r\n            if (rect) {\r\n                this.startOffset.left = this.startCoords.page.x - rect.left;\r\n                this.startOffset.top  = this.startCoords.page.y - rect.top;\r\n\r\n                this.startOffset.right  = rect.right  - this.startCoords.page.x;\r\n                this.startOffset.bottom = rect.bottom - this.startCoords.page.y;\r\n\r\n                if ('width' in rect) { width = rect.width; }\r\n                else { width = rect.right - rect.left; }\r\n                if ('height' in rect) { height = rect.height; }\r\n                else { height = rect.bottom - rect.top; }\r\n            }\r\n            else {\r\n                this.startOffset.left = this.startOffset.top = this.startOffset.right = this.startOffset.bottom = 0;\r\n            }\r\n\r\n            this.snapOffsets.splice(0);\r\n\r\n            var snapOffset = snap && snap.offset === 'startCoords'\r\n                                ? {\r\n                                    x: this.startCoords.page.x - origin.x,\r\n                                    y: this.startCoords.page.y - origin.y\r\n                                }\r\n                                : snap && snap.offset || { x: 0, y: 0 };\r\n\r\n            if (rect && snap && snap.relativePoints && snap.relativePoints.length) {\r\n                for (var i = 0; i < snap.relativePoints.length; i++) {\r\n                    this.snapOffsets.push({\r\n                        x: this.startOffset.left - (width  * snap.relativePoints[i].x) + snapOffset.x,\r\n                        y: this.startOffset.top  - (height * snap.relativePoints[i].y) + snapOffset.y\r\n                    });\r\n                }\r\n            }\r\n            else {\r\n                this.snapOffsets.push(snapOffset);\r\n            }\r\n\r\n            if (rect && restrict.elementRect) {\r\n                this.restrictOffset.left = this.startOffset.left - (width  * restrict.elementRect.left);\r\n                this.restrictOffset.top  = this.startOffset.top  - (height * restrict.elementRect.top);\r\n\r\n                this.restrictOffset.right  = this.startOffset.right  - (width  * (1 - restrict.elementRect.right));\r\n                this.restrictOffset.bottom = this.startOffset.bottom - (height * (1 - restrict.elementRect.bottom));\r\n            }\r\n            else {\r\n                this.restrictOffset.left = this.restrictOffset.top = this.restrictOffset.right = this.restrictOffset.bottom = 0;\r\n            }\r\n        },\r\n\r\n        /*\\\r\n         * Interaction.start\r\n         [ method ]\r\n         *\r\n         * Start an action with the given Interactable and Element as tartgets. The\r\n         * action must be enabled for the target Interactable and an appropriate number\r\n         * of pointers must be held down  1 for drag/resize, 2 for gesture.\r\n         *\r\n         * Use it with `interactable.<action>able({ manualStart: false })` to always\r\n         * [start actions manually](https://github.com/taye/interact.js/issues/114)\r\n         *\r\n         - action       (object)  The action to be performed - drag, resize, etc.\r\n         - interactable (Interactable) The Interactable to target\r\n         - element      (Element) The DOM Element to target\r\n         = (object) interact\r\n         **\r\n         | interact(target)\r\n         |   .draggable({\r\n         |     // disable the default drag start by down->move\r\n         |     manualStart: true\r\n         |   })\r\n         |   // start dragging after the user holds the pointer down\r\n         |   .on('hold', function (event) {\r\n         |     var interaction = event.interaction;\r\n         |\r\n         |     if (!interaction.interacting()) {\r\n         |       interaction.start({ name: 'drag' },\r\n         |                         event.interactable,\r\n         |                         event.currentTarget);\r\n         |     }\r\n         | });\r\n        \\*/\r\n        start: function (action, interactable, element) {\r\n            if (this.interacting()\r\n                || !this.pointerIsDown\r\n                || this.pointerIds.length < (action.name === 'gesture'? 2 : 1)) {\r\n                return;\r\n            }\r\n\r\n            // if this interaction had been removed after stopping\r\n            // add it back\r\n            if (indexOf(interactions, this) === -1) {\r\n                interactions.push(this);\r\n            }\r\n\r\n            // set the startCoords if there was no prepared action\r\n            if (!this.prepared.name) {\r\n                this.setEventXY(this.startCoords);\r\n            }\r\n\r\n            this.prepared.name  = action.name;\r\n            this.prepared.axis  = action.axis;\r\n            this.prepared.edges = action.edges;\r\n            this.target         = interactable;\r\n            this.element        = element;\r\n\r\n            this.setStartOffsets(action.name, interactable, element);\r\n            this.setModifications(this.startCoords.page);\r\n\r\n            this.prevEvent = this[this.prepared.name + 'Start'](this.downEvent);\r\n        },\r\n\r\n        pointerMove: function (pointer, event, eventTarget, curEventTarget, preEnd) {\r\n            if (this.inertiaStatus.active) {\r\n                var pageUp   = this.inertiaStatus.upCoords.page;\r\n                var clientUp = this.inertiaStatus.upCoords.client;\r\n\r\n                var inertiaPosition = {\r\n                    pageX  : pageUp.x   + this.inertiaStatus.sx,\r\n                    pageY  : pageUp.y   + this.inertiaStatus.sy,\r\n                    clientX: clientUp.x + this.inertiaStatus.sx,\r\n                    clientY: clientUp.y + this.inertiaStatus.sy\r\n                };\r\n\r\n                this.setEventXY(this.curCoords, [inertiaPosition]);\r\n            }\r\n            else {\r\n                this.recordPointer(pointer);\r\n                this.setEventXY(this.curCoords, this.pointers);\r\n            }\r\n\r\n            var duplicateMove = (this.curCoords.page.x === this.prevCoords.page.x\r\n                                 && this.curCoords.page.y === this.prevCoords.page.y\r\n                                 && this.curCoords.client.x === this.prevCoords.client.x\r\n                                 && this.curCoords.client.y === this.prevCoords.client.y);\r\n\r\n            var dx, dy,\r\n                pointerIndex = this.mouse? 0 : indexOf(this.pointerIds, getPointerId(pointer));\r\n\r\n            // register movement greater than pointerMoveTolerance\r\n            if (this.pointerIsDown && !this.pointerWasMoved) {\r\n                dx = this.curCoords.client.x - this.startCoords.client.x;\r\n                dy = this.curCoords.client.y - this.startCoords.client.y;\r\n\r\n                this.pointerWasMoved = hypot(dx, dy) > pointerMoveTolerance;\r\n            }\r\n\r\n            if (!duplicateMove && (!this.pointerIsDown || this.pointerWasMoved)) {\r\n                if (this.pointerIsDown) {\r\n                    clearTimeout(this.holdTimers[pointerIndex]);\r\n                }\r\n\r\n                this.collectEventTargets(pointer, event, eventTarget, 'move');\r\n            }\r\n\r\n            if (!this.pointerIsDown) { return; }\r\n\r\n            if (duplicateMove && this.pointerWasMoved && !preEnd) {\r\n                this.checkAndPreventDefault(event, this.target, this.element);\r\n                return;\r\n            }\r\n\r\n            // set pointer coordinate, time changes and speeds\r\n            setEventDeltas(this.pointerDelta, this.prevCoords, this.curCoords);\r\n\r\n            if (!this.prepared.name) { return; }\r\n\r\n            if (this.pointerWasMoved\r\n                // ignore movement while inertia is active\r\n                && (!this.inertiaStatus.active || (pointer instanceof InteractEvent && /inertiastart/.test(pointer.type)))) {\r\n\r\n                // if just starting an action, calculate the pointer speed now\r\n                if (!this.interacting()) {\r\n                    setEventDeltas(this.pointerDelta, this.prevCoords, this.curCoords);\r\n\r\n                    // check if a drag is in the correct axis\r\n                    if (this.prepared.name === 'drag') {\r\n                        var absX = Math.abs(dx),\r\n                            absY = Math.abs(dy),\r\n                            targetAxis = this.target.options.drag.axis,\r\n                            axis = (absX > absY ? 'x' : absX < absY ? 'y' : 'xy');\r\n\r\n                        // if the movement isn't in the axis of the interactable\r\n                        if (axis !== 'xy' && targetAxis !== 'xy' && targetAxis !== axis) {\r\n                            // cancel the prepared action\r\n                            this.prepared.name = null;\r\n\r\n                            // then try to get a drag from another ineractable\r\n\r\n                            var element = eventTarget;\r\n\r\n                            // check element interactables\r\n                            while (isElement(element)) {\r\n                                var elementInteractable = interactables.get(element);\r\n\r\n                                if (elementInteractable\r\n                                    && elementInteractable !== this.target\r\n                                    && !elementInteractable.options.drag.manualStart\r\n                                    && elementInteractable.getAction(this.downPointer, this.downEvent, this, element).name === 'drag'\r\n                                    && checkAxis(axis, elementInteractable)) {\r\n\r\n                                    this.prepared.name = 'drag';\r\n                                    this.target = elementInteractable;\r\n                                    this.element = element;\r\n                                    break;\r\n                                }\r\n\r\n                                element = parentElement(element);\r\n                            }\r\n\r\n                            // if there's no drag from element interactables,\r\n                            // check the selector interactables\r\n                            if (!this.prepared.name) {\r\n                                var thisInteraction = this;\r\n\r\n                                var getDraggable = function (interactable, selector, context) {\r\n                                    var elements = ie8MatchesSelector\r\n                                        ? context.querySelectorAll(selector)\r\n                                        : undefined;\r\n\r\n                                    if (interactable === thisInteraction.target) { return; }\r\n\r\n                                    if (inContext(interactable, eventTarget)\r\n                                        && !interactable.options.drag.manualStart\r\n                                        && !testIgnore(interactable, element, eventTarget)\r\n                                        && testAllow(interactable, element, eventTarget)\r\n                                        && matchesSelector(element, selector, elements)\r\n                                        && interactable.getAction(thisInteraction.downPointer, thisInteraction.downEvent, thisInteraction, element).name === 'drag'\r\n                                        && checkAxis(axis, interactable)\r\n                                        && withinInteractionLimit(interactable, element, 'drag')) {\r\n\r\n                                        return interactable;\r\n                                    }\r\n                                };\r\n\r\n                                element = eventTarget;\r\n\r\n                                while (isElement(element)) {\r\n                                    var selectorInteractable = interactables.forEachSelector(getDraggable);\r\n\r\n                                    if (selectorInteractable) {\r\n                                        this.prepared.name = 'drag';\r\n                                        this.target = selectorInteractable;\r\n                                        this.element = element;\r\n                                        break;\r\n                                    }\r\n\r\n                                    element = parentElement(element);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                var starting = !!this.prepared.name && !this.interacting();\r\n\r\n                if (starting\r\n                    && (this.target.options[this.prepared.name].manualStart\r\n                        || !withinInteractionLimit(this.target, this.element, this.prepared))) {\r\n                    this.stop(event);\r\n                    return;\r\n                }\r\n\r\n                if (this.prepared.name && this.target) {\r\n                    if (starting) {\r\n                        this.start(this.prepared, this.target, this.element);\r\n                    }\r\n\r\n                    var shouldMove = this.setModifications(this.curCoords.page, preEnd);\r\n\r\n                    // move if snapping or restriction doesn't prevent it\r\n                    if (shouldMove || starting) {\r\n                        this.prevEvent = this[this.prepared.name + 'Move'](event);\r\n                    }\r\n\r\n                    this.checkAndPreventDefault(event, this.target, this.element);\r\n                }\r\n            }\r\n\r\n            copyCoords(this.prevCoords, this.curCoords);\r\n\r\n            if (this.dragging || this.resizing) {\r\n                this.autoScrollMove(pointer);\r\n            }\r\n        },\r\n\r\n        dragStart: function (event) {\r\n            var dragEvent = new InteractEvent(this, event, 'drag', 'start', this.element);\r\n\r\n            this.dragging = true;\r\n            this.target.fire(dragEvent);\r\n\r\n            // reset active dropzones\r\n            this.activeDrops.dropzones = [];\r\n            this.activeDrops.elements  = [];\r\n            this.activeDrops.rects     = [];\r\n\r\n            if (!this.dynamicDrop) {\r\n                this.setActiveDrops(this.element);\r\n            }\r\n\r\n            var dropEvents = this.getDropEvents(event, dragEvent);\r\n\r\n            if (dropEvents.activate) {\r\n                this.fireActiveDrops(dropEvents.activate);\r\n            }\r\n\r\n            return dragEvent;\r\n        },\r\n\r\n        dragMove: function (event) {\r\n            var target = this.target,\r\n                dragEvent  = new InteractEvent(this, event, 'drag', 'move', this.element),\r\n                draggableElement = this.element,\r\n                drop = this.getDrop(dragEvent, event, draggableElement);\r\n\r\n            this.dropTarget = drop.dropzone;\r\n            this.dropElement = drop.element;\r\n\r\n            var dropEvents = this.getDropEvents(event, dragEvent);\r\n\r\n            target.fire(dragEvent);\r\n\r\n            if (dropEvents.leave) { this.prevDropTarget.fire(dropEvents.leave); }\r\n            if (dropEvents.enter) {     this.dropTarget.fire(dropEvents.enter); }\r\n            if (dropEvents.move ) {     this.dropTarget.fire(dropEvents.move ); }\r\n\r\n            this.prevDropTarget  = this.dropTarget;\r\n            this.prevDropElement = this.dropElement;\r\n\r\n            return dragEvent;\r\n        },\r\n\r\n        resizeStart: function (event) {\r\n            var resizeEvent = new InteractEvent(this, event, 'resize', 'start', this.element);\r\n\r\n            if (this.prepared.edges) {\r\n                var startRect = this.target.getRect(this.element);\r\n\r\n                /*\r\n                 * When using the `resizable.square` or `resizable.preserveAspectRatio` options, resizing from one edge\r\n                 * will affect another. E.g. with `resizable.square`, resizing to make the right edge larger will make\r\n                 * the bottom edge larger by the same amount. We call these 'linked' edges. Any linked edges will depend\r\n                 * on the active edges and the edge being interacted with.\r\n                 */\r\n                if (this.target.options.resize.square || this.target.options.resize.preserveAspectRatio) {\r\n                    var linkedEdges = extend({}, this.prepared.edges);\r\n\r\n                    linkedEdges.top    = linkedEdges.top    || (linkedEdges.left   && !linkedEdges.bottom);\r\n                    linkedEdges.left   = linkedEdges.left   || (linkedEdges.top    && !linkedEdges.right );\r\n                    linkedEdges.bottom = linkedEdges.bottom || (linkedEdges.right  && !linkedEdges.top   );\r\n                    linkedEdges.right  = linkedEdges.right  || (linkedEdges.bottom && !linkedEdges.left  );\r\n\r\n                    this.prepared._linkedEdges = linkedEdges;\r\n                }\r\n                else {\r\n                    this.prepared._linkedEdges = null;\r\n                }\r\n\r\n                // if using `resizable.preserveAspectRatio` option, record aspect ratio at the start of the resize\r\n                if (this.target.options.resize.preserveAspectRatio) {\r\n                    this.resizeStartAspectRatio = startRect.width / startRect.height;\r\n                }\r\n\r\n                this.resizeRects = {\r\n                    start     : startRect,\r\n                    current   : extend({}, startRect),\r\n                    restricted: extend({}, startRect),\r\n                    previous  : extend({}, startRect),\r\n                    delta     : {\r\n                        left: 0, right : 0, width : 0,\r\n                        top : 0, bottom: 0, height: 0\r\n                    }\r\n                };\r\n\r\n                resizeEvent.rect = this.resizeRects.restricted;\r\n                resizeEvent.deltaRect = this.resizeRects.delta;\r\n            }\r\n\r\n            this.target.fire(resizeEvent);\r\n\r\n            this.resizing = true;\r\n\r\n            return resizeEvent;\r\n        },\r\n\r\n        resizeMove: function (event) {\r\n            var resizeEvent = new InteractEvent(this, event, 'resize', 'move', this.element);\r\n\r\n            var edges = this.prepared.edges,\r\n                invert = this.target.options.resize.invert,\r\n                invertible = invert === 'reposition' || invert === 'negate';\r\n\r\n            if (edges) {\r\n                var dx = resizeEvent.dx,\r\n                    dy = resizeEvent.dy,\r\n\r\n                    start      = this.resizeRects.start,\r\n                    current    = this.resizeRects.current,\r\n                    restricted = this.resizeRects.restricted,\r\n                    delta      = this.resizeRects.delta,\r\n                    previous   = extend(this.resizeRects.previous, restricted),\r\n\r\n                    originalEdges = edges;\r\n\r\n                // `resize.preserveAspectRatio` takes precedence over `resize.square`\r\n                if (this.target.options.resize.preserveAspectRatio) {\r\n                    var resizeStartAspectRatio = this.resizeStartAspectRatio;\r\n\r\n                    edges = this.prepared._linkedEdges;\r\n\r\n                    if ((originalEdges.left && originalEdges.bottom)\r\n                        || (originalEdges.right && originalEdges.top)) {\r\n                        dy = -dx / resizeStartAspectRatio;\r\n                    }\r\n                    else if (originalEdges.left || originalEdges.right) { dy = dx / resizeStartAspectRatio; }\r\n                    else if (originalEdges.top || originalEdges.bottom) { dx = dy * resizeStartAspectRatio; }\r\n                }\r\n                else if (this.target.options.resize.square) {\r\n                    edges = this.prepared._linkedEdges;\r\n\r\n                    if ((originalEdges.left && originalEdges.bottom)\r\n                        || (originalEdges.right && originalEdges.top)) {\r\n                        dy = -dx;\r\n                    }\r\n                    else if (originalEdges.left || originalEdges.right) { dy = dx; }\r\n                    else if (originalEdges.top || originalEdges.bottom) { dx = dy; }\r\n                }\r\n\r\n                // update the 'current' rect without modifications\r\n                if (edges.top   ) { current.top    += dy; }\r\n                if (edges.bottom) { current.bottom += dy; }\r\n                if (edges.left  ) { current.left   += dx; }\r\n                if (edges.right ) { current.right  += dx; }\r\n\r\n                if (invertible) {\r\n                    // if invertible, copy the current rect\r\n                    extend(restricted, current);\r\n\r\n                    if (invert === 'reposition') {\r\n                        // swap edge values if necessary to keep width/height positive\r\n                        var swap;\r\n\r\n                        if (restricted.top > restricted.bottom) {\r\n                            swap = restricted.top;\r\n\r\n                            restricted.top = restricted.bottom;\r\n                            restricted.bottom = swap;\r\n                        }\r\n                        if (restricted.left > restricted.right) {\r\n                            swap = restricted.left;\r\n\r\n                            restricted.left = restricted.right;\r\n                            restricted.right = swap;\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    // if not invertible, restrict to minimum of 0x0 rect\r\n                    restricted.top    = Math.min(current.top, start.bottom);\r\n                    restricted.bottom = Math.max(current.bottom, start.top);\r\n                    restricted.left   = Math.min(current.left, start.right);\r\n                    restricted.right  = Math.max(current.right, start.left);\r\n                }\r\n\r\n                restricted.width  = restricted.right  - restricted.left;\r\n                restricted.height = restricted.bottom - restricted.top ;\r\n\r\n                for (var edge in restricted) {\r\n                    delta[edge] = restricted[edge] - previous[edge];\r\n                }\r\n\r\n                resizeEvent.edges = this.prepared.edges;\r\n                resizeEvent.rect = restricted;\r\n                resizeEvent.deltaRect = delta;\r\n            }\r\n\r\n            this.target.fire(resizeEvent);\r\n\r\n            return resizeEvent;\r\n        },\r\n\r\n        gestureStart: function (event) {\r\n            var gestureEvent = new InteractEvent(this, event, 'gesture', 'start', this.element);\r\n\r\n            gestureEvent.ds = 0;\r\n\r\n            this.gesture.startDistance = this.gesture.prevDistance = gestureEvent.distance;\r\n            this.gesture.startAngle = this.gesture.prevAngle = gestureEvent.angle;\r\n            this.gesture.scale = 1;\r\n\r\n            this.gesturing = true;\r\n\r\n            this.target.fire(gestureEvent);\r\n\r\n            return gestureEvent;\r\n        },\r\n\r\n        gestureMove: function (event) {\r\n            if (!this.pointerIds.length) {\r\n                return this.prevEvent;\r\n            }\r\n\r\n            var gestureEvent;\r\n\r\n            gestureEvent = new InteractEvent(this, event, 'gesture', 'move', this.element);\r\n            gestureEvent.ds = gestureEvent.scale - this.gesture.scale;\r\n\r\n            this.target.fire(gestureEvent);\r\n\r\n            this.gesture.prevAngle = gestureEvent.angle;\r\n            this.gesture.prevDistance = gestureEvent.distance;\r\n\r\n            if (gestureEvent.scale !== Infinity &&\r\n                gestureEvent.scale !== null &&\r\n                gestureEvent.scale !== undefined  &&\r\n                !isNaN(gestureEvent.scale)) {\r\n\r\n                this.gesture.scale = gestureEvent.scale;\r\n            }\r\n\r\n            return gestureEvent;\r\n        },\r\n\r\n        pointerHold: function (pointer, event, eventTarget) {\r\n            this.collectEventTargets(pointer, event, eventTarget, 'hold');\r\n        },\r\n\r\n        pointerUp: function (pointer, event, eventTarget, curEventTarget) {\r\n            var pointerIndex = this.mouse? 0 : indexOf(this.pointerIds, getPointerId(pointer));\r\n\r\n            clearTimeout(this.holdTimers[pointerIndex]);\r\n\r\n            this.collectEventTargets(pointer, event, eventTarget, 'up' );\r\n            this.collectEventTargets(pointer, event, eventTarget, 'tap');\r\n\r\n            this.pointerEnd(pointer, event, eventTarget, curEventTarget);\r\n\r\n            this.removePointer(pointer);\r\n        },\r\n\r\n        pointerCancel: function (pointer, event, eventTarget, curEventTarget) {\r\n            var pointerIndex = this.mouse? 0 : indexOf(this.pointerIds, getPointerId(pointer));\r\n\r\n            clearTimeout(this.holdTimers[pointerIndex]);\r\n\r\n            this.collectEventTargets(pointer, event, eventTarget, 'cancel');\r\n            this.pointerEnd(pointer, event, eventTarget, curEventTarget);\r\n\r\n            this.removePointer(pointer);\r\n        },\r\n\r\n        // http://www.quirksmode.org/dom/events/click.html\r\n        // >Events leading to dblclick\r\n        //\r\n        // IE8 doesn't fire down event before dblclick.\r\n        // This workaround tries to fire a tap and doubletap after dblclick\r\n        ie8Dblclick: function (pointer, event, eventTarget) {\r\n            if (this.prevTap\r\n                && event.clientX === this.prevTap.clientX\r\n                && event.clientY === this.prevTap.clientY\r\n                && eventTarget   === this.prevTap.target) {\r\n\r\n                this.downTargets[0] = eventTarget;\r\n                this.downTimes[0] = new Date().getTime();\r\n                this.collectEventTargets(pointer, event, eventTarget, 'tap');\r\n            }\r\n        },\r\n\r\n        // End interact move events and stop auto-scroll unless inertia is enabled\r\n        pointerEnd: function (pointer, event, eventTarget, curEventTarget) {\r\n            var endEvent,\r\n                target = this.target,\r\n                options = target && target.options,\r\n                inertiaOptions = options && this.prepared.name && options[this.prepared.name].inertia,\r\n                inertiaStatus = this.inertiaStatus;\r\n\r\n            if (this.interacting()) {\r\n\r\n                if (inertiaStatus.active && !inertiaStatus.ending) { return; }\r\n\r\n                var pointerSpeed,\r\n                    now = new Date().getTime(),\r\n                    inertiaPossible = false,\r\n                    inertia = false,\r\n                    smoothEnd = false,\r\n                    endSnap = checkSnap(target, this.prepared.name) && options[this.prepared.name].snap.endOnly,\r\n                    endRestrict = checkRestrict(target, this.prepared.name) && options[this.prepared.name].restrict.endOnly,\r\n                    dx = 0,\r\n                    dy = 0,\r\n                    startEvent;\r\n\r\n                if (this.dragging) {\r\n                    if      (options.drag.axis === 'x' ) { pointerSpeed = Math.abs(this.pointerDelta.client.vx); }\r\n                    else if (options.drag.axis === 'y' ) { pointerSpeed = Math.abs(this.pointerDelta.client.vy); }\r\n                    else   /*options.drag.axis === 'xy'*/{ pointerSpeed = this.pointerDelta.client.speed; }\r\n                }\r\n                else {\r\n                    pointerSpeed = this.pointerDelta.client.speed;\r\n                }\r\n\r\n                // check if inertia should be started\r\n                inertiaPossible = (inertiaOptions && inertiaOptions.enabled\r\n                                   && this.prepared.name !== 'gesture'\r\n                                   && event !== inertiaStatus.startEvent);\r\n\r\n                inertia = (inertiaPossible\r\n                           && (now - this.curCoords.timeStamp) < 50\r\n                           && pointerSpeed > inertiaOptions.minSpeed\r\n                           && pointerSpeed > inertiaOptions.endSpeed);\r\n\r\n                if (inertiaPossible && !inertia && (endSnap || endRestrict)) {\r\n\r\n                    var snapRestrict = {};\r\n\r\n                    snapRestrict.snap = snapRestrict.restrict = snapRestrict;\r\n\r\n                    if (endSnap) {\r\n                        this.setSnapping(this.curCoords.page, snapRestrict);\r\n                        if (snapRestrict.locked) {\r\n                            dx += snapRestrict.dx;\r\n                            dy += snapRestrict.dy;\r\n                        }\r\n                    }\r\n\r\n                    if (endRestrict) {\r\n                        this.setRestriction(this.curCoords.page, snapRestrict);\r\n                        if (snapRestrict.restricted) {\r\n                            dx += snapRestrict.dx;\r\n                            dy += snapRestrict.dy;\r\n                        }\r\n                    }\r\n\r\n                    if (dx || dy) {\r\n                        smoothEnd = true;\r\n                    }\r\n                }\r\n\r\n                if (inertia || smoothEnd) {\r\n                    copyCoords(inertiaStatus.upCoords, this.curCoords);\r\n\r\n                    this.pointers[0] = inertiaStatus.startEvent = startEvent =\r\n                        new InteractEvent(this, event, this.prepared.name, 'inertiastart', this.element);\r\n\r\n                    inertiaStatus.t0 = now;\r\n\r\n                    target.fire(inertiaStatus.startEvent);\r\n\r\n                    if (inertia) {\r\n                        inertiaStatus.vx0 = this.pointerDelta.client.vx;\r\n                        inertiaStatus.vy0 = this.pointerDelta.client.vy;\r\n                        inertiaStatus.v0 = pointerSpeed;\r\n\r\n                        this.calcInertia(inertiaStatus);\r\n\r\n                        var page = extend({}, this.curCoords.page),\r\n                            origin = getOriginXY(target, this.element),\r\n                            statusObject;\r\n\r\n                        page.x = page.x + inertiaStatus.xe - origin.x;\r\n                        page.y = page.y + inertiaStatus.ye - origin.y;\r\n\r\n                        statusObject = {\r\n                            useStatusXY: true,\r\n                            x: page.x,\r\n                            y: page.y,\r\n                            dx: 0,\r\n                            dy: 0,\r\n                            snap: null\r\n                        };\r\n\r\n                        statusObject.snap = statusObject;\r\n\r\n                        dx = dy = 0;\r\n\r\n                        if (endSnap) {\r\n                            var snap = this.setSnapping(this.curCoords.page, statusObject);\r\n\r\n                            if (snap.locked) {\r\n                                dx += snap.dx;\r\n                                dy += snap.dy;\r\n                            }\r\n                        }\r\n\r\n                        if (endRestrict) {\r\n                            var restrict = this.setRestriction(this.curCoords.page, statusObject);\r\n\r\n                            if (restrict.restricted) {\r\n                                dx += restrict.dx;\r\n                                dy += restrict.dy;\r\n                            }\r\n                        }\r\n\r\n                        inertiaStatus.modifiedXe += dx;\r\n                        inertiaStatus.modifiedYe += dy;\r\n\r\n                        inertiaStatus.i = reqFrame(this.boundInertiaFrame);\r\n                    }\r\n                    else {\r\n                        inertiaStatus.smoothEnd = true;\r\n                        inertiaStatus.xe = dx;\r\n                        inertiaStatus.ye = dy;\r\n\r\n                        inertiaStatus.sx = inertiaStatus.sy = 0;\r\n\r\n                        inertiaStatus.i = reqFrame(this.boundSmoothEndFrame);\r\n                    }\r\n\r\n                    inertiaStatus.active = true;\r\n                    return;\r\n                }\r\n\r\n                if (endSnap || endRestrict) {\r\n                    // fire a move event at the snapped coordinates\r\n                    this.pointerMove(pointer, event, eventTarget, curEventTarget, true);\r\n                }\r\n            }\r\n\r\n            if (this.dragging) {\r\n                endEvent = new InteractEvent(this, event, 'drag', 'end', this.element);\r\n\r\n                var draggableElement = this.element,\r\n                    drop = this.getDrop(endEvent, event, draggableElement);\r\n\r\n                this.dropTarget = drop.dropzone;\r\n                this.dropElement = drop.element;\r\n\r\n                var dropEvents = this.getDropEvents(event, endEvent);\r\n\r\n                if (dropEvents.leave) { this.prevDropTarget.fire(dropEvents.leave); }\r\n                if (dropEvents.enter) {     this.dropTarget.fire(dropEvents.enter); }\r\n                if (dropEvents.drop ) {     this.dropTarget.fire(dropEvents.drop ); }\r\n                if (dropEvents.deactivate) {\r\n                    this.fireActiveDrops(dropEvents.deactivate);\r\n                }\r\n\r\n                target.fire(endEvent);\r\n            }\r\n            else if (this.resizing) {\r\n                endEvent = new InteractEvent(this, event, 'resize', 'end', this.element);\r\n                target.fire(endEvent);\r\n            }\r\n            else if (this.gesturing) {\r\n                endEvent = new InteractEvent(this, event, 'gesture', 'end', this.element);\r\n                target.fire(endEvent);\r\n            }\r\n\r\n            this.stop(event);\r\n        },\r\n\r\n        collectDrops: function (element) {\r\n            var drops = [],\r\n                elements = [],\r\n                i;\r\n\r\n            element = element || this.element;\r\n\r\n            // collect all dropzones and their elements which qualify for a drop\r\n            for (i = 0; i < interactables.length; i++) {\r\n                if (!interactables[i].options.drop.enabled) { continue; }\r\n\r\n                var current = interactables[i],\r\n                    accept = current.options.drop.accept;\r\n\r\n                // test the draggable element against the dropzone's accept setting\r\n                if ((isElement(accept) && accept !== element)\r\n                    || (isString(accept)\r\n                        && !matchesSelector(element, accept))) {\r\n\r\n                    continue;\r\n                }\r\n\r\n                // query for new elements if necessary\r\n                var dropElements = current.selector? current._context.querySelectorAll(current.selector) : [current._element];\r\n\r\n                for (var j = 0, len = dropElements.length; j < len; j++) {\r\n                    var currentElement = dropElements[j];\r\n\r\n                    if (currentElement === element) {\r\n                        continue;\r\n                    }\r\n\r\n                    drops.push(current);\r\n                    elements.push(currentElement);\r\n                }\r\n            }\r\n\r\n            return {\r\n                dropzones: drops,\r\n                elements: elements\r\n            };\r\n        },\r\n\r\n        fireActiveDrops: function (event) {\r\n            var i,\r\n                current,\r\n                currentElement,\r\n                prevElement;\r\n\r\n            // loop through all active dropzones and trigger event\r\n            for (i = 0; i < this.activeDrops.dropzones.length; i++) {\r\n                current = this.activeDrops.dropzones[i];\r\n                currentElement = this.activeDrops.elements [i];\r\n\r\n                // prevent trigger of duplicate events on same element\r\n                if (currentElement !== prevElement) {\r\n                    // set current element as event target\r\n                    event.target = currentElement;\r\n                    current.fire(event);\r\n                }\r\n                prevElement = currentElement;\r\n            }\r\n        },\r\n\r\n        // Collect a new set of possible drops and save them in activeDrops.\r\n        // setActiveDrops should always be called when a drag has just started or a\r\n        // drag event happens while dynamicDrop is true\r\n        setActiveDrops: function (dragElement) {\r\n            // get dropzones and their elements that could receive the draggable\r\n            var possibleDrops = this.collectDrops(dragElement, true);\r\n\r\n            this.activeDrops.dropzones = possibleDrops.dropzones;\r\n            this.activeDrops.elements  = possibleDrops.elements;\r\n            this.activeDrops.rects     = [];\r\n\r\n            for (var i = 0; i < this.activeDrops.dropzones.length; i++) {\r\n                this.activeDrops.rects[i] = this.activeDrops.dropzones[i].getRect(this.activeDrops.elements[i]);\r\n            }\r\n        },\r\n\r\n        getDrop: function (dragEvent, event, dragElement) {\r\n            var validDrops = [];\r\n\r\n            if (dynamicDrop) {\r\n                this.setActiveDrops(dragElement);\r\n            }\r\n\r\n            // collect all dropzones and their elements which qualify for a drop\r\n            for (var j = 0; j < this.activeDrops.dropzones.length; j++) {\r\n                var current        = this.activeDrops.dropzones[j],\r\n                    currentElement = this.activeDrops.elements [j],\r\n                    rect           = this.activeDrops.rects    [j];\r\n\r\n                validDrops.push(current.dropCheck(dragEvent, event, this.target, dragElement, currentElement, rect)\r\n                                ? currentElement\r\n                                : null);\r\n            }\r\n\r\n            // get the most appropriate dropzone based on DOM depth and order\r\n            var dropIndex = indexOfDeepestElement(validDrops),\r\n                dropzone  = this.activeDrops.dropzones[dropIndex] || null,\r\n                element   = this.activeDrops.elements [dropIndex] || null;\r\n\r\n            return {\r\n                dropzone: dropzone,\r\n                element: element\r\n            };\r\n        },\r\n\r\n        getDropEvents: function (pointerEvent, dragEvent) {\r\n            var dropEvents = {\r\n                enter     : null,\r\n                leave     : null,\r\n                activate  : null,\r\n                deactivate: null,\r\n                move      : null,\r\n                drop      : null\r\n            };\r\n\r\n            if (this.dropElement !== this.prevDropElement) {\r\n                // if there was a prevDropTarget, create a dragleave event\r\n                if (this.prevDropTarget) {\r\n                    dropEvents.leave = {\r\n                        target       : this.prevDropElement,\r\n                        dropzone     : this.prevDropTarget,\r\n                        relatedTarget: dragEvent.target,\r\n                        draggable    : dragEvent.interactable,\r\n                        dragEvent    : dragEvent,\r\n                        interaction  : this,\r\n                        timeStamp    : dragEvent.timeStamp,\r\n                        type         : 'dragleave'\r\n                    };\r\n\r\n                    dragEvent.dragLeave = this.prevDropElement;\r\n                    dragEvent.prevDropzone = this.prevDropTarget;\r\n                }\r\n                // if the dropTarget is not null, create a dragenter event\r\n                if (this.dropTarget) {\r\n                    dropEvents.enter = {\r\n                        target       : this.dropElement,\r\n                        dropzone     : this.dropTarget,\r\n                        relatedTarget: dragEvent.target,\r\n                        draggable    : dragEvent.interactable,\r\n                        dragEvent    : dragEvent,\r\n                        interaction  : this,\r\n                        timeStamp    : dragEvent.timeStamp,\r\n                        type         : 'dragenter'\r\n                    };\r\n\r\n                    dragEvent.dragEnter = this.dropElement;\r\n                    dragEvent.dropzone = this.dropTarget;\r\n                }\r\n            }\r\n\r\n            if (dragEvent.type === 'dragend' && this.dropTarget) {\r\n                dropEvents.drop = {\r\n                    target       : this.dropElement,\r\n                    dropzone     : this.dropTarget,\r\n                    relatedTarget: dragEvent.target,\r\n                    draggable    : dragEvent.interactable,\r\n                    dragEvent    : dragEvent,\r\n                    interaction  : this,\r\n                    timeStamp    : dragEvent.timeStamp,\r\n                    type         : 'drop'\r\n                };\r\n\r\n                dragEvent.dropzone = this.dropTarget;\r\n            }\r\n            if (dragEvent.type === 'dragstart') {\r\n                dropEvents.activate = {\r\n                    target       : null,\r\n                    dropzone     : null,\r\n                    relatedTarget: dragEvent.target,\r\n                    draggable    : dragEvent.interactable,\r\n                    dragEvent    : dragEvent,\r\n                    interaction  : this,\r\n                    timeStamp    : dragEvent.timeStamp,\r\n                    type         : 'dropactivate'\r\n                };\r\n            }\r\n            if (dragEvent.type === 'dragend') {\r\n                dropEvents.deactivate = {\r\n                    target       : null,\r\n                    dropzone     : null,\r\n                    relatedTarget: dragEvent.target,\r\n                    draggable    : dragEvent.interactable,\r\n                    dragEvent    : dragEvent,\r\n                    interaction  : this,\r\n                    timeStamp    : dragEvent.timeStamp,\r\n                    type         : 'dropdeactivate'\r\n                };\r\n            }\r\n            if (dragEvent.type === 'dragmove' && this.dropTarget) {\r\n                dropEvents.move = {\r\n                    target       : this.dropElement,\r\n                    dropzone     : this.dropTarget,\r\n                    relatedTarget: dragEvent.target,\r\n                    draggable    : dragEvent.interactable,\r\n                    dragEvent    : dragEvent,\r\n                    interaction  : this,\r\n                    dragmove     : dragEvent,\r\n                    timeStamp    : dragEvent.timeStamp,\r\n                    type         : 'dropmove'\r\n                };\r\n                dragEvent.dropzone = this.dropTarget;\r\n            }\r\n\r\n            return dropEvents;\r\n        },\r\n\r\n        currentAction: function () {\r\n            return (this.dragging && 'drag') || (this.resizing && 'resize') || (this.gesturing && 'gesture') || null;\r\n        },\r\n\r\n        interacting: function () {\r\n            return this.dragging || this.resizing || this.gesturing;\r\n        },\r\n\r\n        clearTargets: function () {\r\n            this.target = this.element = null;\r\n\r\n            this.dropTarget = this.dropElement = this.prevDropTarget = this.prevDropElement = null;\r\n        },\r\n\r\n        stop: function (event) {\r\n            if (this.interacting()) {\r\n                autoScroll.stop();\r\n                this.matches = [];\r\n                this.matchElements = [];\r\n\r\n                var target = this.target;\r\n\r\n                if (target.options.styleCursor) {\r\n                    target._doc.documentElement.style.cursor = '';\r\n                }\r\n\r\n                // prevent Default only if were previously interacting\r\n                if (event && isFunction(event.preventDefault)) {\r\n                    this.checkAndPreventDefault(event, target, this.element);\r\n                }\r\n\r\n                if (this.dragging) {\r\n                    this.activeDrops.dropzones = this.activeDrops.elements = this.activeDrops.rects = null;\r\n                }\r\n            }\r\n\r\n            this.clearTargets();\r\n\r\n            this.pointerIsDown = this.snapStatus.locked = this.dragging = this.resizing = this.gesturing = false;\r\n            this.prepared.name = this.prevEvent = null;\r\n            this.inertiaStatus.resumeDx = this.inertiaStatus.resumeDy = 0;\r\n\r\n            // remove pointers if their ID isn't in this.pointerIds\r\n            for (var i = 0; i < this.pointers.length; i++) {\r\n                if (indexOf(this.pointerIds, getPointerId(this.pointers[i])) === -1) {\r\n                    this.pointers.splice(i, 1);\r\n                }\r\n            }\r\n        },\r\n\r\n        inertiaFrame: function () {\r\n            var inertiaStatus = this.inertiaStatus,\r\n                options = this.target.options[this.prepared.name].inertia,\r\n                lambda = options.resistance,\r\n                t = new Date().getTime() / 1000 - inertiaStatus.t0;\r\n\r\n            if (t < inertiaStatus.te) {\r\n\r\n                var progress =  1 - (Math.exp(-lambda * t) - inertiaStatus.lambda_v0) / inertiaStatus.one_ve_v0;\r\n\r\n                if (inertiaStatus.modifiedXe === inertiaStatus.xe && inertiaStatus.modifiedYe === inertiaStatus.ye) {\r\n                    inertiaStatus.sx = inertiaStatus.xe * progress;\r\n                    inertiaStatus.sy = inertiaStatus.ye * progress;\r\n                }\r\n                else {\r\n                    var quadPoint = getQuadraticCurvePoint(\r\n                            0, 0,\r\n                            inertiaStatus.xe, inertiaStatus.ye,\r\n                            inertiaStatus.modifiedXe, inertiaStatus.modifiedYe,\r\n                            progress);\r\n\r\n                    inertiaStatus.sx = quadPoint.x;\r\n                    inertiaStatus.sy = quadPoint.y;\r\n                }\r\n\r\n                this.pointerMove(inertiaStatus.startEvent, inertiaStatus.startEvent);\r\n\r\n                inertiaStatus.i = reqFrame(this.boundInertiaFrame);\r\n            }\r\n            else {\r\n                inertiaStatus.ending = true;\r\n\r\n                inertiaStatus.sx = inertiaStatus.modifiedXe;\r\n                inertiaStatus.sy = inertiaStatus.modifiedYe;\r\n\r\n                this.pointerMove(inertiaStatus.startEvent, inertiaStatus.startEvent);\r\n                this.pointerEnd(inertiaStatus.startEvent, inertiaStatus.startEvent);\r\n\r\n                inertiaStatus.active = inertiaStatus.ending = false;\r\n            }\r\n        },\r\n\r\n        smoothEndFrame: function () {\r\n            var inertiaStatus = this.inertiaStatus,\r\n                t = new Date().getTime() - inertiaStatus.t0,\r\n                duration = this.target.options[this.prepared.name].inertia.smoothEndDuration;\r\n\r\n            if (t < duration) {\r\n                inertiaStatus.sx = easeOutQuad(t, 0, inertiaStatus.xe, duration);\r\n                inertiaStatus.sy = easeOutQuad(t, 0, inertiaStatus.ye, duration);\r\n\r\n                this.pointerMove(inertiaStatus.startEvent, inertiaStatus.startEvent);\r\n\r\n                inertiaStatus.i = reqFrame(this.boundSmoothEndFrame);\r\n            }\r\n            else {\r\n                inertiaStatus.ending = true;\r\n\r\n                inertiaStatus.sx = inertiaStatus.xe;\r\n                inertiaStatus.sy = inertiaStatus.ye;\r\n\r\n                this.pointerMove(inertiaStatus.startEvent, inertiaStatus.startEvent);\r\n                this.pointerEnd(inertiaStatus.startEvent, inertiaStatus.startEvent);\r\n\r\n                inertiaStatus.smoothEnd =\r\n                  inertiaStatus.active = inertiaStatus.ending = false;\r\n            }\r\n        },\r\n\r\n        addPointer: function (pointer) {\r\n            var id = getPointerId(pointer),\r\n                index = this.mouse? 0 : indexOf(this.pointerIds, id);\r\n\r\n            if (index === -1) {\r\n                index = this.pointerIds.length;\r\n            }\r\n\r\n            this.pointerIds[index] = id;\r\n            this.pointers[index] = pointer;\r\n\r\n            return index;\r\n        },\r\n\r\n        removePointer: function (pointer) {\r\n            var id = getPointerId(pointer),\r\n                index = this.mouse? 0 : indexOf(this.pointerIds, id);\r\n\r\n            if (index === -1) { return; }\r\n\r\n            this.pointers   .splice(index, 1);\r\n            this.pointerIds .splice(index, 1);\r\n            this.downTargets.splice(index, 1);\r\n            this.downTimes  .splice(index, 1);\r\n            this.holdTimers .splice(index, 1);\r\n        },\r\n\r\n        recordPointer: function (pointer) {\r\n            var index = this.mouse? 0: indexOf(this.pointerIds, getPointerId(pointer));\r\n\r\n            if (index === -1) { return; }\r\n\r\n            this.pointers[index] = pointer;\r\n        },\r\n\r\n        collectEventTargets: function (pointer, event, eventTarget, eventType) {\r\n            var pointerIndex = this.mouse? 0 : indexOf(this.pointerIds, getPointerId(pointer));\r\n\r\n            // do not fire a tap event if the pointer was moved before being lifted\r\n            if (eventType === 'tap' && (this.pointerWasMoved\r\n                // or if the pointerup target is different to the pointerdown target\r\n                || !(this.downTargets[pointerIndex] && this.downTargets[pointerIndex] === eventTarget))) {\r\n                return;\r\n            }\r\n\r\n            var targets = [],\r\n                elements = [],\r\n                element = eventTarget;\r\n\r\n            function collectSelectors (interactable, selector, context) {\r\n                var els = ie8MatchesSelector\r\n                        ? context.querySelectorAll(selector)\r\n                        : undefined;\r\n\r\n                if (interactable._iEvents[eventType]\r\n                    && isElement(element)\r\n                    && inContext(interactable, element)\r\n                    && !testIgnore(interactable, element, eventTarget)\r\n                    && testAllow(interactable, element, eventTarget)\r\n                    && matchesSelector(element, selector, els)) {\r\n\r\n                    targets.push(interactable);\r\n                    elements.push(element);\r\n                }\r\n            }\r\n\r\n            while (element) {\r\n                if (interact.isSet(element) && interact(element)._iEvents[eventType]) {\r\n                    targets.push(interact(element));\r\n                    elements.push(element);\r\n                }\r\n\r\n                interactables.forEachSelector(collectSelectors);\r\n\r\n                element = parentElement(element);\r\n            }\r\n\r\n            // create the tap event even if there are no listeners so that\r\n            // doubletap can still be created and fired\r\n            if (targets.length || eventType === 'tap') {\r\n                this.firePointers(pointer, event, eventTarget, targets, elements, eventType);\r\n            }\r\n        },\r\n\r\n        firePointers: function (pointer, event, eventTarget, targets, elements, eventType) {\r\n            var pointerIndex = this.mouse? 0 : indexOf(this.pointerIds, getPointerId(pointer)),\r\n                pointerEvent = {},\r\n                i,\r\n                // for tap events\r\n                interval, createNewDoubleTap;\r\n\r\n            // if it's a doubletap then the event properties would have been\r\n            // copied from the tap event and provided as the pointer argument\r\n            if (eventType === 'doubletap') {\r\n                pointerEvent = pointer;\r\n            }\r\n            else {\r\n                pointerExtend(pointerEvent, event);\r\n                if (event !== pointer) {\r\n                    pointerExtend(pointerEvent, pointer);\r\n                }\r\n\r\n                pointerEvent.preventDefault           = preventOriginalDefault;\r\n                pointerEvent.stopPropagation          = InteractEvent.prototype.stopPropagation;\r\n                pointerEvent.stopImmediatePropagation = InteractEvent.prototype.stopImmediatePropagation;\r\n                pointerEvent.interaction              = this;\r\n\r\n                pointerEvent.timeStamp       = new Date().getTime();\r\n                pointerEvent.originalEvent   = event;\r\n                pointerEvent.originalPointer = pointer;\r\n                pointerEvent.type            = eventType;\r\n                pointerEvent.pointerId       = getPointerId(pointer);\r\n                pointerEvent.pointerType     = this.mouse? 'mouse' : !supportsPointerEvent? 'touch'\r\n                                                    : isString(pointer.pointerType)\r\n                                                        ? pointer.pointerType\r\n                                                        : [,,'touch', 'pen', 'mouse'][pointer.pointerType];\r\n            }\r\n\r\n            if (eventType === 'tap') {\r\n                pointerEvent.dt = pointerEvent.timeStamp - this.downTimes[pointerIndex];\r\n\r\n                interval = pointerEvent.timeStamp - this.tapTime;\r\n                createNewDoubleTap = !!(this.prevTap && this.prevTap.type !== 'doubletap'\r\n                       && this.prevTap.target === pointerEvent.target\r\n                       && interval < 500);\r\n\r\n                pointerEvent.double = createNewDoubleTap;\r\n\r\n                this.tapTime = pointerEvent.timeStamp;\r\n            }\r\n\r\n            for (i = 0; i < targets.length; i++) {\r\n                pointerEvent.currentTarget = elements[i];\r\n                pointerEvent.interactable = targets[i];\r\n                targets[i].fire(pointerEvent);\r\n\r\n                if (pointerEvent.immediatePropagationStopped\r\n                    ||(pointerEvent.propagationStopped && elements[i + 1] !== pointerEvent.currentTarget)) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (createNewDoubleTap) {\r\n                var doubleTap = {};\r\n\r\n                extend(doubleTap, pointerEvent);\r\n\r\n                doubleTap.dt   = interval;\r\n                doubleTap.type = 'doubletap';\r\n\r\n                this.collectEventTargets(doubleTap, event, eventTarget, 'doubletap');\r\n\r\n                this.prevTap = doubleTap;\r\n            }\r\n            else if (eventType === 'tap') {\r\n                this.prevTap = pointerEvent;\r\n            }\r\n        },\r\n\r\n        validateSelector: function (pointer, event, matches, matchElements) {\r\n            for (var i = 0, len = matches.length; i < len; i++) {\r\n                var match = matches[i],\r\n                    matchElement = matchElements[i],\r\n                    action = validateAction(match.getAction(pointer, event, this, matchElement), match);\r\n\r\n                if (action && withinInteractionLimit(match, matchElement, action)) {\r\n                    this.target = match;\r\n                    this.element = matchElement;\r\n\r\n                    return action;\r\n                }\r\n            }\r\n        },\r\n\r\n        setSnapping: function (pageCoords, status) {\r\n            var snap = this.target.options[this.prepared.name].snap,\r\n                targets = [],\r\n                target,\r\n                page,\r\n                i;\r\n\r\n            status = status || this.snapStatus;\r\n\r\n            if (status.useStatusXY) {\r\n                page = { x: status.x, y: status.y };\r\n            }\r\n            else {\r\n                var origin = getOriginXY(this.target, this.element);\r\n\r\n                page = extend({}, pageCoords);\r\n\r\n                page.x -= origin.x;\r\n                page.y -= origin.y;\r\n            }\r\n\r\n            status.realX = page.x;\r\n            status.realY = page.y;\r\n\r\n            page.x = page.x - this.inertiaStatus.resumeDx;\r\n            page.y = page.y - this.inertiaStatus.resumeDy;\r\n\r\n            var len = snap.targets? snap.targets.length : 0;\r\n\r\n            for (var relIndex = 0; relIndex < this.snapOffsets.length; relIndex++) {\r\n                var relative = {\r\n                    x: page.x - this.snapOffsets[relIndex].x,\r\n                    y: page.y - this.snapOffsets[relIndex].y\r\n                };\r\n\r\n                for (i = 0; i < len; i++) {\r\n                    if (isFunction(snap.targets[i])) {\r\n                        target = snap.targets[i](relative.x, relative.y, this);\r\n                    }\r\n                    else {\r\n                        target = snap.targets[i];\r\n                    }\r\n\r\n                    if (!target) { continue; }\r\n\r\n                    targets.push({\r\n                        x: isNumber(target.x) ? (target.x + this.snapOffsets[relIndex].x) : relative.x,\r\n                        y: isNumber(target.y) ? (target.y + this.snapOffsets[relIndex].y) : relative.y,\r\n\r\n                        range: isNumber(target.range)? target.range: snap.range\r\n                    });\r\n                }\r\n            }\r\n\r\n            var closest = {\r\n                    target: null,\r\n                    inRange: false,\r\n                    distance: 0,\r\n                    range: 0,\r\n                    dx: 0,\r\n                    dy: 0\r\n                };\r\n\r\n            for (i = 0, len = targets.length; i < len; i++) {\r\n                target = targets[i];\r\n\r\n                var range = target.range,\r\n                    dx = target.x - page.x,\r\n                    dy = target.y - page.y,\r\n                    distance = hypot(dx, dy),\r\n                    inRange = distance <= range;\r\n\r\n                // Infinite targets count as being out of range\r\n                // compared to non infinite ones that are in range\r\n                if (range === Infinity && closest.inRange && closest.range !== Infinity) {\r\n                    inRange = false;\r\n                }\r\n\r\n                if (!closest.target || (inRange\r\n                    // is the closest target in range?\r\n                    ? (closest.inRange && range !== Infinity\r\n                        // the pointer is relatively deeper in this target\r\n                        ? distance / range < closest.distance / closest.range\r\n                        // this target has Infinite range and the closest doesn't\r\n                        : (range === Infinity && closest.range !== Infinity)\r\n                            // OR this target is closer that the previous closest\r\n                            || distance < closest.distance)\r\n                    // The other is not in range and the pointer is closer to this target\r\n                    : (!closest.inRange && distance < closest.distance))) {\r\n\r\n                    if (range === Infinity) {\r\n                        inRange = true;\r\n                    }\r\n\r\n                    closest.target = target;\r\n                    closest.distance = distance;\r\n                    closest.range = range;\r\n                    closest.inRange = inRange;\r\n                    closest.dx = dx;\r\n                    closest.dy = dy;\r\n\r\n                    status.range = range;\r\n                }\r\n            }\r\n\r\n            var snapChanged;\r\n\r\n            if (closest.target) {\r\n                snapChanged = (status.snappedX !== closest.target.x || status.snappedY !== closest.target.y);\r\n\r\n                status.snappedX = closest.target.x;\r\n                status.snappedY = closest.target.y;\r\n            }\r\n            else {\r\n                snapChanged = true;\r\n\r\n                status.snappedX = NaN;\r\n                status.snappedY = NaN;\r\n            }\r\n\r\n            status.dx = closest.dx;\r\n            status.dy = closest.dy;\r\n\r\n            status.changed = (snapChanged || (closest.inRange && !status.locked));\r\n            status.locked = closest.inRange;\r\n\r\n            return status;\r\n        },\r\n\r\n        setRestriction: function (pageCoords, status) {\r\n            var target = this.target,\r\n                restrict = target && target.options[this.prepared.name].restrict,\r\n                restriction = restrict && restrict.restriction,\r\n                page;\r\n\r\n            if (!restriction) {\r\n                return status;\r\n            }\r\n\r\n            status = status || this.restrictStatus;\r\n\r\n            page = status.useStatusXY\r\n                    ? page = { x: status.x, y: status.y }\r\n                    : page = extend({}, pageCoords);\r\n\r\n            if (status.snap && status.snap.locked) {\r\n                page.x += status.snap.dx || 0;\r\n                page.y += status.snap.dy || 0;\r\n            }\r\n\r\n            page.x -= this.inertiaStatus.resumeDx;\r\n            page.y -= this.inertiaStatus.resumeDy;\r\n\r\n            status.dx = 0;\r\n            status.dy = 0;\r\n            status.restricted = false;\r\n\r\n            var rect, restrictedX, restrictedY;\r\n\r\n            if (isString(restriction)) {\r\n                if (restriction === 'parent') {\r\n                    restriction = parentElement(this.element);\r\n                }\r\n                else if (restriction === 'self') {\r\n                    restriction = target.getRect(this.element);\r\n                }\r\n                else {\r\n                    restriction = closest(this.element, restriction);\r\n                }\r\n\r\n                if (!restriction) { return status; }\r\n            }\r\n\r\n            if (isFunction(restriction)) {\r\n                restriction = restriction(page.x, page.y, this.element);\r\n            }\r\n\r\n            if (isElement(restriction)) {\r\n                restriction = getElementRect(restriction);\r\n            }\r\n\r\n            rect = restriction;\r\n\r\n            if (!restriction) {\r\n                restrictedX = page.x;\r\n                restrictedY = page.y;\r\n            }\r\n            // object is assumed to have\r\n            // x, y, width, height or\r\n            // left, top, right, bottom\r\n            else if ('x' in restriction && 'y' in restriction) {\r\n                restrictedX = Math.max(Math.min(rect.x + rect.width  - this.restrictOffset.right , page.x), rect.x + this.restrictOffset.left);\r\n                restrictedY = Math.max(Math.min(rect.y + rect.height - this.restrictOffset.bottom, page.y), rect.y + this.restrictOffset.top );\r\n            }\r\n            else {\r\n                restrictedX = Math.max(Math.min(rect.right  - this.restrictOffset.right , page.x), rect.left + this.restrictOffset.left);\r\n                restrictedY = Math.max(Math.min(rect.bottom - this.restrictOffset.bottom, page.y), rect.top  + this.restrictOffset.top );\r\n            }\r\n\r\n            status.dx = restrictedX - page.x;\r\n            status.dy = restrictedY - page.y;\r\n\r\n            status.changed = status.restrictedX !== restrictedX || status.restrictedY !== restrictedY;\r\n            status.restricted = !!(status.dx || status.dy);\r\n\r\n            status.restrictedX = restrictedX;\r\n            status.restrictedY = restrictedY;\r\n\r\n            return status;\r\n        },\r\n\r\n        checkAndPreventDefault: function (event, interactable, element) {\r\n            if (!(interactable = interactable || this.target)) { return; }\r\n\r\n            var options = interactable.options,\r\n                prevent = options.preventDefault;\r\n\r\n            if (prevent === 'auto' && element && !/^(input|select|textarea)$/i.test(event.target.nodeName)) {\r\n                // do not preventDefault on pointerdown if the prepared action is a drag\r\n                // and dragging can only start from a certain direction - this allows\r\n                // a touch to pan the viewport if a drag isn't in the right direction\r\n                if (/down|start/i.test(event.type)\r\n                    && this.prepared.name === 'drag' && options.drag.axis !== 'xy') {\r\n\r\n                    return;\r\n                }\r\n\r\n                // with manualStart, only preventDefault while interacting\r\n                if (options[this.prepared.name] && options[this.prepared.name].manualStart\r\n                    && !this.interacting()) {\r\n                    return;\r\n                }\r\n\r\n                event.preventDefault();\r\n                return;\r\n            }\r\n\r\n            if (prevent === 'always') {\r\n                event.preventDefault();\r\n                return;\r\n            }\r\n        },\r\n\r\n        calcInertia: function (status) {\r\n            var inertiaOptions = this.target.options[this.prepared.name].inertia,\r\n                lambda = inertiaOptions.resistance,\r\n                inertiaDur = -Math.log(inertiaOptions.endSpeed / status.v0) / lambda;\r\n\r\n            status.x0 = this.prevEvent.pageX;\r\n            status.y0 = this.prevEvent.pageY;\r\n            status.t0 = status.startEvent.timeStamp / 1000;\r\n            status.sx = status.sy = 0;\r\n\r\n            status.modifiedXe = status.xe = (status.vx0 - inertiaDur) / lambda;\r\n            status.modifiedYe = status.ye = (status.vy0 - inertiaDur) / lambda;\r\n            status.te = inertiaDur;\r\n\r\n            status.lambda_v0 = lambda / status.v0;\r\n            status.one_ve_v0 = 1 - inertiaOptions.endSpeed / status.v0;\r\n        },\r\n\r\n        autoScrollMove: function (pointer) {\r\n            if (!(this.interacting()\r\n                && checkAutoScroll(this.target, this.prepared.name))) {\r\n                return;\r\n            }\r\n\r\n            if (this.inertiaStatus.active) {\r\n                autoScroll.x = autoScroll.y = 0;\r\n                return;\r\n            }\r\n\r\n            var top,\r\n                right,\r\n                bottom,\r\n                left,\r\n                options = this.target.options[this.prepared.name].autoScroll,\r\n                container = options.container || getWindow(this.element);\r\n\r\n            if (isWindow(container)) {\r\n                left   = pointer.clientX < autoScroll.margin;\r\n                top    = pointer.clientY < autoScroll.margin;\r\n                right  = pointer.clientX > container.innerWidth  - autoScroll.margin;\r\n                bottom = pointer.clientY > container.innerHeight - autoScroll.margin;\r\n            }\r\n            else {\r\n                var rect = getElementClientRect(container);\r\n\r\n                left   = pointer.clientX < rect.left   + autoScroll.margin;\r\n                top    = pointer.clientY < rect.top    + autoScroll.margin;\r\n                right  = pointer.clientX > rect.right  - autoScroll.margin;\r\n                bottom = pointer.clientY > rect.bottom - autoScroll.margin;\r\n            }\r\n\r\n            autoScroll.x = (right ? 1: left? -1: 0);\r\n            autoScroll.y = (bottom? 1:  top? -1: 0);\r\n\r\n            if (!autoScroll.isScrolling) {\r\n                // set the autoScroll properties to those of the target\r\n                autoScroll.margin = options.margin;\r\n                autoScroll.speed  = options.speed;\r\n\r\n                autoScroll.start(this);\r\n            }\r\n        },\r\n\r\n        _updateEventTargets: function (target, currentTarget) {\r\n            this._eventTarget    = target;\r\n            this._curEventTarget = currentTarget;\r\n        }\r\n\r\n    };\r\n\r\n    function getInteractionFromPointer (pointer, eventType, eventTarget) {\r\n        var i = 0, len = interactions.length,\r\n            mouseEvent = (/mouse/i.test(pointer.pointerType || eventType)\r\n                          // MSPointerEvent.MSPOINTER_TYPE_MOUSE\r\n                          || pointer.pointerType === 4),\r\n            interaction;\r\n\r\n        var id = getPointerId(pointer);\r\n\r\n        // try to resume inertia with a new pointer\r\n        if (/down|start/i.test(eventType)) {\r\n            for (i = 0; i < len; i++) {\r\n                interaction = interactions[i];\r\n\r\n                var element = eventTarget;\r\n\r\n                if (interaction.inertiaStatus.active && interaction.target.options[interaction.prepared.name].inertia.allowResume\r\n                    && (interaction.mouse === mouseEvent)) {\r\n                    while (element) {\r\n                        // if the element is the interaction element\r\n                        if (element === interaction.element) {\r\n                            return interaction;\r\n                        }\r\n                        element = parentElement(element);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // if it's a mouse interaction\r\n        if (mouseEvent || !(supportsTouch || supportsPointerEvent)) {\r\n\r\n            // find a mouse interaction that's not in inertia phase\r\n            for (i = 0; i < len; i++) {\r\n                if (interactions[i].mouse && !interactions[i].inertiaStatus.active) {\r\n                    return interactions[i];\r\n                }\r\n            }\r\n\r\n            // find any interaction specifically for mouse.\r\n            // if the eventType is a mousedown, and inertia is active\r\n            // ignore the interaction\r\n            for (i = 0; i < len; i++) {\r\n                if (interactions[i].mouse && !(/down/.test(eventType) && interactions[i].inertiaStatus.active)) {\r\n                    return interaction;\r\n                }\r\n            }\r\n\r\n            // create a new interaction for mouse\r\n            interaction = new Interaction();\r\n            interaction.mouse = true;\r\n\r\n            return interaction;\r\n        }\r\n\r\n        // get interaction that has this pointer\r\n        for (i = 0; i < len; i++) {\r\n            if (contains(interactions[i].pointerIds, id)) {\r\n                return interactions[i];\r\n            }\r\n        }\r\n\r\n        // at this stage, a pointerUp should not return an interaction\r\n        if (/up|end|out/i.test(eventType)) {\r\n            return null;\r\n        }\r\n\r\n        // get first idle interaction\r\n        for (i = 0; i < len; i++) {\r\n            interaction = interactions[i];\r\n\r\n            if ((!interaction.prepared.name || (interaction.target.options.gesture.enabled))\r\n                && !interaction.interacting()\r\n                && !(!mouseEvent && interaction.mouse)) {\r\n\r\n                return interaction;\r\n            }\r\n        }\r\n\r\n        return new Interaction();\r\n    }\r\n\r\n    function doOnInteractions (method) {\r\n        return (function (event) {\r\n            var interaction,\r\n                eventTarget = getActualElement(event.path\r\n                                               ? event.path[0]\r\n                                               : event.target),\r\n                curEventTarget = getActualElement(event.currentTarget),\r\n                i;\r\n\r\n            if (supportsTouch && /touch/.test(event.type)) {\r\n                prevTouchTime = new Date().getTime();\r\n\r\n                for (i = 0; i < event.changedTouches.length; i++) {\r\n                    var pointer = event.changedTouches[i];\r\n\r\n                    interaction = getInteractionFromPointer(pointer, event.type, eventTarget);\r\n\r\n                    if (!interaction) { continue; }\r\n\r\n                    interaction._updateEventTargets(eventTarget, curEventTarget);\r\n\r\n                    interaction[method](pointer, event, eventTarget, curEventTarget);\r\n                }\r\n            }\r\n            else {\r\n                if (!supportsPointerEvent && /mouse/.test(event.type)) {\r\n                    // ignore mouse events while touch interactions are active\r\n                    for (i = 0; i < interactions.length; i++) {\r\n                        if (!interactions[i].mouse && interactions[i].pointerIsDown) {\r\n                            return;\r\n                        }\r\n                    }\r\n\r\n                    // try to ignore mouse events that are simulated by the browser\r\n                    // after a touch event\r\n                    if (new Date().getTime() - prevTouchTime < 500) {\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                interaction = getInteractionFromPointer(event, event.type, eventTarget);\r\n\r\n                if (!interaction) { return; }\r\n\r\n                interaction._updateEventTargets(eventTarget, curEventTarget);\r\n\r\n                interaction[method](event, event, eventTarget, curEventTarget);\r\n            }\r\n        });\r\n    }\r\n\r\n    function InteractEvent (interaction, event, action, phase, element, related) {\r\n        var client,\r\n            page,\r\n            target      = interaction.target,\r\n            snapStatus  = interaction.snapStatus,\r\n            restrictStatus  = interaction.restrictStatus,\r\n            pointers    = interaction.pointers,\r\n            deltaSource = (target && target.options || defaultOptions).deltaSource,\r\n            sourceX     = deltaSource + 'X',\r\n            sourceY     = deltaSource + 'Y',\r\n            options     = target? target.options: defaultOptions,\r\n            origin      = getOriginXY(target, element),\r\n            starting    = phase === 'start',\r\n            ending      = phase === 'end',\r\n            coords      = starting? interaction.startCoords : interaction.curCoords;\r\n\r\n        element = element || interaction.element;\r\n\r\n        page   = extend({}, coords.page);\r\n        client = extend({}, coords.client);\r\n\r\n        page.x -= origin.x;\r\n        page.y -= origin.y;\r\n\r\n        client.x -= origin.x;\r\n        client.y -= origin.y;\r\n\r\n        var relativePoints = options[action].snap && options[action].snap.relativePoints ;\r\n\r\n        if (checkSnap(target, action) && !(starting && relativePoints && relativePoints.length)) {\r\n            this.snap = {\r\n                range  : snapStatus.range,\r\n                locked : snapStatus.locked,\r\n                x      : snapStatus.snappedX,\r\n                y      : snapStatus.snappedY,\r\n                realX  : snapStatus.realX,\r\n                realY  : snapStatus.realY,\r\n                dx     : snapStatus.dx,\r\n                dy     : snapStatus.dy\r\n            };\r\n\r\n            if (snapStatus.locked) {\r\n                page.x += snapStatus.dx;\r\n                page.y += snapStatus.dy;\r\n                client.x += snapStatus.dx;\r\n                client.y += snapStatus.dy;\r\n            }\r\n        }\r\n\r\n        if (checkRestrict(target, action) && !(starting && options[action].restrict.elementRect) && restrictStatus.restricted) {\r\n            page.x += restrictStatus.dx;\r\n            page.y += restrictStatus.dy;\r\n            client.x += restrictStatus.dx;\r\n            client.y += restrictStatus.dy;\r\n\r\n            this.restrict = {\r\n                dx: restrictStatus.dx,\r\n                dy: restrictStatus.dy\r\n            };\r\n        }\r\n\r\n        this.pageX     = page.x;\r\n        this.pageY     = page.y;\r\n        this.clientX   = client.x;\r\n        this.clientY   = client.y;\r\n\r\n        this.x0        = interaction.startCoords.page.x - origin.x;\r\n        this.y0        = interaction.startCoords.page.y - origin.y;\r\n        this.clientX0  = interaction.startCoords.client.x - origin.x;\r\n        this.clientY0  = interaction.startCoords.client.y - origin.y;\r\n        this.ctrlKey   = event.ctrlKey;\r\n        this.altKey    = event.altKey;\r\n        this.shiftKey  = event.shiftKey;\r\n        this.metaKey   = event.metaKey;\r\n        this.button    = event.button;\r\n        this.buttons   = event.buttons;\r\n        this.target    = element;\r\n        this.t0        = interaction.downTimes[0];\r\n        this.type      = action + (phase || '');\r\n\r\n        this.interaction = interaction;\r\n        this.interactable = target;\r\n\r\n        var inertiaStatus = interaction.inertiaStatus;\r\n\r\n        if (inertiaStatus.active) {\r\n            this.detail = 'inertia';\r\n        }\r\n\r\n        if (related) {\r\n            this.relatedTarget = related;\r\n        }\r\n\r\n        // end event dx, dy is difference between start and end points\r\n        if (ending) {\r\n            if (deltaSource === 'client') {\r\n                this.dx = client.x - interaction.startCoords.client.x;\r\n                this.dy = client.y - interaction.startCoords.client.y;\r\n            }\r\n            else {\r\n                this.dx = page.x - interaction.startCoords.page.x;\r\n                this.dy = page.y - interaction.startCoords.page.y;\r\n            }\r\n        }\r\n        else if (starting) {\r\n            this.dx = 0;\r\n            this.dy = 0;\r\n        }\r\n        // copy properties from previousmove if starting inertia\r\n        else if (phase === 'inertiastart') {\r\n            this.dx = interaction.prevEvent.dx;\r\n            this.dy = interaction.prevEvent.dy;\r\n        }\r\n        else {\r\n            if (deltaSource === 'client') {\r\n                this.dx = client.x - interaction.prevEvent.clientX;\r\n                this.dy = client.y - interaction.prevEvent.clientY;\r\n            }\r\n            else {\r\n                this.dx = page.x - interaction.prevEvent.pageX;\r\n                this.dy = page.y - interaction.prevEvent.pageY;\r\n            }\r\n        }\r\n        if (interaction.prevEvent && interaction.prevEvent.detail === 'inertia'\r\n            && !inertiaStatus.active\r\n            && options[action].inertia && options[action].inertia.zeroResumeDelta) {\r\n\r\n            inertiaStatus.resumeDx += this.dx;\r\n            inertiaStatus.resumeDy += this.dy;\r\n\r\n            this.dx = this.dy = 0;\r\n        }\r\n\r\n        if (action === 'resize' && interaction.resizeAxes) {\r\n            if (options.resize.square) {\r\n                if (interaction.resizeAxes === 'y') {\r\n                    this.dx = this.dy;\r\n                }\r\n                else {\r\n                    this.dy = this.dx;\r\n                }\r\n                this.axes = 'xy';\r\n            }\r\n            else {\r\n                this.axes = interaction.resizeAxes;\r\n\r\n                if (interaction.resizeAxes === 'x') {\r\n                    this.dy = 0;\r\n                }\r\n                else if (interaction.resizeAxes === 'y') {\r\n                    this.dx = 0;\r\n                }\r\n            }\r\n        }\r\n        else if (action === 'gesture') {\r\n            this.touches = [pointers[0], pointers[1]];\r\n\r\n            if (starting) {\r\n                this.distance = touchDistance(pointers, deltaSource);\r\n                this.box      = touchBBox(pointers);\r\n                this.scale    = 1;\r\n                this.ds       = 0;\r\n                this.angle    = touchAngle(pointers, undefined, deltaSource);\r\n                this.da       = 0;\r\n            }\r\n            else if (ending || event instanceof InteractEvent) {\r\n                this.distance = interaction.prevEvent.distance;\r\n                this.box      = interaction.prevEvent.box;\r\n                this.scale    = interaction.prevEvent.scale;\r\n                this.ds       = this.scale - 1;\r\n                this.angle    = interaction.prevEvent.angle;\r\n                this.da       = this.angle - interaction.gesture.startAngle;\r\n            }\r\n            else {\r\n                this.distance = touchDistance(pointers, deltaSource);\r\n                this.box      = touchBBox(pointers);\r\n                this.scale    = this.distance / interaction.gesture.startDistance;\r\n                this.angle    = touchAngle(pointers, interaction.gesture.prevAngle, deltaSource);\r\n\r\n                this.ds = this.scale - interaction.gesture.prevScale;\r\n                this.da = this.angle - interaction.gesture.prevAngle;\r\n            }\r\n        }\r\n\r\n        if (starting) {\r\n            this.timeStamp = interaction.downTimes[0];\r\n            this.dt        = 0;\r\n            this.duration  = 0;\r\n            this.speed     = 0;\r\n            this.velocityX = 0;\r\n            this.velocityY = 0;\r\n        }\r\n        else if (phase === 'inertiastart') {\r\n            this.timeStamp = interaction.prevEvent.timeStamp;\r\n            this.dt        = interaction.prevEvent.dt;\r\n            this.duration  = interaction.prevEvent.duration;\r\n            this.speed     = interaction.prevEvent.speed;\r\n            this.velocityX = interaction.prevEvent.velocityX;\r\n            this.velocityY = interaction.prevEvent.velocityY;\r\n        }\r\n        else {\r\n            this.timeStamp = new Date().getTime();\r\n            this.dt        = this.timeStamp - interaction.prevEvent.timeStamp;\r\n            this.duration  = this.timeStamp - interaction.downTimes[0];\r\n\r\n            if (event instanceof InteractEvent) {\r\n                var dx = this[sourceX] - interaction.prevEvent[sourceX],\r\n                    dy = this[sourceY] - interaction.prevEvent[sourceY],\r\n                    dt = this.dt / 1000;\r\n\r\n                this.speed = hypot(dx, dy) / dt;\r\n                this.velocityX = dx / dt;\r\n                this.velocityY = dy / dt;\r\n            }\r\n            // if normal move or end event, use previous user event coords\r\n            else {\r\n                // speed and velocity in pixels per second\r\n                this.speed = interaction.pointerDelta[deltaSource].speed;\r\n                this.velocityX = interaction.pointerDelta[deltaSource].vx;\r\n                this.velocityY = interaction.pointerDelta[deltaSource].vy;\r\n            }\r\n        }\r\n\r\n        if ((ending || phase === 'inertiastart')\r\n            && interaction.prevEvent.speed > 600 && this.timeStamp - interaction.prevEvent.timeStamp < 150) {\r\n\r\n            var angle = 180 * Math.atan2(interaction.prevEvent.velocityY, interaction.prevEvent.velocityX) / Math.PI,\r\n                overlap = 22.5;\r\n\r\n            if (angle < 0) {\r\n                angle += 360;\r\n            }\r\n\r\n            var left = 135 - overlap <= angle && angle < 225 + overlap,\r\n                up   = 225 - overlap <= angle && angle < 315 + overlap,\r\n\r\n                right = !left && (315 - overlap <= angle || angle <  45 + overlap),\r\n                down  = !up   &&   45 - overlap <= angle && angle < 135 + overlap;\r\n\r\n            this.swipe = {\r\n                up   : up,\r\n                down : down,\r\n                left : left,\r\n                right: right,\r\n                angle: angle,\r\n                speed: interaction.prevEvent.speed,\r\n                velocity: {\r\n                    x: interaction.prevEvent.velocityX,\r\n                    y: interaction.prevEvent.velocityY\r\n                }\r\n            };\r\n        }\r\n    }\r\n\r\n    InteractEvent.prototype = {\r\n        preventDefault: blank,\r\n        stopImmediatePropagation: function () {\r\n            this.immediatePropagationStopped = this.propagationStopped = true;\r\n        },\r\n        stopPropagation: function () {\r\n            this.propagationStopped = true;\r\n        }\r\n    };\r\n\r\n    function preventOriginalDefault () {\r\n        this.originalEvent.preventDefault();\r\n    }\r\n\r\n    function getActionCursor (action) {\r\n        var cursor = '';\r\n\r\n        if (action.name === 'drag') {\r\n            cursor =  actionCursors.drag;\r\n        }\r\n        if (action.name === 'resize') {\r\n            if (action.axis) {\r\n                cursor =  actionCursors[action.name + action.axis];\r\n            }\r\n            else if (action.edges) {\r\n                var cursorKey = 'resize',\r\n                    edgeNames = ['top', 'bottom', 'left', 'right'];\r\n\r\n                for (var i = 0; i < 4; i++) {\r\n                    if (action.edges[edgeNames[i]]) {\r\n                        cursorKey += edgeNames[i];\r\n                    }\r\n                }\r\n\r\n                cursor = actionCursors[cursorKey];\r\n            }\r\n        }\r\n\r\n        return cursor;\r\n    }\r\n\r\n    function checkResizeEdge (name, value, page, element, interactableElement, rect, margin) {\r\n        // false, '', undefined, null\r\n        if (!value) { return false; }\r\n\r\n        // true value, use pointer coords and element rect\r\n        if (value === true) {\r\n            // if dimensions are negative, \"switch\" edges\r\n            var width = isNumber(rect.width)? rect.width : rect.right - rect.left,\r\n                height = isNumber(rect.height)? rect.height : rect.bottom - rect.top;\r\n\r\n            if (width < 0) {\r\n                if      (name === 'left' ) { name = 'right'; }\r\n                else if (name === 'right') { name = 'left' ; }\r\n            }\r\n            if (height < 0) {\r\n                if      (name === 'top'   ) { name = 'bottom'; }\r\n                else if (name === 'bottom') { name = 'top'   ; }\r\n            }\r\n\r\n            if (name === 'left'  ) { return page.x < ((width  >= 0? rect.left: rect.right ) + margin); }\r\n            if (name === 'top'   ) { return page.y < ((height >= 0? rect.top : rect.bottom) + margin); }\r\n\r\n            if (name === 'right' ) { return page.x > ((width  >= 0? rect.right : rect.left) - margin); }\r\n            if (name === 'bottom') { return page.y > ((height >= 0? rect.bottom: rect.top ) - margin); }\r\n        }\r\n\r\n        // the remaining checks require an element\r\n        if (!isElement(element)) { return false; }\r\n\r\n        return isElement(value)\r\n                    // the value is an element to use as a resize handle\r\n                    ? value === element\r\n                    // otherwise check if element matches value as selector\r\n                    : matchesUpTo(element, value, interactableElement);\r\n    }\r\n\r\n    function defaultActionChecker (pointer, interaction, element) {\r\n        var rect = this.getRect(element),\r\n            shouldResize = false,\r\n            action = null,\r\n            resizeAxes = null,\r\n            resizeEdges,\r\n            page = extend({}, interaction.curCoords.page),\r\n            options = this.options;\r\n\r\n        if (!rect) { return null; }\r\n\r\n        if (actionIsEnabled.resize && options.resize.enabled) {\r\n            var resizeOptions = options.resize;\r\n\r\n            resizeEdges = {\r\n                left: false, right: false, top: false, bottom: false\r\n            };\r\n\r\n            // if using resize.edges\r\n            if (isObject(resizeOptions.edges)) {\r\n                for (var edge in resizeEdges) {\r\n                    resizeEdges[edge] = checkResizeEdge(edge,\r\n                                                        resizeOptions.edges[edge],\r\n                                                        page,\r\n                                                        interaction._eventTarget,\r\n                                                        element,\r\n                                                        rect,\r\n                                                        resizeOptions.margin || margin);\r\n                }\r\n\r\n                resizeEdges.left = resizeEdges.left && !resizeEdges.right;\r\n                resizeEdges.top  = resizeEdges.top  && !resizeEdges.bottom;\r\n\r\n                shouldResize = resizeEdges.left || resizeEdges.right || resizeEdges.top || resizeEdges.bottom;\r\n            }\r\n            else {\r\n                var right  = options.resize.axis !== 'y' && page.x > (rect.right  - margin),\r\n                    bottom = options.resize.axis !== 'x' && page.y > (rect.bottom - margin);\r\n\r\n                shouldResize = right || bottom;\r\n                resizeAxes = (right? 'x' : '') + (bottom? 'y' : '');\r\n            }\r\n        }\r\n\r\n        action = shouldResize\r\n            ? 'resize'\r\n            : actionIsEnabled.drag && options.drag.enabled\r\n                ? 'drag'\r\n                : null;\r\n\r\n        if (actionIsEnabled.gesture\r\n            && interaction.pointerIds.length >=2\r\n            && !(interaction.dragging || interaction.resizing)) {\r\n            action = 'gesture';\r\n        }\r\n\r\n        if (action) {\r\n            return {\r\n                name: action,\r\n                axis: resizeAxes,\r\n                edges: resizeEdges\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    // Check if action is enabled globally and the current target supports it\r\n    // If so, return the validated action. Otherwise, return null\r\n    function validateAction (action, interactable) {\r\n        if (!isObject(action)) { return null; }\r\n\r\n        var actionName = action.name,\r\n            options = interactable.options;\r\n\r\n        if ((  (actionName  === 'resize'   && options.resize.enabled )\r\n            || (actionName      === 'drag'     && options.drag.enabled  )\r\n            || (actionName      === 'gesture'  && options.gesture.enabled))\r\n            && actionIsEnabled[actionName]) {\r\n\r\n            if (actionName === 'resize' || actionName === 'resizeyx') {\r\n                actionName = 'resizexy';\r\n            }\r\n\r\n            return action;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    var listeners = {},\r\n        interactionListeners = [\r\n            'dragStart', 'dragMove', 'resizeStart', 'resizeMove', 'gestureStart', 'gestureMove',\r\n            'pointerOver', 'pointerOut', 'pointerHover', 'selectorDown',\r\n            'pointerDown', 'pointerMove', 'pointerUp', 'pointerCancel', 'pointerEnd',\r\n            'addPointer', 'removePointer', 'recordPointer', 'autoScrollMove'\r\n        ];\r\n\r\n    for (var i = 0, len = interactionListeners.length; i < len; i++) {\r\n        var name = interactionListeners[i];\r\n\r\n        listeners[name] = doOnInteractions(name);\r\n    }\r\n\r\n    // bound to the interactable context when a DOM event\r\n    // listener is added to a selector interactable\r\n    function delegateListener (event, useCapture) {\r\n        var fakeEvent = {},\r\n            delegated = delegatedEvents[event.type],\r\n            eventTarget = getActualElement(event.path\r\n                                           ? event.path[0]\r\n                                           : event.target),\r\n            element = eventTarget;\r\n\r\n        useCapture = useCapture? true: false;\r\n\r\n        // duplicate the event so that currentTarget can be changed\r\n        for (var prop in event) {\r\n            fakeEvent[prop] = event[prop];\r\n        }\r\n\r\n        fakeEvent.originalEvent = event;\r\n        fakeEvent.preventDefault = preventOriginalDefault;\r\n\r\n        // climb up document tree looking for selector matches\r\n        while (isElement(element)) {\r\n            for (var i = 0; i < delegated.selectors.length; i++) {\r\n                var selector = delegated.selectors[i],\r\n                    context = delegated.contexts[i];\r\n\r\n                if (matchesSelector(element, selector)\r\n                    && nodeContains(context, eventTarget)\r\n                    && nodeContains(context, element)) {\r\n\r\n                    var listeners = delegated.listeners[i];\r\n\r\n                    fakeEvent.currentTarget = element;\r\n\r\n                    for (var j = 0; j < listeners.length; j++) {\r\n                        if (listeners[j][1] === useCapture) {\r\n                            listeners[j][0](fakeEvent);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            element = parentElement(element);\r\n        }\r\n    }\r\n\r\n    function delegateUseCapture (event) {\r\n        return delegateListener.call(this, event, true);\r\n    }\r\n\r\n    interactables.indexOfElement = function indexOfElement (element, context) {\r\n        context = context || document;\r\n\r\n        for (var i = 0; i < this.length; i++) {\r\n            var interactable = this[i];\r\n\r\n            if ((interactable.selector === element\r\n                && (interactable._context === context))\r\n                || (!interactable.selector && interactable._element === element)) {\r\n\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    };\r\n\r\n    interactables.get = function interactableGet (element, options) {\r\n        return this[this.indexOfElement(element, options && options.context)];\r\n    };\r\n\r\n    interactables.forEachSelector = function (callback) {\r\n        for (var i = 0; i < this.length; i++) {\r\n            var interactable = this[i];\r\n\r\n            if (!interactable.selector) {\r\n                continue;\r\n            }\r\n\r\n            var ret = callback(interactable, interactable.selector, interactable._context, i, this);\r\n\r\n            if (ret !== undefined) {\r\n                return ret;\r\n            }\r\n        }\r\n    };\r\n\r\n    /*\\\r\n     * interact\r\n     [ method ]\r\n     *\r\n     * The methods of this variable can be used to set elements as\r\n     * interactables and also to change various default settings.\r\n     *\r\n     * Calling it as a function and passing an element or a valid CSS selector\r\n     * string returns an Interactable object which has various methods to\r\n     * configure it.\r\n     *\r\n     - element (Element | string) The HTML or SVG Element to interact with or CSS selector\r\n     = (object) An @Interactable\r\n     *\r\n     > Usage\r\n     | interact(document.getElementById('draggable')).draggable(true);\r\n     |\r\n     | var rectables = interact('rect');\r\n     | rectables\r\n     |     .gesturable(true)\r\n     |     .on('gesturemove', function (event) {\r\n     |         // something cool...\r\n     |     })\r\n     |     .autoScroll(true);\r\n    \\*/\r\n    function interact (element, options) {\r\n        return interactables.get(element, options) || new Interactable(element, options);\r\n    }\r\n\r\n    /*\\\r\n     * Interactable\r\n     [ property ]\r\n     **\r\n     * Object type returned by @interact\r\n    \\*/\r\n    function Interactable (element, options) {\r\n        this._element = element;\r\n        this._iEvents = this._iEvents || {};\r\n\r\n        var _window;\r\n\r\n        if (trySelector(element)) {\r\n            this.selector = element;\r\n\r\n            var context = options && options.context;\r\n\r\n            _window = context? getWindow(context) : window;\r\n\r\n            if (context && (_window.Node\r\n                    ? context instanceof _window.Node\r\n                    : (isElement(context) || context === _window.document))) {\r\n\r\n                this._context = context;\r\n            }\r\n        }\r\n        else {\r\n            _window = getWindow(element);\r\n\r\n            if (isElement(element, _window)) {\r\n\r\n                if (PointerEvent) {\r\n                    events.add(this._element, pEventTypes.down, listeners.pointerDown );\r\n                    events.add(this._element, pEventTypes.move, listeners.pointerHover);\r\n                }\r\n                else {\r\n                    events.add(this._element, 'mousedown' , listeners.pointerDown );\r\n                    events.add(this._element, 'mousemove' , listeners.pointerHover);\r\n                    events.add(this._element, 'touchstart', listeners.pointerDown );\r\n                    events.add(this._element, 'touchmove' , listeners.pointerHover);\r\n                }\r\n            }\r\n        }\r\n\r\n        this._doc = _window.document;\r\n\r\n        if (!contains(documents, this._doc)) {\r\n            listenToDocument(this._doc);\r\n        }\r\n\r\n        interactables.push(this);\r\n\r\n        this.set(options);\r\n    }\r\n\r\n    Interactable.prototype = {\r\n        setOnEvents: function (action, phases) {\r\n            if (action === 'drop') {\r\n                if (isFunction(phases.ondrop)          ) { this.ondrop           = phases.ondrop          ; }\r\n                if (isFunction(phases.ondropactivate)  ) { this.ondropactivate   = phases.ondropactivate  ; }\r\n                if (isFunction(phases.ondropdeactivate)) { this.ondropdeactivate = phases.ondropdeactivate; }\r\n                if (isFunction(phases.ondragenter)     ) { this.ondragenter      = phases.ondragenter     ; }\r\n                if (isFunction(phases.ondragleave)     ) { this.ondragleave      = phases.ondragleave     ; }\r\n                if (isFunction(phases.ondropmove)      ) { this.ondropmove       = phases.ondropmove      ; }\r\n            }\r\n            else {\r\n                action = 'on' + action;\r\n\r\n                if (isFunction(phases.onstart)       ) { this[action + 'start'         ] = phases.onstart         ; }\r\n                if (isFunction(phases.onmove)        ) { this[action + 'move'          ] = phases.onmove          ; }\r\n                if (isFunction(phases.onend)         ) { this[action + 'end'           ] = phases.onend           ; }\r\n                if (isFunction(phases.oninertiastart)) { this[action + 'inertiastart'  ] = phases.oninertiastart  ; }\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.draggable\r\n         [ method ]\r\n         *\r\n         * Gets or sets whether drag actions can be performed on the\r\n         * Interactable\r\n         *\r\n         = (boolean) Indicates if this can be the target of drag events\r\n         | var isDraggable = interact('ul li').draggable();\r\n         * or\r\n         - options (boolean | object) #optional true/false or An object with event listeners to be fired on drag events (object makes the Interactable draggable)\r\n         = (object) This Interactable\r\n         | interact(element).draggable({\r\n         |     onstart: function (event) {},\r\n         |     onmove : function (event) {},\r\n         |     onend  : function (event) {},\r\n         |\r\n         |     // the axis in which the first movement must be\r\n         |     // for the drag sequence to start\r\n         |     // 'xy' by default - any direction\r\n         |     axis: 'x' || 'y' || 'xy',\r\n         |\r\n         |     // max number of drags that can happen concurrently\r\n         |     // with elements of this Interactable. Infinity by default\r\n         |     max: Infinity,\r\n         |\r\n         |     // max number of drags that can target the same element+Interactable\r\n         |     // 1 by default\r\n         |     maxPerElement: 2\r\n         | });\r\n        \\*/\r\n        draggable: function (options) {\r\n            if (isObject(options)) {\r\n                this.options.drag.enabled = options.enabled === false? false: true;\r\n                this.setPerAction('drag', options);\r\n                this.setOnEvents('drag', options);\r\n\r\n                if (/^x$|^y$|^xy$/.test(options.axis)) {\r\n                    this.options.drag.axis = options.axis;\r\n                }\r\n                else if (options.axis === null) {\r\n                    delete this.options.drag.axis;\r\n                }\r\n\r\n                return this;\r\n            }\r\n\r\n            if (isBool(options)) {\r\n                this.options.drag.enabled = options;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.drag;\r\n        },\r\n\r\n        setPerAction: function (action, options) {\r\n            // for all the default per-action options\r\n            for (var option in options) {\r\n                // if this option exists for this action\r\n                if (option in defaultOptions[action]) {\r\n                    // if the option in the options arg is an object value\r\n                    if (isObject(options[option])) {\r\n                        // duplicate the object\r\n                        this.options[action][option] = extend(this.options[action][option] || {}, options[option]);\r\n\r\n                        if (isObject(defaultOptions.perAction[option]) && 'enabled' in defaultOptions.perAction[option]) {\r\n                            this.options[action][option].enabled = options[option].enabled === false? false : true;\r\n                        }\r\n                    }\r\n                    else if (isBool(options[option]) && isObject(defaultOptions.perAction[option])) {\r\n                        this.options[action][option].enabled = options[option];\r\n                    }\r\n                    else if (options[option] !== undefined) {\r\n                        // or if it's not undefined, do a plain assignment\r\n                        this.options[action][option] = options[option];\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.dropzone\r\n         [ method ]\r\n         *\r\n         * Returns or sets whether elements can be dropped onto this\r\n         * Interactable to trigger drop events\r\n         *\r\n         * Dropzones can receive the following events:\r\n         *  - `dropactivate` and `dropdeactivate` when an acceptable drag starts and ends\r\n         *  - `dragenter` and `dragleave` when a draggable enters and leaves the dropzone\r\n         *  - `dragmove` when a draggable that has entered the dropzone is moved\r\n         *  - `drop` when a draggable is dropped into this dropzone\r\n         *\r\n         *  Use the `accept` option to allow only elements that match the given CSS selector or element.\r\n         *\r\n         *  Use the `overlap` option to set how drops are checked for. The allowed values are:\r\n         *   - `'pointer'`, the pointer must be over the dropzone (default)\r\n         *   - `'center'`, the draggable element's center must be over the dropzone\r\n         *   - a number from 0-1 which is the `(intersection area) / (draggable area)`.\r\n         *       e.g. `0.5` for drop to happen when half of the area of the\r\n         *       draggable is over the dropzone\r\n         *\r\n         - options (boolean | object | null) #optional The new value to be set.\r\n         | interact('.drop').dropzone({\r\n         |   accept: '.can-drop' || document.getElementById('single-drop'),\r\n         |   overlap: 'pointer' || 'center' || zeroToOne\r\n         | }\r\n         = (boolean | object) The current setting or this Interactable\r\n        \\*/\r\n        dropzone: function (options) {\r\n            if (isObject(options)) {\r\n                this.options.drop.enabled = options.enabled === false? false: true;\r\n                this.setOnEvents('drop', options);\r\n\r\n                if (/^(pointer|center)$/.test(options.overlap)) {\r\n                    this.options.drop.overlap = options.overlap;\r\n                }\r\n                else if (isNumber(options.overlap)) {\r\n                    this.options.drop.overlap = Math.max(Math.min(1, options.overlap), 0);\r\n                }\r\n                if ('accept' in options) {\r\n                  this.options.drop.accept = options.accept;\r\n                }\r\n                if ('checker' in options) {\r\n                  this.options.drop.checker = options.checker;\r\n                }\r\n\r\n                return this;\r\n            }\r\n\r\n            if (isBool(options)) {\r\n                this.options.drop.enabled = options;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.drop;\r\n        },\r\n\r\n        dropCheck: function (dragEvent, event, draggable, draggableElement, dropElement, rect) {\r\n            var dropped = false;\r\n\r\n            // if the dropzone has no rect (eg. display: none)\r\n            // call the custom dropChecker or just return false\r\n            if (!(rect = rect || this.getRect(dropElement))) {\r\n                return (this.options.drop.checker\r\n                    ? this.options.drop.checker(dragEvent, event, dropped, this, dropElement, draggable, draggableElement)\r\n                    : false);\r\n            }\r\n\r\n            var dropOverlap = this.options.drop.overlap;\r\n\r\n            if (dropOverlap === 'pointer') {\r\n                var page = getPageXY(dragEvent),\r\n                    origin = getOriginXY(draggable, draggableElement),\r\n                    horizontal,\r\n                    vertical;\r\n\r\n                page.x += origin.x;\r\n                page.y += origin.y;\r\n\r\n                horizontal = (page.x > rect.left) && (page.x < rect.right);\r\n                vertical   = (page.y > rect.top ) && (page.y < rect.bottom);\r\n\r\n                dropped = horizontal && vertical;\r\n            }\r\n\r\n            var dragRect = draggable.getRect(draggableElement);\r\n\r\n            if (dropOverlap === 'center') {\r\n                var cx = dragRect.left + dragRect.width  / 2,\r\n                    cy = dragRect.top  + dragRect.height / 2;\r\n\r\n                dropped = cx >= rect.left && cx <= rect.right && cy >= rect.top && cy <= rect.bottom;\r\n            }\r\n\r\n            if (isNumber(dropOverlap)) {\r\n                var overlapArea  = (Math.max(0, Math.min(rect.right , dragRect.right ) - Math.max(rect.left, dragRect.left))\r\n                                  * Math.max(0, Math.min(rect.bottom, dragRect.bottom) - Math.max(rect.top , dragRect.top ))),\r\n                    overlapRatio = overlapArea / (dragRect.width * dragRect.height);\r\n\r\n                dropped = overlapRatio >= dropOverlap;\r\n            }\r\n\r\n            if (this.options.drop.checker) {\r\n                dropped = this.options.drop.checker(dragEvent, event, dropped, this, dropElement, draggable, draggableElement);\r\n            }\r\n\r\n            return dropped;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.dropChecker\r\n         [ method ]\r\n         *\r\n         * DEPRECATED. Use interactable.dropzone({ checker: function... }) instead.\r\n         *\r\n         * Gets or sets the function used to check if a dragged element is\r\n         * over this Interactable.\r\n         *\r\n         - checker (function) #optional The function that will be called when checking for a drop\r\n         = (Function | Interactable) The checker function or this Interactable\r\n         *\r\n         * The checker function takes the following arguments:\r\n         *\r\n         - dragEvent (InteractEvent) The related dragmove or dragend event\r\n         - event (TouchEvent | PointerEvent | MouseEvent) The user move/up/end Event related to the dragEvent\r\n         - dropped (boolean) The value from the default drop checker\r\n         - dropzone (Interactable) The dropzone interactable\r\n         - dropElement (Element) The dropzone element\r\n         - draggable (Interactable) The Interactable being dragged\r\n         - draggableElement (Element) The actual element that's being dragged\r\n         *\r\n         > Usage:\r\n         | interact(target)\r\n         | .dropChecker(function(dragEvent,         // related dragmove or dragend event\r\n         |                       event,             // TouchEvent/PointerEvent/MouseEvent\r\n         |                       dropped,           // bool result of the default checker\r\n         |                       dropzone,          // dropzone Interactable\r\n         |                       dropElement,       // dropzone elemnt\r\n         |                       draggable,         // draggable Interactable\r\n         |                       draggableElement) {// draggable element\r\n         |\r\n         |   return dropped && event.target.hasAttribute('allow-drop');\r\n         | }\r\n        \\*/\r\n        dropChecker: function (checker) {\r\n            if (isFunction(checker)) {\r\n                this.options.drop.checker = checker;\r\n\r\n                return this;\r\n            }\r\n            if (checker === null) {\r\n                delete this.options.getRect;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.drop.checker;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.accept\r\n         [ method ]\r\n         *\r\n         * Deprecated. add an `accept` property to the options object passed to\r\n         * @Interactable.dropzone instead.\r\n         *\r\n         * Gets or sets the Element or CSS selector match that this\r\n         * Interactable accepts if it is a dropzone.\r\n         *\r\n         - newValue (Element | string | null) #optional\r\n         * If it is an Element, then only that element can be dropped into this dropzone.\r\n         * If it is a string, the element being dragged must match it as a selector.\r\n         * If it is null, the accept options is cleared - it accepts any element.\r\n         *\r\n         = (string | Element | null | Interactable) The current accept option if given `undefined` or this Interactable\r\n        \\*/\r\n        accept: function (newValue) {\r\n            if (isElement(newValue)) {\r\n                this.options.drop.accept = newValue;\r\n\r\n                return this;\r\n            }\r\n\r\n            // test if it is a valid CSS selector\r\n            if (trySelector(newValue)) {\r\n                this.options.drop.accept = newValue;\r\n\r\n                return this;\r\n            }\r\n\r\n            if (newValue === null) {\r\n                delete this.options.drop.accept;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.drop.accept;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.resizable\r\n         [ method ]\r\n         *\r\n         * Gets or sets whether resize actions can be performed on the\r\n         * Interactable\r\n         *\r\n         = (boolean) Indicates if this can be the target of resize elements\r\n         | var isResizeable = interact('input[type=text]').resizable();\r\n         * or\r\n         - options (boolean | object) #optional true/false or An object with event listeners to be fired on resize events (object makes the Interactable resizable)\r\n         = (object) This Interactable\r\n         | interact(element).resizable({\r\n         |     onstart: function (event) {},\r\n         |     onmove : function (event) {},\r\n         |     onend  : function (event) {},\r\n         |\r\n         |     edges: {\r\n         |       top   : true,       // Use pointer coords to check for resize.\r\n         |       left  : false,      // Disable resizing from left edge.\r\n         |       bottom: '.resize-s',// Resize if pointer target matches selector\r\n         |       right : handleEl    // Resize if pointer target is the given Element\r\n         |     },\r\n         |\r\n         |     // Width and height can be adjusted independently. When `true`, width and\r\n         |     // height are adjusted at a 1:1 ratio.\r\n         |     square: false,\r\n         |\r\n         |     // Width and height can be adjusted independently. When `true`, width and\r\n         |     // height maintain the aspect ratio they had when resizing started.\r\n         |     preserveAspectRatio: false,\r\n         |\r\n         |     // a value of 'none' will limit the resize rect to a minimum of 0x0\r\n         |     // 'negate' will allow the rect to have negative width/height\r\n         |     // 'reposition' will keep the width/height positive by swapping\r\n         |     // the top and bottom edges and/or swapping the left and right edges\r\n         |     invert: 'none' || 'negate' || 'reposition'\r\n         |\r\n         |     // limit multiple resizes.\r\n         |     // See the explanation in the @Interactable.draggable example\r\n         |     max: Infinity,\r\n         |     maxPerElement: 1,\r\n         | });\r\n        \\*/\r\n        resizable: function (options) {\r\n            if (isObject(options)) {\r\n                this.options.resize.enabled = options.enabled === false? false: true;\r\n                this.setPerAction('resize', options);\r\n                this.setOnEvents('resize', options);\r\n\r\n                if (/^x$|^y$|^xy$/.test(options.axis)) {\r\n                    this.options.resize.axis = options.axis;\r\n                }\r\n                else if (options.axis === null) {\r\n                    this.options.resize.axis = defaultOptions.resize.axis;\r\n                }\r\n\r\n                if (isBool(options.preserveAspectRatio)) {\r\n                    this.options.resize.preserveAspectRatio = options.preserveAspectRatio;\r\n                }\r\n                else if (isBool(options.square)) {\r\n                    this.options.resize.square = options.square;\r\n                }\r\n\r\n                return this;\r\n            }\r\n            if (isBool(options)) {\r\n                this.options.resize.enabled = options;\r\n\r\n                return this;\r\n            }\r\n            return this.options.resize;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.squareResize\r\n         [ method ]\r\n         *\r\n         * Deprecated. Add a `square: true || false` property to @Interactable.resizable instead\r\n         *\r\n         * Gets or sets whether resizing is forced 1:1 aspect\r\n         *\r\n         = (boolean) Current setting\r\n         *\r\n         * or\r\n         *\r\n         - newValue (boolean) #optional\r\n         = (object) this Interactable\r\n        \\*/\r\n        squareResize: function (newValue) {\r\n            if (isBool(newValue)) {\r\n                this.options.resize.square = newValue;\r\n\r\n                return this;\r\n            }\r\n\r\n            if (newValue === null) {\r\n                delete this.options.resize.square;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.resize.square;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.gesturable\r\n         [ method ]\r\n         *\r\n         * Gets or sets whether multitouch gestures can be performed on the\r\n         * Interactable's element\r\n         *\r\n         = (boolean) Indicates if this can be the target of gesture events\r\n         | var isGestureable = interact(element).gesturable();\r\n         * or\r\n         - options (boolean | object) #optional true/false or An object with event listeners to be fired on gesture events (makes the Interactable gesturable)\r\n         = (object) this Interactable\r\n         | interact(element).gesturable({\r\n         |     onstart: function (event) {},\r\n         |     onmove : function (event) {},\r\n         |     onend  : function (event) {},\r\n         |\r\n         |     // limit multiple gestures.\r\n         |     // See the explanation in @Interactable.draggable example\r\n         |     max: Infinity,\r\n         |     maxPerElement: 1,\r\n         | });\r\n        \\*/\r\n        gesturable: function (options) {\r\n            if (isObject(options)) {\r\n                this.options.gesture.enabled = options.enabled === false? false: true;\r\n                this.setPerAction('gesture', options);\r\n                this.setOnEvents('gesture', options);\r\n\r\n                return this;\r\n            }\r\n\r\n            if (isBool(options)) {\r\n                this.options.gesture.enabled = options;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.gesture;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.autoScroll\r\n         [ method ]\r\n         **\r\n         * Deprecated. Add an `autoscroll` property to the options object\r\n         * passed to @Interactable.draggable or @Interactable.resizable instead.\r\n         *\r\n         * Returns or sets whether dragging and resizing near the edges of the\r\n         * window/container trigger autoScroll for this Interactable\r\n         *\r\n         = (object) Object with autoScroll properties\r\n         *\r\n         * or\r\n         *\r\n         - options (object | boolean) #optional\r\n         * options can be:\r\n         * - an object with margin, distance and interval properties,\r\n         * - true or false to enable or disable autoScroll or\r\n         = (Interactable) this Interactable\r\n        \\*/\r\n        autoScroll: function (options) {\r\n            if (isObject(options)) {\r\n                options = extend({ actions: ['drag', 'resize']}, options);\r\n            }\r\n            else if (isBool(options)) {\r\n                options = { actions: ['drag', 'resize'], enabled: options };\r\n            }\r\n\r\n            return this.setOptions('autoScroll', options);\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.snap\r\n         [ method ]\r\n         **\r\n         * Deprecated. Add a `snap` property to the options object passed\r\n         * to @Interactable.draggable or @Interactable.resizable instead.\r\n         *\r\n         * Returns or sets if and how action coordinates are snapped. By\r\n         * default, snapping is relative to the pointer coordinates. You can\r\n         * change this by setting the\r\n         * [`elementOrigin`](https://github.com/taye/interact.js/pull/72).\r\n         **\r\n         = (boolean | object) `false` if snap is disabled; object with snap properties if snap is enabled\r\n         **\r\n         * or\r\n         **\r\n         - options (object | boolean | null) #optional\r\n         = (Interactable) this Interactable\r\n         > Usage\r\n         | interact(document.querySelector('#thing')).snap({\r\n         |     targets: [\r\n         |         // snap to this specific point\r\n         |         {\r\n         |             x: 100,\r\n         |             y: 100,\r\n         |             range: 25\r\n         |         },\r\n         |         // give this function the x and y page coords and snap to the object returned\r\n         |         function (x, y) {\r\n         |             return {\r\n         |                 x: x,\r\n         |                 y: (75 + 50 * Math.sin(x * 0.04)),\r\n         |                 range: 40\r\n         |             };\r\n         |         },\r\n         |         // create a function that snaps to a grid\r\n         |         interact.createSnapGrid({\r\n         |             x: 50,\r\n         |             y: 50,\r\n         |             range: 10,              // optional\r\n         |             offset: { x: 5, y: 10 } // optional\r\n         |         })\r\n         |     ],\r\n         |     // do not snap during normal movement.\r\n         |     // Instead, trigger only one snapped move event\r\n         |     // immediately before the end event.\r\n         |     endOnly: true,\r\n         |\r\n         |     relativePoints: [\r\n         |         { x: 0, y: 0 },  // snap relative to the top left of the element\r\n         |         { x: 1, y: 1 },  // and also to the bottom right\r\n         |     ],  \r\n         |\r\n         |     // offset the snap target coordinates\r\n         |     // can be an object with x/y or 'startCoords'\r\n         |     offset: { x: 50, y: 50 }\r\n         |   }\r\n         | });\r\n        \\*/\r\n        snap: function (options) {\r\n            var ret = this.setOptions('snap', options);\r\n\r\n            if (ret === this) { return this; }\r\n\r\n            return ret.drag;\r\n        },\r\n\r\n        setOptions: function (option, options) {\r\n            var actions = options && isArray(options.actions)\r\n                    ? options.actions\r\n                    : ['drag'];\r\n\r\n            var i;\r\n\r\n            if (isObject(options) || isBool(options)) {\r\n                for (i = 0; i < actions.length; i++) {\r\n                    var action = /resize/.test(actions[i])? 'resize' : actions[i];\r\n\r\n                    if (!isObject(this.options[action])) { continue; }\r\n\r\n                    var thisOption = this.options[action][option];\r\n\r\n                    if (isObject(options)) {\r\n                        extend(thisOption, options);\r\n                        thisOption.enabled = options.enabled === false? false: true;\r\n\r\n                        if (option === 'snap') {\r\n                            if (thisOption.mode === 'grid') {\r\n                                thisOption.targets = [\r\n                                    interact.createSnapGrid(extend({\r\n                                        offset: thisOption.gridOffset || { x: 0, y: 0 }\r\n                                    }, thisOption.grid || {}))\r\n                                ];\r\n                            }\r\n                            else if (thisOption.mode === 'anchor') {\r\n                                thisOption.targets = thisOption.anchors;\r\n                            }\r\n                            else if (thisOption.mode === 'path') {\r\n                                thisOption.targets = thisOption.paths;\r\n                            }\r\n\r\n                            if ('elementOrigin' in options) {\r\n                                thisOption.relativePoints = [options.elementOrigin];\r\n                            }\r\n                        }\r\n                    }\r\n                    else if (isBool(options)) {\r\n                        thisOption.enabled = options;\r\n                    }\r\n                }\r\n\r\n                return this;\r\n            }\r\n\r\n            var ret = {},\r\n                allActions = ['drag', 'resize', 'gesture'];\r\n\r\n            for (i = 0; i < allActions.length; i++) {\r\n                if (option in defaultOptions[allActions[i]]) {\r\n                    ret[allActions[i]] = this.options[allActions[i]][option];\r\n                }\r\n            }\r\n\r\n            return ret;\r\n        },\r\n\r\n\r\n        /*\\\r\n         * Interactable.inertia\r\n         [ method ]\r\n         **\r\n         * Deprecated. Add an `inertia` property to the options object passed\r\n         * to @Interactable.draggable or @Interactable.resizable instead.\r\n         *\r\n         * Returns or sets if and how events continue to run after the pointer is released\r\n         **\r\n         = (boolean | object) `false` if inertia is disabled; `object` with inertia properties if inertia is enabled\r\n         **\r\n         * or\r\n         **\r\n         - options (object | boolean | null) #optional\r\n         = (Interactable) this Interactable\r\n         > Usage\r\n         | // enable and use default settings\r\n         | interact(element).inertia(true);\r\n         |\r\n         | // enable and use custom settings\r\n         | interact(element).inertia({\r\n         |     // value greater than 0\r\n         |     // high values slow the object down more quickly\r\n         |     resistance     : 16,\r\n         |\r\n         |     // the minimum launch speed (pixels per second) that results in inertia start\r\n         |     minSpeed       : 200,\r\n         |\r\n         |     // inertia will stop when the object slows down to this speed\r\n         |     endSpeed       : 20,\r\n         |\r\n         |     // boolean; should actions be resumed when the pointer goes down during inertia\r\n         |     allowResume    : true,\r\n         |\r\n         |     // boolean; should the jump when resuming from inertia be ignored in event.dx/dy\r\n         |     zeroResumeDelta: false,\r\n         |\r\n         |     // if snap/restrict are set to be endOnly and inertia is enabled, releasing\r\n         |     // the pointer without triggering inertia will animate from the release\r\n         |     // point to the snaped/restricted point in the given amount of time (ms)\r\n         |     smoothEndDuration: 300,\r\n         |\r\n         |     // an array of action types that can have inertia (no gesture)\r\n         |     actions        : ['drag', 'resize']\r\n         | });\r\n         |\r\n         | // reset custom settings and use all defaults\r\n         | interact(element).inertia(null);\r\n        \\*/\r\n        inertia: function (options) {\r\n            var ret = this.setOptions('inertia', options);\r\n\r\n            if (ret === this) { return this; }\r\n\r\n            return ret.drag;\r\n        },\r\n\r\n        getAction: function (pointer, event, interaction, element) {\r\n            var action = this.defaultActionChecker(pointer, interaction, element);\r\n\r\n            if (this.options.actionChecker) {\r\n                return this.options.actionChecker(pointer, event, action, this, element, interaction);\r\n            }\r\n\r\n            return action;\r\n        },\r\n\r\n        defaultActionChecker: defaultActionChecker,\r\n\r\n        /*\\\r\n         * Interactable.actionChecker\r\n         [ method ]\r\n         *\r\n         * Gets or sets the function used to check action to be performed on\r\n         * pointerDown\r\n         *\r\n         - checker (function | null) #optional A function which takes a pointer event, defaultAction string, interactable, element and interaction as parameters and returns an object with name property 'drag' 'resize' or 'gesture' and optionally an `edges` object with boolean 'top', 'left', 'bottom' and right props.\r\n         = (Function | Interactable) The checker function or this Interactable\r\n         *\r\n         | interact('.resize-drag')\r\n         |   .resizable(true)\r\n         |   .draggable(true)\r\n         |   .actionChecker(function (pointer, event, action, interactable, element, interaction) {\r\n         |\r\n         |   if (interact.matchesSelector(event.target, '.drag-handle') {\r\n         |     // force drag with handle target\r\n         |     action.name = drag;\r\n         |   }\r\n         |   else {\r\n         |     // resize from the top and right edges\r\n         |     action.name  = 'resize';\r\n         |     action.edges = { top: true, right: true };\r\n         |   }\r\n         |\r\n         |   return action;\r\n         | });\r\n        \\*/\r\n        actionChecker: function (checker) {\r\n            if (isFunction(checker)) {\r\n                this.options.actionChecker = checker;\r\n\r\n                return this;\r\n            }\r\n\r\n            if (checker === null) {\r\n                delete this.options.actionChecker;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.actionChecker;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.getRect\r\n         [ method ]\r\n         *\r\n         * The default function to get an Interactables bounding rect. Can be\r\n         * overridden using @Interactable.rectChecker.\r\n         *\r\n         - element (Element) #optional The element to measure.\r\n         = (object) The object's bounding rectangle.\r\n         o {\r\n         o     top   : 0,\r\n         o     left  : 0,\r\n         o     bottom: 0,\r\n         o     right : 0,\r\n         o     width : 0,\r\n         o     height: 0\r\n         o }\r\n        \\*/\r\n        getRect: function rectCheck (element) {\r\n            element = element || this._element;\r\n\r\n            if (this.selector && !(isElement(element))) {\r\n                element = this._context.querySelector(this.selector);\r\n            }\r\n\r\n            return getElementRect(element);\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.rectChecker\r\n         [ method ]\r\n         *\r\n         * Returns or sets the function used to calculate the interactable's\r\n         * element's rectangle\r\n         *\r\n         - checker (function) #optional A function which returns this Interactable's bounding rectangle. See @Interactable.getRect\r\n         = (function | object) The checker function or this Interactable\r\n        \\*/\r\n        rectChecker: function (checker) {\r\n            if (isFunction(checker)) {\r\n                this.getRect = checker;\r\n\r\n                return this;\r\n            }\r\n\r\n            if (checker === null) {\r\n                delete this.options.getRect;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.getRect;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.styleCursor\r\n         [ method ]\r\n         *\r\n         * Returns or sets whether the action that would be performed when the\r\n         * mouse on the element are checked on `mousemove` so that the cursor\r\n         * may be styled appropriately\r\n         *\r\n         - newValue (boolean) #optional\r\n         = (boolean | Interactable) The current setting or this Interactable\r\n        \\*/\r\n        styleCursor: function (newValue) {\r\n            if (isBool(newValue)) {\r\n                this.options.styleCursor = newValue;\r\n\r\n                return this;\r\n            }\r\n\r\n            if (newValue === null) {\r\n                delete this.options.styleCursor;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.styleCursor;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.preventDefault\r\n         [ method ]\r\n         *\r\n         * Returns or sets whether to prevent the browser's default behaviour\r\n         * in response to pointer events. Can be set to:\r\n         *  - `'always'` to always prevent\r\n         *  - `'never'` to never prevent\r\n         *  - `'auto'` to let interact.js try to determine what would be best\r\n         *\r\n         - newValue (string) #optional `true`, `false` or `'auto'`\r\n         = (string | Interactable) The current setting or this Interactable\r\n        \\*/\r\n        preventDefault: function (newValue) {\r\n            if (/^(always|never|auto)$/.test(newValue)) {\r\n                this.options.preventDefault = newValue;\r\n                return this;\r\n            }\r\n\r\n            if (isBool(newValue)) {\r\n                this.options.preventDefault = newValue? 'always' : 'never';\r\n                return this;\r\n            }\r\n\r\n            return this.options.preventDefault;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.origin\r\n         [ method ]\r\n         *\r\n         * Gets or sets the origin of the Interactable's element.  The x and y\r\n         * of the origin will be subtracted from action event coordinates.\r\n         *\r\n         - origin (object | string) #optional An object eg. { x: 0, y: 0 } or string 'parent', 'self' or any CSS selector\r\n         * OR\r\n         - origin (Element) #optional An HTML or SVG Element whose rect will be used\r\n         **\r\n         = (object) The current origin or this Interactable\r\n        \\*/\r\n        origin: function (newValue) {\r\n            if (trySelector(newValue)) {\r\n                this.options.origin = newValue;\r\n                return this;\r\n            }\r\n            else if (isObject(newValue)) {\r\n                this.options.origin = newValue;\r\n                return this;\r\n            }\r\n\r\n            return this.options.origin;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.deltaSource\r\n         [ method ]\r\n         *\r\n         * Returns or sets the mouse coordinate types used to calculate the\r\n         * movement of the pointer.\r\n         *\r\n         - newValue (string) #optional Use 'client' if you will be scrolling while interacting; Use 'page' if you want autoScroll to work\r\n         = (string | object) The current deltaSource or this Interactable\r\n        \\*/\r\n        deltaSource: function (newValue) {\r\n            if (newValue === 'page' || newValue === 'client') {\r\n                this.options.deltaSource = newValue;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.deltaSource;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.restrict\r\n         [ method ]\r\n         **\r\n         * Deprecated. Add a `restrict` property to the options object passed to\r\n         * @Interactable.draggable, @Interactable.resizable or @Interactable.gesturable instead.\r\n         *\r\n         * Returns or sets the rectangles within which actions on this\r\n         * interactable (after snap calculations) are restricted. By default,\r\n         * restricting is relative to the pointer coordinates. You can change\r\n         * this by setting the\r\n         * [`elementRect`](https://github.com/taye/interact.js/pull/72).\r\n         **\r\n         - options (object) #optional an object with keys drag, resize, and/or gesture whose values are rects, Elements, CSS selectors, or 'parent' or 'self'\r\n         = (object) The current restrictions object or this Interactable\r\n         **\r\n         | interact(element).restrict({\r\n         |     // the rect will be `interact.getElementRect(element.parentNode)`\r\n         |     drag: element.parentNode,\r\n         |\r\n         |     // x and y are relative to the the interactable's origin\r\n         |     resize: { x: 100, y: 100, width: 200, height: 200 }\r\n         | })\r\n         |\r\n         | interact('.draggable').restrict({\r\n         |     // the rect will be the selected element's parent\r\n         |     drag: 'parent',\r\n         |\r\n         |     // do not restrict during normal movement.\r\n         |     // Instead, trigger only one restricted move event\r\n         |     // immediately before the end event.\r\n         |     endOnly: true,\r\n         |\r\n         |     // https://github.com/taye/interact.js/pull/72#issue-41813493\r\n         |     elementRect: { top: 0, left: 0, bottom: 1, right: 1 }\r\n         | });\r\n        \\*/\r\n        restrict: function (options) {\r\n            if (!isObject(options)) {\r\n                return this.setOptions('restrict', options);\r\n            }\r\n\r\n            var actions = ['drag', 'resize', 'gesture'],\r\n                ret;\r\n\r\n            for (var i = 0; i < actions.length; i++) {\r\n                var action = actions[i];\r\n\r\n                if (action in options) {\r\n                    var perAction = extend({\r\n                            actions: [action],\r\n                            restriction: options[action]\r\n                        }, options);\r\n\r\n                    ret = this.setOptions('restrict', perAction);\r\n                }\r\n            }\r\n\r\n            return ret;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.context\r\n         [ method ]\r\n         *\r\n         * Gets the selector context Node of the Interactable. The default is `window.document`.\r\n         *\r\n         = (Node) The context Node of this Interactable\r\n         **\r\n        \\*/\r\n        context: function () {\r\n            return this._context;\r\n        },\r\n\r\n        _context: document,\r\n\r\n        /*\\\r\n         * Interactable.ignoreFrom\r\n         [ method ]\r\n         *\r\n         * If the target of the `mousedown`, `pointerdown` or `touchstart`\r\n         * event or any of it's parents match the given CSS selector or\r\n         * Element, no drag/resize/gesture is started.\r\n         *\r\n         - newValue (string | Element | null) #optional a CSS selector string, an Element or `null` to not ignore any elements\r\n         = (string | Element | object) The current ignoreFrom value or this Interactable\r\n         **\r\n         | interact(element, { ignoreFrom: document.getElementById('no-action') });\r\n         | // or\r\n         | interact(element).ignoreFrom('input, textarea, a');\r\n        \\*/\r\n        ignoreFrom: function (newValue) {\r\n            if (trySelector(newValue)) {            // CSS selector to match event.target\r\n                this.options.ignoreFrom = newValue;\r\n                return this;\r\n            }\r\n\r\n            if (isElement(newValue)) {              // specific element\r\n                this.options.ignoreFrom = newValue;\r\n                return this;\r\n            }\r\n\r\n            return this.options.ignoreFrom;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.allowFrom\r\n         [ method ]\r\n         *\r\n         * A drag/resize/gesture is started only If the target of the\r\n         * `mousedown`, `pointerdown` or `touchstart` event or any of it's\r\n         * parents match the given CSS selector or Element.\r\n         *\r\n         - newValue (string | Element | null) #optional a CSS selector string, an Element or `null` to allow from any element\r\n         = (string | Element | object) The current allowFrom value or this Interactable\r\n         **\r\n         | interact(element, { allowFrom: document.getElementById('drag-handle') });\r\n         | // or\r\n         | interact(element).allowFrom('.handle');\r\n        \\*/\r\n        allowFrom: function (newValue) {\r\n            if (trySelector(newValue)) {            // CSS selector to match event.target\r\n                this.options.allowFrom = newValue;\r\n                return this;\r\n            }\r\n\r\n            if (isElement(newValue)) {              // specific element\r\n                this.options.allowFrom = newValue;\r\n                return this;\r\n            }\r\n\r\n            return this.options.allowFrom;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.element\r\n         [ method ]\r\n         *\r\n         * If this is not a selector Interactable, it returns the element this\r\n         * interactable represents\r\n         *\r\n         = (Element) HTML / SVG Element\r\n        \\*/\r\n        element: function () {\r\n            return this._element;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.fire\r\n         [ method ]\r\n         *\r\n         * Calls listeners for the given InteractEvent type bound globally\r\n         * and directly to this Interactable\r\n         *\r\n         - iEvent (InteractEvent) The InteractEvent object to be fired on this Interactable\r\n         = (Interactable) this Interactable\r\n        \\*/\r\n        fire: function (iEvent) {\r\n            if (!(iEvent && iEvent.type) || !contains(eventTypes, iEvent.type)) {\r\n                return this;\r\n            }\r\n\r\n            var listeners,\r\n                i,\r\n                len,\r\n                onEvent = 'on' + iEvent.type,\r\n                funcName = '';\r\n\r\n            // Interactable#on() listeners\r\n            if (iEvent.type in this._iEvents) {\r\n                listeners = this._iEvents[iEvent.type];\r\n\r\n                for (i = 0, len = listeners.length; i < len && !iEvent.immediatePropagationStopped; i++) {\r\n                    funcName = listeners[i].name;\r\n                    listeners[i](iEvent);\r\n                }\r\n            }\r\n\r\n            // interactable.onevent listener\r\n            if (isFunction(this[onEvent])) {\r\n                funcName = this[onEvent].name;\r\n                this[onEvent](iEvent);\r\n            }\r\n\r\n            // interact.on() listeners\r\n            if (iEvent.type in globalEvents && (listeners = globalEvents[iEvent.type]))  {\r\n\r\n                for (i = 0, len = listeners.length; i < len && !iEvent.immediatePropagationStopped; i++) {\r\n                    funcName = listeners[i].name;\r\n                    listeners[i](iEvent);\r\n                }\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.on\r\n         [ method ]\r\n         *\r\n         * Binds a listener for an InteractEvent or DOM event.\r\n         *\r\n         - eventType  (string | array | object) The types of events to listen for\r\n         - listener   (function) The function to be called on the given event(s)\r\n         - useCapture (boolean) #optional useCapture flag for addEventListener\r\n         = (object) This Interactable\r\n        \\*/\r\n        on: function (eventType, listener, useCapture) {\r\n            var i;\r\n\r\n            if (isString(eventType) && eventType.search(' ') !== -1) {\r\n                eventType = eventType.trim().split(/ +/);\r\n            }\r\n\r\n            if (isArray(eventType)) {\r\n                for (i = 0; i < eventType.length; i++) {\r\n                    this.on(eventType[i], listener, useCapture);\r\n                }\r\n\r\n                return this;\r\n            }\r\n\r\n            if (isObject(eventType)) {\r\n                for (var prop in eventType) {\r\n                    this.on(prop, eventType[prop], listener);\r\n                }\r\n\r\n                return this;\r\n            }\r\n\r\n            if (eventType === 'wheel') {\r\n                eventType = wheelEvent;\r\n            }\r\n\r\n            // convert to boolean\r\n            useCapture = useCapture? true: false;\r\n\r\n            if (contains(eventTypes, eventType)) {\r\n                // if this type of event was never bound to this Interactable\r\n                if (!(eventType in this._iEvents)) {\r\n                    this._iEvents[eventType] = [listener];\r\n                }\r\n                else {\r\n                    this._iEvents[eventType].push(listener);\r\n                }\r\n            }\r\n            // delegated event for selector\r\n            else if (this.selector) {\r\n                if (!delegatedEvents[eventType]) {\r\n                    delegatedEvents[eventType] = {\r\n                        selectors: [],\r\n                        contexts : [],\r\n                        listeners: []\r\n                    };\r\n\r\n                    // add delegate listener functions\r\n                    for (i = 0; i < documents.length; i++) {\r\n                        events.add(documents[i], eventType, delegateListener);\r\n                        events.add(documents[i], eventType, delegateUseCapture, true);\r\n                    }\r\n                }\r\n\r\n                var delegated = delegatedEvents[eventType],\r\n                    index;\r\n\r\n                for (index = delegated.selectors.length - 1; index >= 0; index--) {\r\n                    if (delegated.selectors[index] === this.selector\r\n                        && delegated.contexts[index] === this._context) {\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                if (index === -1) {\r\n                    index = delegated.selectors.length;\r\n\r\n                    delegated.selectors.push(this.selector);\r\n                    delegated.contexts .push(this._context);\r\n                    delegated.listeners.push([]);\r\n                }\r\n\r\n                // keep listener and useCapture flag\r\n                delegated.listeners[index].push([listener, useCapture]);\r\n            }\r\n            else {\r\n                events.add(this._element, eventType, listener, useCapture);\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.off\r\n         [ method ]\r\n         *\r\n         * Removes an InteractEvent or DOM event listener\r\n         *\r\n         - eventType  (string | array | object) The types of events that were listened for\r\n         - listener   (function) The listener function to be removed\r\n         - useCapture (boolean) #optional useCapture flag for removeEventListener\r\n         = (object) This Interactable\r\n        \\*/\r\n        off: function (eventType, listener, useCapture) {\r\n            var i;\r\n\r\n            if (isString(eventType) && eventType.search(' ') !== -1) {\r\n                eventType = eventType.trim().split(/ +/);\r\n            }\r\n\r\n            if (isArray(eventType)) {\r\n                for (i = 0; i < eventType.length; i++) {\r\n                    this.off(eventType[i], listener, useCapture);\r\n                }\r\n\r\n                return this;\r\n            }\r\n\r\n            if (isObject(eventType)) {\r\n                for (var prop in eventType) {\r\n                    this.off(prop, eventType[prop], listener);\r\n                }\r\n\r\n                return this;\r\n            }\r\n\r\n            var eventList,\r\n                index = -1;\r\n\r\n            // convert to boolean\r\n            useCapture = useCapture? true: false;\r\n\r\n            if (eventType === 'wheel') {\r\n                eventType = wheelEvent;\r\n            }\r\n\r\n            // if it is an action event type\r\n            if (contains(eventTypes, eventType)) {\r\n                eventList = this._iEvents[eventType];\r\n\r\n                if (eventList && (index = indexOf(eventList, listener)) !== -1) {\r\n                    this._iEvents[eventType].splice(index, 1);\r\n                }\r\n            }\r\n            // delegated event\r\n            else if (this.selector) {\r\n                var delegated = delegatedEvents[eventType],\r\n                    matchFound = false;\r\n\r\n                if (!delegated) { return this; }\r\n\r\n                // count from last index of delegated to 0\r\n                for (index = delegated.selectors.length - 1; index >= 0; index--) {\r\n                    // look for matching selector and context Node\r\n                    if (delegated.selectors[index] === this.selector\r\n                        && delegated.contexts[index] === this._context) {\r\n\r\n                        var listeners = delegated.listeners[index];\r\n\r\n                        // each item of the listeners array is an array: [function, useCaptureFlag]\r\n                        for (i = listeners.length - 1; i >= 0; i--) {\r\n                            var fn = listeners[i][0],\r\n                                useCap = listeners[i][1];\r\n\r\n                            // check if the listener functions and useCapture flags match\r\n                            if (fn === listener && useCap === useCapture) {\r\n                                // remove the listener from the array of listeners\r\n                                listeners.splice(i, 1);\r\n\r\n                                // if all listeners for this interactable have been removed\r\n                                // remove the interactable from the delegated arrays\r\n                                if (!listeners.length) {\r\n                                    delegated.selectors.splice(index, 1);\r\n                                    delegated.contexts .splice(index, 1);\r\n                                    delegated.listeners.splice(index, 1);\r\n\r\n                                    // remove delegate function from context\r\n                                    events.remove(this._context, eventType, delegateListener);\r\n                                    events.remove(this._context, eventType, delegateUseCapture, true);\r\n\r\n                                    // remove the arrays if they are empty\r\n                                    if (!delegated.selectors.length) {\r\n                                        delegatedEvents[eventType] = null;\r\n                                    }\r\n                                }\r\n\r\n                                // only remove one listener\r\n                                matchFound = true;\r\n                                break;\r\n                            }\r\n                        }\r\n\r\n                        if (matchFound) { break; }\r\n                    }\r\n                }\r\n            }\r\n            // remove listener from this Interatable's element\r\n            else {\r\n                events.remove(this._element, eventType, listener, useCapture);\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.set\r\n         [ method ]\r\n         *\r\n         * Reset the options of this Interactable\r\n         - options (object) The new settings to apply\r\n         = (object) This Interactable\r\n        \\*/\r\n        set: function (options) {\r\n            if (!isObject(options)) {\r\n                options = {};\r\n            }\r\n\r\n            this.options = extend({}, defaultOptions.base);\r\n\r\n            var i,\r\n                actions = ['drag', 'drop', 'resize', 'gesture'],\r\n                methods = ['draggable', 'dropzone', 'resizable', 'gesturable'],\r\n                perActions = extend(extend({}, defaultOptions.perAction), options[action] || {});\r\n\r\n            for (i = 0; i < actions.length; i++) {\r\n                var action = actions[i];\r\n\r\n                this.options[action] = extend({}, defaultOptions[action]);\r\n\r\n                this.setPerAction(action, perActions);\r\n\r\n                this[methods[i]](options[action]);\r\n            }\r\n\r\n            var settings = [\r\n                    'accept', 'actionChecker', 'allowFrom', 'deltaSource',\r\n                    'dropChecker', 'ignoreFrom', 'origin', 'preventDefault',\r\n                    'rectChecker', 'styleCursor'\r\n                ];\r\n\r\n            for (i = 0, len = settings.length; i < len; i++) {\r\n                var setting = settings[i];\r\n\r\n                this.options[setting] = defaultOptions.base[setting];\r\n\r\n                if (setting in options) {\r\n                    this[setting](options[setting]);\r\n                }\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.unset\r\n         [ method ]\r\n         *\r\n         * Remove this interactable from the list of interactables and remove\r\n         * it's drag, drop, resize and gesture capabilities\r\n         *\r\n         = (object) @interact\r\n        \\*/\r\n        unset: function () {\r\n            events.remove(this._element, 'all');\r\n\r\n            if (!isString(this.selector)) {\r\n                events.remove(this, 'all');\r\n                if (this.options.styleCursor) {\r\n                    this._element.style.cursor = '';\r\n                }\r\n            }\r\n            else {\r\n                // remove delegated events\r\n                for (var type in delegatedEvents) {\r\n                    var delegated = delegatedEvents[type];\r\n\r\n                    for (var i = 0; i < delegated.selectors.length; i++) {\r\n                        if (delegated.selectors[i] === this.selector\r\n                            && delegated.contexts[i] === this._context) {\r\n\r\n                            delegated.selectors.splice(i, 1);\r\n                            delegated.contexts .splice(i, 1);\r\n                            delegated.listeners.splice(i, 1);\r\n\r\n                            // remove the arrays if they are empty\r\n                            if (!delegated.selectors.length) {\r\n                                delegatedEvents[type] = null;\r\n                            }\r\n                        }\r\n\r\n                        events.remove(this._context, type, delegateListener);\r\n                        events.remove(this._context, type, delegateUseCapture, true);\r\n\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            this.dropzone(false);\r\n\r\n            interactables.splice(indexOf(interactables, this), 1);\r\n\r\n            return interact;\r\n        }\r\n    };\r\n\r\n    function warnOnce (method, message) {\r\n        var warned = false;\r\n\r\n        return function () {\r\n            if (!warned) {\r\n                window.console.warn(message);\r\n                warned = true;\r\n            }\r\n\r\n            return method.apply(this, arguments);\r\n        };\r\n    }\r\n\r\n    Interactable.prototype.snap = warnOnce(Interactable.prototype.snap,\r\n         'Interactable#snap is deprecated. See the new documentation for snapping at http://interactjs.io/docs/snapping');\r\n    Interactable.prototype.restrict = warnOnce(Interactable.prototype.restrict,\r\n         'Interactable#restrict is deprecated. See the new documentation for resticting at http://interactjs.io/docs/restriction');\r\n    Interactable.prototype.inertia = warnOnce(Interactable.prototype.inertia,\r\n         'Interactable#inertia is deprecated. See the new documentation for inertia at http://interactjs.io/docs/inertia');\r\n    Interactable.prototype.autoScroll = warnOnce(Interactable.prototype.autoScroll,\r\n         'Interactable#autoScroll is deprecated. See the new documentation for autoScroll at http://interactjs.io/docs/#autoscroll');\r\n    Interactable.prototype.squareResize = warnOnce(Interactable.prototype.squareResize,\r\n         'Interactable#squareResize is deprecated. See http://interactjs.io/docs/#resize-square');\r\n\r\n    Interactable.prototype.accept = warnOnce(Interactable.prototype.accept,\r\n         'Interactable#accept is deprecated. use Interactable#dropzone({ accept: target }) instead');\r\n    Interactable.prototype.dropChecker = warnOnce(Interactable.prototype.dropChecker,\r\n         'Interactable#dropChecker is deprecated. use Interactable#dropzone({ dropChecker: checkerFunction }) instead');\r\n    Interactable.prototype.context = warnOnce(Interactable.prototype.context,\r\n         'Interactable#context as a method is deprecated. It will soon be a DOM Node instead');\r\n\r\n    /*\\\r\n     * interact.isSet\r\n     [ method ]\r\n     *\r\n     * Check if an element has been set\r\n     - element (Element) The Element being searched for\r\n     = (boolean) Indicates if the element or CSS selector was previously passed to interact\r\n    \\*/\r\n    interact.isSet = function(element, options) {\r\n        return interactables.indexOfElement(element, options && options.context) !== -1;\r\n    };\r\n\r\n    /*\\\r\n     * interact.on\r\n     [ method ]\r\n     *\r\n     * Adds a global listener for an InteractEvent or adds a DOM event to\r\n     * `document`\r\n     *\r\n     - type       (string | array | object) The types of events to listen for\r\n     - listener   (function) The function to be called on the given event(s)\r\n     - useCapture (boolean) #optional useCapture flag for addEventListener\r\n     = (object) interact\r\n    \\*/\r\n    interact.on = function (type, listener, useCapture) {\r\n        if (isString(type) && type.search(' ') !== -1) {\r\n            type = type.trim().split(/ +/);\r\n        }\r\n\r\n        if (isArray(type)) {\r\n            for (var i = 0; i < type.length; i++) {\r\n                interact.on(type[i], listener, useCapture);\r\n            }\r\n\r\n            return interact;\r\n        }\r\n\r\n        if (isObject(type)) {\r\n            for (var prop in type) {\r\n                interact.on(prop, type[prop], listener);\r\n            }\r\n\r\n            return interact;\r\n        }\r\n\r\n        // if it is an InteractEvent type, add listener to globalEvents\r\n        if (contains(eventTypes, type)) {\r\n            // if this type of event was never bound\r\n            if (!globalEvents[type]) {\r\n                globalEvents[type] = [listener];\r\n            }\r\n            else {\r\n                globalEvents[type].push(listener);\r\n            }\r\n        }\r\n        // If non InteractEvent type, addEventListener to document\r\n        else {\r\n            events.add(document, type, listener, useCapture);\r\n        }\r\n\r\n        return interact;\r\n    };\r\n\r\n    /*\\\r\n     * interact.off\r\n     [ method ]\r\n     *\r\n     * Removes a global InteractEvent listener or DOM event from `document`\r\n     *\r\n     - type       (string | array | object) The types of events that were listened for\r\n     - listener   (function) The listener function to be removed\r\n     - useCapture (boolean) #optional useCapture flag for removeEventListener\r\n     = (object) interact\r\n     \\*/\r\n    interact.off = function (type, listener, useCapture) {\r\n        if (isString(type) && type.search(' ') !== -1) {\r\n            type = type.trim().split(/ +/);\r\n        }\r\n\r\n        if (isArray(type)) {\r\n            for (var i = 0; i < type.length; i++) {\r\n                interact.off(type[i], listener, useCapture);\r\n            }\r\n\r\n            return interact;\r\n        }\r\n\r\n        if (isObject(type)) {\r\n            for (var prop in type) {\r\n                interact.off(prop, type[prop], listener);\r\n            }\r\n\r\n            return interact;\r\n        }\r\n\r\n        if (!contains(eventTypes, type)) {\r\n            events.remove(document, type, listener, useCapture);\r\n        }\r\n        else {\r\n            var index;\r\n\r\n            if (type in globalEvents\r\n                && (index = indexOf(globalEvents[type], listener)) !== -1) {\r\n                globalEvents[type].splice(index, 1);\r\n            }\r\n        }\r\n\r\n        return interact;\r\n    };\r\n\r\n    /*\\\r\n     * interact.enableDragging\r\n     [ method ]\r\n     *\r\n     * Deprecated.\r\n     *\r\n     * Returns or sets whether dragging is enabled for any Interactables\r\n     *\r\n     - newValue (boolean) #optional `true` to allow the action; `false` to disable action for all Interactables\r\n     = (boolean | object) The current setting or interact\r\n    \\*/\r\n    interact.enableDragging = warnOnce(function (newValue) {\r\n        if (newValue !== null && newValue !== undefined) {\r\n            actionIsEnabled.drag = newValue;\r\n\r\n            return interact;\r\n        }\r\n        return actionIsEnabled.drag;\r\n    }, 'interact.enableDragging is deprecated and will soon be removed.');\r\n\r\n    /*\\\r\n     * interact.enableResizing\r\n     [ method ]\r\n     *\r\n     * Deprecated.\r\n     *\r\n     * Returns or sets whether resizing is enabled for any Interactables\r\n     *\r\n     - newValue (boolean) #optional `true` to allow the action; `false` to disable action for all Interactables\r\n     = (boolean | object) The current setting or interact\r\n    \\*/\r\n    interact.enableResizing = warnOnce(function (newValue) {\r\n        if (newValue !== null && newValue !== undefined) {\r\n            actionIsEnabled.resize = newValue;\r\n\r\n            return interact;\r\n        }\r\n        return actionIsEnabled.resize;\r\n    }, 'interact.enableResizing is deprecated and will soon be removed.');\r\n\r\n    /*\\\r\n     * interact.enableGesturing\r\n     [ method ]\r\n     *\r\n     * Deprecated.\r\n     *\r\n     * Returns or sets whether gesturing is enabled for any Interactables\r\n     *\r\n     - newValue (boolean) #optional `true` to allow the action; `false` to disable action for all Interactables\r\n     = (boolean | object) The current setting or interact\r\n    \\*/\r\n    interact.enableGesturing = warnOnce(function (newValue) {\r\n        if (newValue !== null && newValue !== undefined) {\r\n            actionIsEnabled.gesture = newValue;\r\n\r\n            return interact;\r\n        }\r\n        return actionIsEnabled.gesture;\r\n    }, 'interact.enableGesturing is deprecated and will soon be removed.');\r\n\r\n    interact.eventTypes = eventTypes;\r\n\r\n    /*\\\r\n     * interact.debug\r\n     [ method ]\r\n     *\r\n     * Returns debugging data\r\n     = (object) An object with properties that outline the current state and expose internal functions and variables\r\n    \\*/\r\n    interact.debug = function () {\r\n        var interaction = interactions[0] || new Interaction();\r\n\r\n        return {\r\n            interactions          : interactions,\r\n            target                : interaction.target,\r\n            dragging              : interaction.dragging,\r\n            resizing              : interaction.resizing,\r\n            gesturing             : interaction.gesturing,\r\n            prepared              : interaction.prepared,\r\n            matches               : interaction.matches,\r\n            matchElements         : interaction.matchElements,\r\n\r\n            prevCoords            : interaction.prevCoords,\r\n            startCoords           : interaction.startCoords,\r\n\r\n            pointerIds            : interaction.pointerIds,\r\n            pointers              : interaction.pointers,\r\n            addPointer            : listeners.addPointer,\r\n            removePointer         : listeners.removePointer,\r\n            recordPointer        : listeners.recordPointer,\r\n\r\n            snap                  : interaction.snapStatus,\r\n            restrict              : interaction.restrictStatus,\r\n            inertia               : interaction.inertiaStatus,\r\n\r\n            downTime              : interaction.downTimes[0],\r\n            downEvent             : interaction.downEvent,\r\n            downPointer           : interaction.downPointer,\r\n            prevEvent             : interaction.prevEvent,\r\n\r\n            Interactable          : Interactable,\r\n            interactables         : interactables,\r\n            pointerIsDown         : interaction.pointerIsDown,\r\n            defaultOptions        : defaultOptions,\r\n            defaultActionChecker  : defaultActionChecker,\r\n\r\n            actionCursors         : actionCursors,\r\n            dragMove              : listeners.dragMove,\r\n            resizeMove            : listeners.resizeMove,\r\n            gestureMove           : listeners.gestureMove,\r\n            pointerUp             : listeners.pointerUp,\r\n            pointerDown           : listeners.pointerDown,\r\n            pointerMove           : listeners.pointerMove,\r\n            pointerHover          : listeners.pointerHover,\r\n\r\n            eventTypes            : eventTypes,\r\n\r\n            events                : events,\r\n            globalEvents          : globalEvents,\r\n            delegatedEvents       : delegatedEvents,\r\n\r\n            prefixedPropREs       : prefixedPropREs\r\n        };\r\n    };\r\n\r\n    // expose the functions used to calculate multi-touch properties\r\n    interact.getPointerAverage = pointerAverage;\r\n    interact.getTouchBBox     = touchBBox;\r\n    interact.getTouchDistance = touchDistance;\r\n    interact.getTouchAngle    = touchAngle;\r\n\r\n    interact.getElementRect         = getElementRect;\r\n    interact.getElementClientRect   = getElementClientRect;\r\n    interact.matchesSelector        = matchesSelector;\r\n    interact.closest                = closest;\r\n\r\n    /*\\\r\n     * interact.margin\r\n     [ method ]\r\n     *\r\n     * Deprecated. Use `interact(target).resizable({ margin: number });` instead.\r\n     * Returns or sets the margin for autocheck resizing used in\r\n     * @Interactable.getAction. That is the distance from the bottom and right\r\n     * edges of an element clicking in which will start resizing\r\n     *\r\n     - newValue (number) #optional\r\n     = (number | interact) The current margin value or interact\r\n    \\*/\r\n    interact.margin = warnOnce(function (newvalue) {\r\n        if (isNumber(newvalue)) {\r\n            margin = newvalue;\r\n\r\n            return interact;\r\n        }\r\n        return margin;\r\n    },\r\n    'interact.margin is deprecated. Use interact(target).resizable({ margin: number }); instead.') ;\r\n\r\n    /*\\\r\n     * interact.supportsTouch\r\n     [ method ]\r\n     *\r\n     = (boolean) Whether or not the browser supports touch input\r\n    \\*/\r\n    interact.supportsTouch = function () {\r\n        return supportsTouch;\r\n    };\r\n\r\n    /*\\\r\n     * interact.supportsPointerEvent\r\n     [ method ]\r\n     *\r\n     = (boolean) Whether or not the browser supports PointerEvents\r\n    \\*/\r\n    interact.supportsPointerEvent = function () {\r\n        return supportsPointerEvent;\r\n    };\r\n\r\n    /*\\\r\n     * interact.stop\r\n     [ method ]\r\n     *\r\n     * Cancels all interactions (end events are not fired)\r\n     *\r\n     - event (Event) An event on which to call preventDefault()\r\n     = (object) interact\r\n    \\*/\r\n    interact.stop = function (event) {\r\n        for (var i = interactions.length - 1; i >= 0; i--) {\r\n            interactions[i].stop(event);\r\n        }\r\n\r\n        return interact;\r\n    };\r\n\r\n    /*\\\r\n     * interact.dynamicDrop\r\n     [ method ]\r\n     *\r\n     * Returns or sets whether the dimensions of dropzone elements are\r\n     * calculated on every dragmove or only on dragstart for the default\r\n     * dropChecker\r\n     *\r\n     - newValue (boolean) #optional True to check on each move. False to check only before start\r\n     = (boolean | interact) The current setting or interact\r\n    \\*/\r\n    interact.dynamicDrop = function (newValue) {\r\n        if (isBool(newValue)) {\r\n            //if (dragging && dynamicDrop !== newValue && !newValue) {\r\n                //calcRects(dropzones);\r\n            //}\r\n\r\n            dynamicDrop = newValue;\r\n\r\n            return interact;\r\n        }\r\n        return dynamicDrop;\r\n    };\r\n\r\n    /*\\\r\n     * interact.pointerMoveTolerance\r\n     [ method ]\r\n     * Returns or sets the distance the pointer must be moved before an action\r\n     * sequence occurs. This also affects tolerance for tap events.\r\n     *\r\n     - newValue (number) #optional The movement from the start position must be greater than this value\r\n     = (number | Interactable) The current setting or interact\r\n    \\*/\r\n    interact.pointerMoveTolerance = function (newValue) {\r\n        if (isNumber(newValue)) {\r\n            pointerMoveTolerance = newValue;\r\n\r\n            return this;\r\n        }\r\n\r\n        return pointerMoveTolerance;\r\n    };\r\n\r\n    /*\\\r\n     * interact.maxInteractions\r\n     [ method ]\r\n     **\r\n     * Returns or sets the maximum number of concurrent interactions allowed.\r\n     * By default only 1 interaction is allowed at a time (for backwards\r\n     * compatibility). To allow multiple interactions on the same Interactables\r\n     * and elements, you need to enable it in the draggable, resizable and\r\n     * gesturable `'max'` and `'maxPerElement'` options.\r\n     **\r\n     - newValue (number) #optional Any number. newValue <= 0 means no interactions.\r\n    \\*/\r\n    interact.maxInteractions = function (newValue) {\r\n        if (isNumber(newValue)) {\r\n            maxInteractions = newValue;\r\n\r\n            return this;\r\n        }\r\n\r\n        return maxInteractions;\r\n    };\r\n\r\n    interact.createSnapGrid = function (grid) {\r\n        return function (x, y) {\r\n            var offsetX = 0,\r\n                offsetY = 0;\r\n\r\n            if (isObject(grid.offset)) {\r\n                offsetX = grid.offset.x;\r\n                offsetY = grid.offset.y;\r\n            }\r\n\r\n            var gridx = Math.round((x - offsetX) / grid.x),\r\n                gridy = Math.round((y - offsetY) / grid.y),\r\n\r\n                newX = gridx * grid.x + offsetX,\r\n                newY = gridy * grid.y + offsetY;\r\n\r\n            return {\r\n                x: newX,\r\n                y: newY,\r\n                range: grid.range\r\n            };\r\n        };\r\n    };\r\n\r\n    function endAllInteractions (event) {\r\n        for (var i = 0; i < interactions.length; i++) {\r\n            interactions[i].pointerEnd(event, event);\r\n        }\r\n    }\r\n\r\n    function listenToDocument (doc) {\r\n        if (contains(documents, doc)) { return; }\r\n\r\n        var win = doc.defaultView || doc.parentWindow;\r\n\r\n        // add delegate event listener\r\n        for (var eventType in delegatedEvents) {\r\n            events.add(doc, eventType, delegateListener);\r\n            events.add(doc, eventType, delegateUseCapture, true);\r\n        }\r\n\r\n        if (PointerEvent) {\r\n            if (PointerEvent === win.MSPointerEvent) {\r\n                pEventTypes = {\r\n                    up: 'MSPointerUp', down: 'MSPointerDown', over: 'mouseover',\r\n                    out: 'mouseout', move: 'MSPointerMove', cancel: 'MSPointerCancel' };\r\n            }\r\n            else {\r\n                pEventTypes = {\r\n                    up: 'pointerup', down: 'pointerdown', over: 'pointerover',\r\n                    out: 'pointerout', move: 'pointermove', cancel: 'pointercancel' };\r\n            }\r\n\r\n            events.add(doc, pEventTypes.down  , listeners.selectorDown );\r\n            events.add(doc, pEventTypes.move  , listeners.pointerMove  );\r\n            events.add(doc, pEventTypes.over  , listeners.pointerOver  );\r\n            events.add(doc, pEventTypes.out   , listeners.pointerOut   );\r\n            events.add(doc, pEventTypes.up    , listeners.pointerUp    );\r\n            events.add(doc, pEventTypes.cancel, listeners.pointerCancel);\r\n\r\n            // autoscroll\r\n            events.add(doc, pEventTypes.move, listeners.autoScrollMove);\r\n        }\r\n        else {\r\n            events.add(doc, 'mousedown', listeners.selectorDown);\r\n            events.add(doc, 'mousemove', listeners.pointerMove );\r\n            events.add(doc, 'mouseup'  , listeners.pointerUp   );\r\n            events.add(doc, 'mouseover', listeners.pointerOver );\r\n            events.add(doc, 'mouseout' , listeners.pointerOut  );\r\n\r\n            events.add(doc, 'touchstart' , listeners.selectorDown );\r\n            events.add(doc, 'touchmove'  , listeners.pointerMove  );\r\n            events.add(doc, 'touchend'   , listeners.pointerUp    );\r\n            events.add(doc, 'touchcancel', listeners.pointerCancel);\r\n\r\n            // autoscroll\r\n            events.add(doc, 'mousemove', listeners.autoScrollMove);\r\n            events.add(doc, 'touchmove', listeners.autoScrollMove);\r\n        }\r\n\r\n        events.add(win, 'blur', endAllInteractions);\r\n\r\n        try {\r\n            if (win.frameElement) {\r\n                var parentDoc = win.frameElement.ownerDocument,\r\n                    parentWindow = parentDoc.defaultView;\r\n\r\n                events.add(parentDoc   , 'mouseup'      , listeners.pointerEnd);\r\n                events.add(parentDoc   , 'touchend'     , listeners.pointerEnd);\r\n                events.add(parentDoc   , 'touchcancel'  , listeners.pointerEnd);\r\n                events.add(parentDoc   , 'pointerup'    , listeners.pointerEnd);\r\n                events.add(parentDoc   , 'MSPointerUp'  , listeners.pointerEnd);\r\n                events.add(parentWindow, 'blur'         , endAllInteractions );\r\n            }\r\n        }\r\n        catch (error) {\r\n            interact.windowParentError = error;\r\n        }\r\n\r\n        // prevent native HTML5 drag on interact.js target elements\r\n        events.add(doc, 'dragstart', function (event) {\r\n            for (var i = 0; i < interactions.length; i++) {\r\n                var interaction = interactions[i];\r\n\r\n                if (interaction.element\r\n                    && (interaction.element === event.target\r\n                        || nodeContains(interaction.element, event.target))) {\r\n\r\n                    interaction.checkAndPreventDefault(event, interaction.target, interaction.element);\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n\r\n        if (events.useAttachEvent) {\r\n            // For IE's lack of Event#preventDefault\r\n            events.add(doc, 'selectstart', function (event) {\r\n                var interaction = interactions[0];\r\n\r\n                if (interaction.currentAction()) {\r\n                    interaction.checkAndPreventDefault(event);\r\n                }\r\n            });\r\n\r\n            // For IE's bad dblclick event sequence\r\n            events.add(doc, 'dblclick', doOnInteractions('ie8Dblclick'));\r\n        }\r\n\r\n        documents.push(doc);\r\n    }\r\n\r\n    listenToDocument(document);\r\n\r\n    function indexOf (array, target) {\r\n        for (var i = 0, len = array.length; i < len; i++) {\r\n            if (array[i] === target) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        return -1;\r\n    }\r\n\r\n    function contains (array, target) {\r\n        return indexOf(array, target) !== -1;\r\n    }\r\n\r\n    function matchesSelector (element, selector, nodeList) {\r\n        if (ie8MatchesSelector) {\r\n            return ie8MatchesSelector(element, selector, nodeList);\r\n        }\r\n\r\n        // remove /deep/ from selectors if shadowDOM polyfill is used\r\n        if (window !== realWindow) {\r\n            selector = selector.replace(/\\/deep\\//g, ' ');\r\n        }\r\n\r\n        return element[prefixedMatchesSelector](selector);\r\n    }\r\n\r\n    function matchesUpTo (element, selector, limit) {\r\n        while (isElement(element)) {\r\n            if (matchesSelector(element, selector)) {\r\n                return true;\r\n            }\r\n\r\n            element = parentElement(element);\r\n\r\n            if (element === limit) {\r\n                return matchesSelector(element, selector);\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    // For IE8's lack of an Element#matchesSelector\r\n    // taken from http://tanalin.com/en/blog/2012/12/matches-selector-ie8/ and modified\r\n    if (!(prefixedMatchesSelector in Element.prototype) || !isFunction(Element.prototype[prefixedMatchesSelector])) {\r\n        ie8MatchesSelector = function (element, selector, elems) {\r\n            elems = elems || element.parentNode.querySelectorAll(selector);\r\n\r\n            for (var i = 0, len = elems.length; i < len; i++) {\r\n                if (elems[i] === element) {\r\n                    return true;\r\n                }\r\n            }\r\n\r\n            return false;\r\n        };\r\n    }\r\n\r\n    // requestAnimationFrame polyfill\r\n    (function() {\r\n        var lastTime = 0,\r\n            vendors = ['ms', 'moz', 'webkit', 'o'];\r\n\r\n        for(var x = 0; x < vendors.length && !realWindow.requestAnimationFrame; ++x) {\r\n            reqFrame = realWindow[vendors[x]+'RequestAnimationFrame'];\r\n            cancelFrame = realWindow[vendors[x]+'CancelAnimationFrame'] || realWindow[vendors[x]+'CancelRequestAnimationFrame'];\r\n        }\r\n\r\n        if (!reqFrame) {\r\n            reqFrame = function(callback) {\r\n                var currTime = new Date().getTime(),\r\n                    timeToCall = Math.max(0, 16 - (currTime - lastTime)),\r\n                    id = setTimeout(function() { callback(currTime + timeToCall); },\r\n                  timeToCall);\r\n                lastTime = currTime + timeToCall;\r\n                return id;\r\n            };\r\n        }\r\n\r\n        if (!cancelFrame) {\r\n            cancelFrame = function(id) {\r\n                clearTimeout(id);\r\n            };\r\n        }\r\n    }());\r\n\r\n    /* global exports: true, module, define */\r\n\r\n    // http://documentcloud.github.io/underscore/docs/underscore.html#section-11\r\n    if (typeof exports !== 'undefined') {\r\n        if (typeof module !== 'undefined' && module.exports) {\r\n            exports = module.exports = interact;\r\n        }\r\n        exports.interact = interact;\r\n    }\r\n    // AMD\r\n    else if (typeof define === 'function' && define.amd) {\r\n        define('interact', function() {\r\n            return interact;\r\n        });\r\n    }\r\n    else {\r\n        realWindow.interact = interact;\r\n    }\r\n\r\n} (typeof window === 'undefined'? undefined : window));","import {inject} from 'aurelia-framework';\r\nimport {PictureService} from '../../services/picture-service';\r\nimport * as interact from './interact';\r\n\r\n@inject(PictureService)\r\nexport class PictureTest {\r\n\r\n    pictureUrl = '';\r\n    isLoaded = false;\r\n    \r\n    constructor(pictureService) {\r\n        this.pictureService = pictureService;\r\n    }\r\n\r\n    created() {\r\n        console.log(interact.interact);\r\n        interact.interact('#dragTest')\r\n                .draggable({\r\n                    // enable inertial throwing\r\n                    inertia: true,\r\n                    // keep the element within the area of it's parent\r\n                    restrict: {\r\n                        restriction: \"parent\",\r\n                        endOnly: true,\r\n                        elementRect: { top: -0.1, left: -0.1, bottom: 1.1, right: 1.1 }\r\n                    },\r\n                    // enable autoScroll\r\n                    autoScroll: true,\r\n                    // call this function on every dragmove event\r\n                    onmove: this.dragMoveListener,\r\n                    // call this function on every dragend event\r\n                    onend: function (event) {\r\n                    var textEl = event.target.querySelector('p');\r\n                        textEl && (textEl.textContent =\r\n                            'moved a distance of '\r\n                            + (Math.sqrt(event.dx * event.dx +\r\n                                        event.dy * event.dy)|0) + 'px');\r\n                    }\r\n                })\r\n                .resizable({\r\n                    preserveAspectRatio: true,\r\n                    edges: { left: true, right: true, bottom: true, top: true }\r\n                })\r\n                .on('resizemove', function (event) {\r\n                    var target = event.target,\r\n                        x = (parseFloat(target.getAttribute('data-x')) || 0),\r\n                        y = (parseFloat(target.getAttribute('data-y')) || 0);\r\n\r\n                    // update the element's style\r\n                    target.style.width  = event.rect.width + 'px';\r\n                    target.style.height = event.rect.height + 'px';\r\n\r\n                    // translate when resizing from top or left edges\r\n                    x += event.deltaRect.left;\r\n                    y += event.deltaRect.top;\r\n\r\n                    target.style.webkitTransform = target.style.transform =\r\n                        'translate(' + x + 'px,' + y + 'px)';\r\n\r\n                    target.setAttribute('data-x', x);\r\n                    target.setAttribute('data-y', y);\r\n                    target.textContent = Math.round(event.rect.width) + '' + Math.round(event.rect.height);\r\n                });\r\n    }\r\n\r\n    test() {\r\n        this.pictureService.getPicture('testFrame', false).then(\r\n            (success) => {\r\n                console.log('SUCCESS');\r\n                console.log(success);\r\n                var response = JSON.parse(success.response);\r\n                this.pictureUrl = response.imageUrl;\r\n                this.isLoaded = true;\r\n            },\r\n            (failure) => {\r\n                console.log('FAILURE');\r\n                console.log(failure);\r\n            }\r\n        )\r\n    }\r\n    \r\n    dragMoveListener(event) {\r\n        // console.log(event);\r\n      var target = event.target,\r\n          // keep the dragged position in the data-x/data-y attributes\r\n          x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx,\r\n          y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;\r\n\r\n      // translate the element\r\n      target.style.webkitTransform =\r\n          target.style.transform =\r\n          'translate(' + x + 'px, ' + y + 'px)';\r\n\r\n      // update the posiion attributes\r\n      target.setAttribute('data-x', x);\r\n      target.setAttribute('data-y', y);\r\n  }\r\n}","import {inject} from 'aurelia-framework';\r\nimport {PictureService} from '../../services/picture-service';\r\n\r\n@inject(PictureService)\r\nexport class PictureUpload {\r\n    constructor(pictureService) {\r\n        this.pictureService = pictureService;\r\n    }\r\n\r\n    doUpload() {\r\n        this.pictureService.putPicture('test-file-upload', this.selectedFiles[0], 'png').then(\r\n            (success) => {\r\n                console.log(success);\r\n            },\r\n            (failure) => {\r\n                console.log(failure);\r\n            }\r\n        );\r\n    }\r\n\r\n     clearFiles() {\r\n        document.getElementById(\"files\").value = \"\";\r\n    }\r\n}","import {inject} from 'aurelia-framework';\r\nimport {UserService} from '../../services/user-service';\r\n\r\n@inject(UserService)\r\nexport class UserList {\r\n    constructor(userService) {\r\n        this.userService = userService;\r\n        // this.users = [];\r\n        this.error = {};\r\n        this.isWorking = false;\r\n    }\r\n\r\n    created() {\r\n        this.updateUserList(0, 10);\r\n    }\r\n\r\n    updateUserList(page, size) {\r\n        this.isWorking = true;\r\n        this.userService.getUsers(page, size)\r\n                .then(\r\n                    userResponse => {\r\n                        this.users = JSON.parse(userResponse.response);\r\n                        this.isWorking = false;\r\n                    }, \r\n                    errorResponse => {\r\n                        this.error.title = 'Ups';\r\n                        this.error.description = 'Parece que el sistema no response, por favor intenta nuevamente mas tarde.';\r\n                        this.isWorking = false;\r\n                    }\r\n                );\r\n    }\r\n\r\n}","import {inject, NewInstance} from 'aurelia-framework';\r\nimport {EventAggregator} from 'aurelia-event-aggregator';\r\nimport {ValidationController, validateTrigger, ValidationRules} from 'aurelia-validation';\r\nimport {SessionService} from '../../services/session-service';\r\nimport environment from '../../environment';\r\n\r\n@inject(SessionService, NewInstance.of(ValidationController), EventAggregator)\r\nexport class UserLogin {\r\n    \r\n    email = '';\r\n    password = '';\r\n\r\n    constructor(sessionService, validationController, eventAggregator) {\r\n        this.sessionService = sessionService;\r\n        this.validationController = validationController;\r\n        this.eventAggregator = eventAggregator;\r\n        this.resetFields();\r\n    }\r\n\r\n    created() {\r\n        console.log(modalId);\r\n    }\r\n\r\n    resetFields() {\r\n        this.isWorking = false;\r\n        this.success = false;\r\n        this.serverError = {};\r\n        this.email = '';\r\n        this.password = '';\r\n    }\r\n\r\n    created() {\r\n        this.validationController.validateTrigger = validateTrigger.manual;\r\n\r\n        ValidationRules\r\n            .ensure(\"email\").email().required().withMessage(\"Por favor ingrese un email.\")\r\n            .ensure(\"password\").required().withMessage(\"Por favor ingrese la contrasea.\")\r\n            .on(this);\r\n    }\r\n\r\n    login() {\r\n        this.validationController.validate().then((validation) => {\r\n            if(validation.valid) {\r\n                this.doLogin();\r\n            }\r\n        });\r\n    }\r\n\r\n    doLogin() {\r\n        this.isWorking = true;\r\n\r\n        var userCredentials = { \r\n            username: this.email, \r\n            password: this.password\r\n        }\r\n\r\n        this.sessionService.login(userCredentials).then(result => {\r\n            if(result) {\r\n                this.success = true;\r\n                setTimeout(() => {\r\n                    $(\"#userLoginModal\").modal(\"hide\");\r\n                    this.resetFields();\r\n                }, 1500);\r\n            } else {\r\n                this.resetFields();\r\n                this.success = false;\r\n                this.serverError = {\r\n                    title: \"Error\",\r\n                    description: \"Email o contrasea incorrectos.\"\r\n                }\r\n                this.isWorking = false;\r\n            }\r\n        });\r\n    }\r\n}","import { inject, NewInstance } from 'aurelia-framework';\r\nimport { ValidationController, validateTrigger, ValidationRules } from 'aurelia-validation';\r\nimport { RestService } from '../../services/rest-service';\r\nimport environment from '../../environment';\r\n\r\n@inject(RestService, NewInstance.of(ValidationController))\r\nexport class UserRegistration {\r\n\r\n    firstName = '';\r\n    lastName = '';\r\n    email = '';\r\n    password = '';\r\n\r\n    constructor(restService, validationController) {\r\n        this.restService = restService;\r\n        this.validationController = validationController;\r\n        this.isWorking = false;\r\n        this.success = false;\r\n        this.serverError = {};\r\n    }\r\n\r\n    created() {\r\n        this.validationController.validateTrigger = validateTrigger.manual;\r\n\r\n        ValidationRules\r\n            .ensure(\"firstName\").required().withMessage(\"El nombre no puede estar vacio.\")\r\n            .ensure(\"lastName\").required().withMessage(\"El apellido no puede estar vacio.\")\r\n            .ensure(\"email\").email().required().withMessage(\"El email no es valido, por favor ingrese un email valido.\")\r\n            .ensure(\"password\").minLength(8).required().withMessage(\"La contrasea debe tener al menos 8 caracteres\")\r\n            .on(this);\r\n    }\r\n\r\n    register() {\r\n        this.success = false;\r\n        this.isWorking = true;\r\n\r\n        var user = {\r\n            firstName: this.firstName,\r\n            lastName: this.lastName,\r\n            email: this.email,\r\n            password: this.password\r\n        }\r\n\r\n        this.postUser(user);\r\n    }\r\n\r\n    postUser(user) {\r\n        return this.restService.getClient()\r\n            .createRequest(environment.webApiUserRegistrationPath)\r\n            .asPost()\r\n            .withContent(user)\r\n            .send()\r\n            .then(\r\n            () => {\r\n                this.success = true;\r\n            },\r\n            failure => {\r\n                var failureMessage = JSON.parse(failure.response);\r\n                this.serverError = {\r\n                    title: failureMessage.title,\r\n                    description: failureMessage.description\r\n                };\r\n            }\r\n            ).then(() => this.isWorking = false);\r\n    }\r\n\r\n}","import {inject} from 'aurelia-framework';\r\nimport {FrameService} from '../frame-service';\r\nimport {PictureService} from '../../picture/picture-service';\r\n\r\n@inject(FrameService, PictureService)\r\nexport class FrameGallery {\r\n    constructor(frameService, pictureService) {\r\n        this.frameService = frameService;\r\n        this.pictureService = pictureService;\r\n        this.frames = [];\r\n        this.framesPerRow = 6;\r\n        this.error = {};\r\n        this.isWorking = false;\r\n    }\r\n\r\n    created() {\r\n        this.updateFrameList(0, 10);\r\n    }\r\n\r\n    updateFrameList(page, size) {\r\n        this.isWorking = true;\r\n        this.frameService.getFrames(page, size).then(\r\n            frames => {\r\n                this.frames = frames;\r\n                this.frameRows = Math.ceil(this.frames.length / this.framesPerRow);\r\n                this.frames.forEach((frame) => {\r\n                    this.pictureService.getPicture(frame.picture.imageKey, false).then(\r\n                        (picture) => {\r\n                            frame.picture = picture;\r\n                        },\r\n                        (failure) => {\r\n                            console.log(failure);\r\n                        }\r\n                    );\r\n                }, this);\r\n                this.isWorking = false;\r\n            }, \r\n            errorResponse => {\r\n                this.error.title = 'Ups';\r\n                this.error.description = 'Parece que el sistema no response, por favor intenta nuevamente mas tarde.';\r\n                this.isWorking = false;\r\n            }\r\n        );\r\n    }\r\n}","import {bindable} from 'aurelia-framework';\r\n\r\nexport class FrameThumbnail {\r\n\r\n    @bindable frame;\r\n\r\n    constructor() {\r\n    }\r\n\r\n    created() {\r\n    }\r\n    \r\n    attached() {\r\n        \r\n    }\r\n\r\n    setHasLoaded() {\r\n        this.hasLoaded = true;\r\n    }\r\n\r\n}","import {inject} from 'aurelia-framework';\r\nimport {FrameService} from '../frame-service';\r\n\r\n@inject(FrameService)\r\nexport class FrameList {\r\n    constructor(frameService) {\r\n        this.frameService = frameService;\r\n        this.frames = [];\r\n        this.isWorking = false;\r\n    }\r\n\r\n    created() {\r\n        this.updateFrameList(0,10);\r\n    }\r\n\r\n    updateFrameList(page, size) {\r\n        this.isWorking = true;\r\n        this.frameService.getFrames(page, size).then(\r\n            frameResponse => {\r\n                this.frames = frameResponse;\r\n                this.error = null;\r\n                this.isWorking = false;\r\n            }, \r\n            errorResponse => {\r\n                this.error = {\r\n                    title: 'Ups',\r\n                    description: 'Parece que el sistema no response, por favor intenta nuevamente mas tarde.'\r\n                };\r\n                this.isWorking = false;\r\n            }\r\n        );\r\n    }\r\n}","export class LoginModal {\r\n    \r\n}","import { inject } from 'aurelia-framework';\r\nimport { EventAggregator } from 'aurelia-event-aggregator';\r\nimport { SessionService } from '../../services/session-service';\r\nimport environment from '../../environment';\r\n\r\n@inject(EventAggregator, SessionService)\r\nexport class NavBar {\r\n\r\n    authenticated = false;\r\n    user = {};\r\n\r\n    constructor(eventAggregator, sessionService) {\r\n\t\tthis.eventAggregator = eventAggregator;\r\n        this.sessionService = sessionService;\r\n\r\n\t\tthis.subscribeToAuthenticationEvent();\r\n        this.sessionService.init();\r\n    }\r\n\r\n    subscribeToAuthenticationEvent() {\r\n        console.log(\"subscribed for session events\");\r\n        this.eventAggregator.subscribe(environment.authenticationChangedEventName, authState => {\r\n\t\t\tthis.authenticated = authState.authenticated;\r\n            console.log(authState);\r\n\t\t});\r\n\r\n        this.eventAggregator.subscribe(environment.currentUserRetrievedEventName, user => {\r\n\t\t\tthis.user = user;\r\n            console.log(user);\r\n\t\t});\r\n    }\r\n\r\n    logout() {\r\n        this.sessionService.logout();\r\n    }\r\n}","export class RegistrationModal {\r\n    \r\n}","import {inject} from 'aurelia-framework';\r\nimport {MattypeService} from '../mattype-service';\r\n\r\n@inject(MattypeService)\r\nexport class MattypeList {\r\n    constructor(mattypeService) {\r\n        this.mattypeService = mattypeService;\r\n        this.mattypes = [];\r\n        this.isWorking = false;\r\n    }\r\n\r\n    created() {\r\n        this.updateMattypeList(0,10);\r\n    }\r\n\r\n    updateMattypeList(page, size) {\r\n        this.isWorking = true;\r\n        this.mattypeService.getMattypes(page, size).then(\r\n            mattypeResponse => {\r\n                this.mattypes = mattypeResponse;\r\n                this.error = null;\r\n                this.isWorking = false;\r\n            }, \r\n            errorResponse => {\r\n                this.error = {\r\n                    title: 'Ups',\r\n                    description: 'Parece que el sistema no response, por favor intenta nuevamente mas tarde.'\r\n                };\r\n                this.isWorking = false;\r\n            }\r\n        );\r\n    }\r\n}","import {inject} from 'aurelia-framework';\r\nimport {UserService} from '../user-service';\r\n\r\n@inject(UserService)\r\nexport class UserList {\r\n    pageSize = 10;\r\n    currentPage = 0;\r\n\r\n    hasPreviousPage = false;\r\n    hasNextPage = true;\r\n\r\n    constructor(userService) {\r\n        this.userService = userService;\r\n    }\r\n\r\n    created() {\r\n        this.loadPage(this.currentPage);\r\n    }\r\n\r\n    loadPage(page = 0) {\r\n        this.working = true;\r\n        this.userService.getUsersCount().then(\r\n            count => {\r\n                this.doLoadPage(page, count);\r\n            },\r\n            failue => {\r\n                this.fail(failure);\r\n            }\r\n        )\r\n    }\r\n\r\n    doLoadPage(page = 0, count) {\r\n        this.userService.getUsers(page, this.pageSize).then(\r\n            users => {\r\n                this.users = users;\r\n                this.hasNextPage = (count > ((page + 1) * this.pageSize));\r\n                this.hasPreviousPage = page > 0;\r\n                this.currentPage = page;\r\n            },\r\n            failure => {\r\n                this.fail(failure);\r\n            }\r\n        ).then(() => this.working = true);\r\n    }\r\n\r\n    fail(failure) {\r\n        console.log(failure);\r\n        this.error = {};\r\n        this.error.title = 'Ups';\r\n        this.error.description = 'Parece que el sistema no response, por favor intenta nuevamente mas tarde.';\r\n    }\r\n\r\n}"],"sourceRoot":".."}
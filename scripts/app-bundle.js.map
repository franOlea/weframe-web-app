{"version":3,"sources":["src/app.js","src/environment.js","src/main.js","src/layouts/frame-admin-panel-layout.js","src/resources/index.js","src/services/frame-service.js","src/services/picture-service.js","src/services/rest-service.js","src/services/user-service.js","src/components/frame/frame-detail-modal.js","src/components/frame/frame-gallery.js","src/components/frame/frame-list.js","src/components/frame/frame-thumbnail.js","src/components/frame/frame-update-data-form.js","src/components/frame/frame-upload-form.js","src/components/picture/canvas-test.js","src/components/picture/interact.js","src/components/picture/picture-test.js","src/components/picture/picture-upload.js","src/components/user/user-list.js","src/components/user/user-login.js","src/components/user/user-registration.js","src/layouts/main/nav-bar.js","src/layouts/main/login-modal.js","src/layouts/main/registration-modal.js","src/services/session.js","src/services/session-service.js"],"names":["App","configureRouter","config","router","title","map","route","moduleId","name","debug","testing","webApiUrl","webApiUsersPath","webApiPicturesPath","webApiFramesPath","configure","aurelia","use","standardConfiguration","feature","plugin","developmentLogging","start","then","setRoot","FrameAdminPanelLayout","FrameService","restClient","getFrames","pageNumber","pageSize","createRequest","asGet","withBaseUrl","withTimeout","send","getFrame","id","postFrame","frame","asPost","withContent","deleteFrame","asDelete","PictureService","getPicture","uniquePictureName","isOriginalSize","withParams","uniqueName","original","putPicture","file","formatName","onProgress","formData","FormData","append","withProgressCallback","evt","console","log","RestService","httpClient","x","setAuthorizationHeader","authorizationHeader","withHeader","UserService","getUsers","getUser","postUser","user","FrameDetailModal","FrameGallery","frameService","pictureService","frames","framesPerRow","error","isWorking","created","updateFrameList","page","size","concat","JSON","parse","frameResponse","response","frameRows","Math","ceil","length","forEach","picture","imageKey","pictureResponse","failure","description","FrameList","showDetails","frameId","selectedFrame","success","imageUrl","frameDetailsViewModel","stringify","FrameThumbnail","attached","setHasLoaded","hasLoaded","FrameUpdateDataForm","of","validationController","serverError","validateTrigger","manual","ensure","required","withMessage","satisfies","value","on","upload","imageFiles","validate","validation","valid","setTimeout","FrameUploadForm","doUpload","imageUniqueName","imageFormatName","doUploadFrame","failureMessage","height","width","price","CanvasTest","rangeVal","showVal","recolor","rgbToHsl","drawImage","ctx","canvas","getContext","img","Image","crossOrigin","onload","src","colorshift","imgData","getImageData","data","i","red","green","blue","alpha","hsl","hue","h","newRgb","hslToRgb","s","l","r","g","b","putImageData","max","min","d","hue2rgb","p","q","t","round","realWindow","window","el","document","createTextNode","ownerDocument","wrap","DocumentFragment","blank","SVGElement","SVGSVGElement","SVGElementInstance","HTMLElement","Element","PointerEvent","MSPointerEvent","pEventTypes","hypot","y","sqrt","tmpXY","documents","interactables","interactions","dynamicDrop","delegatedEvents","defaultOptions","base","accept","actionChecker","styleCursor","preventDefault","origin","deltaSource","allowFrom","ignoreFrom","_context","dropChecker","drag","enabled","manualStart","Infinity","maxPerElement","snap","restrict","inertia","autoScroll","axis","drop","overlap","resize","square","preserveAspectRatio","margin","NaN","edges","invert","gesture","perAction","endOnly","range","targets","offsets","relativePoints","container","speed","resistance","minSpeed","endSpeed","allowResume","zeroResumeDelta","smoothEndDuration","_holdDuration","interaction","scroll","options","target","prepared","getWindow","element","now","Date","getTime","dtx","prevTimeX","dty","prevTimeY","vx","vy","sx","sy","velocity","isWindow","scrollBy","scrollLeft","scrollTop","isScrolling","cancelFrame","reqFrame","stop","supportsTouch","DocumentTouch","supportsPointerEvent","pointerMoveTolerance","prevTouchTime","maxInteractions","actionCursors","all","atob","resizex","resizey","resizexy","resizetop","resizeleft","resizebottom","resizeright","resizetopleft","resizebottomright","resizetopright","resizebottomleft","actionIsEnabled","wheelEvent","eventTypes","globalEvents","isOperaMobile","navigator","appName","userAgent","match","isIOS7","test","platform","appVersion","prefixedMatchesSelector","prototype","ie8MatchesSelector","requestAnimationFrame","cancelAnimationFrame","events","useAttachEvent","addEvent","removeEvent","elements","attachedListeners","add","type","listener","useCapture","elementIndex","indexOf","typeCount","push","supplied","wrapped","useCount","contains","ret","listeners","listenerIndex","event","immediatePropagationStopped","srcElement","currentTarget","preventDef","stopPropagation","stopProp","stopImmediatePropagation","stopImmProp","pageX","clientX","documentElement","pageY","clientY","Boolean","remove","hasOwnProperty","len","splice","returnValue","cancelBubble","_elements","_targets","_attachedListeners","isElement","o","_window","nodeType","nodeName","thing","Window","isDocFrag","isArray","isObject","undefined","isFunction","isNumber","isBool","isString","trySelector","querySelector","extend","dest","source","prop","prefixedPropREs","webkit","pointerExtend","deprecated","vendor","copyCoords","client","timeStamp","setEventXY","targetObj","pointers","pointer","pointerAverage","getPageXY","getClientXY","setEventDeltas","prev","cur","dt","isNativePointer","Event","Touch","getXY","xy","scrollX","scrollY","getScrollXY","win","getPointerId","pointerId","identifier","getActualElement","correspondingUseElement","node","rootNode","defaultView","parentWindow","getElementClientRect","clientRect","getBoundingClientRect","getClientRects","left","right","top","bottom","getElementRect","getTouchPair","touches","changedTouches","average","screenX","screenY","touchBBox","minX","minY","maxX","maxY","touchDistance","sourceX","sourceY","dx","dy","touchAngle","prevAngle","angle","atan","PI","dr","drClamped","getOriginXY","interactable","parentElement","getRect","closest","_getQBezierValue","p1","p2","p3","iT","getQuadraticCurvePoint","startX","startY","cpX","cpY","endX","endY","position","easeOutQuad","c","nodeContains","parent","child","parentNode","selector","matchesSelector","host","inContext","testIgnore","interactableElement","matchesUpTo","testAllow","checkAxis","thisAxis","checkSnap","action","checkRestrict","checkAutoScroll","withinInteractionLimit","maxActions","activeInteractions","targetCount","targetElementCount","otherAction","active","interacting","indexOfDeepestElement","dropzone","deepestZone","index","deepestZoneParents","dropzoneParents","n","unshift","ownerSVGElement","parents","lastChild","previousSibling","Interaction","dropTarget","dropElement","prevDropTarget","prevDropElement","matches","matchElements","inertiaStatus","smoothEnd","ending","startEvent","upCoords","xe","ye","t0","vx0","vys","duration","resumeDx","resumeDy","lambda_v0","one_ve_v0","Function","bind","boundInertiaFrame","inertiaFrame","boundSmoothEndFrame","smoothEndFrame","that","activeDrops","dropzones","rects","pointerIds","downTargets","downTimes","holdTimers","prevCoords","curCoords","startCoords","pointerDelta","downEvent","downPointer","_eventTarget","_curEventTarget","prevEvent","tapTime","prevTap","startOffset","restrictOffset","snapOffsets","startDistance","prevDistance","distance","scale","startAngle","snapStatus","realX","realY","snappedX","snappedY","locked","changed","restrictStatus","restrictedX","restrictedY","restricted","pointerIsDown","pointerWasMoved","gesturing","dragging","resizing","resizeAxes","mouse","ptr","pointerOver","eventTarget","curMatches","curMatchElements","prevTargetElement","addPointer","elementInteractable","get","elementAction","validateAction","getAction","pushCurMatches","forEachSelector","validateSelector","pointerHover","move","curEventTarget","_doc","style","cursor","getActionCursor","checkAndPreventDefault","pointerOut","selectorDown","eventCopy","pointerIndex","pointerHold","collectEventTargets","pushMatches","context","querySelectorAll","pointerDown","forceAction","_element","newAction","setModifications","coords","preEnd","shouldMove","shouldSnap","shouldRestrict","setSnapping","setRestriction","setStartOffsets","rect","snapOffset","offset","elementRect","pointerMove","pageUp","clientUp","inertiaPosition","recordPointer","duplicateMove","clearTimeout","InteractEvent","absX","abs","absY","targetAxis","thisInteraction","getDraggable","selectorInteractable","starting","autoScrollMove","dragStart","dragEvent","fire","setActiveDrops","dropEvents","getDropEvents","activate","fireActiveDrops","dragMove","draggableElement","getDrop","leave","enter","resizeStart","resizeEvent","startRect","linkedEdges","_linkedEdges","resizeStartAspectRatio","resizeRects","current","previous","delta","deltaRect","resizeMove","invertible","originalEdges","swap","edge","gestureStart","gestureEvent","ds","gestureMove","isNaN","pointerUp","pointerEnd","removePointer","pointerCancel","ie8Dblclick","endEvent","inertiaOptions","pointerSpeed","inertiaPossible","endSnap","endRestrict","snapRestrict","vy0","v0","calcInertia","statusObject","useStatusXY","modifiedXe","modifiedYe","deactivate","collectDrops","drops","dropElements","j","currentElement","prevElement","dragElement","possibleDrops","validDrops","dropCheck","dropIndex","pointerEvent","relatedTarget","draggable","dragLeave","prevDropzone","dragEnter","dragmove","currentAction","clearTargets","lambda","te","progress","exp","quadPoint","eventType","collectSelectors","els","_iEvents","interact","isSet","firePointers","interval","createNewDoubleTap","preventOriginalDefault","originalEvent","originalPointer","pointerType","double","propagationStopped","doubleTap","matchElement","pageCoords","status","relIndex","relative","inRange","snapChanged","restriction","prevent","inertiaDur","x0","y0","innerWidth","innerHeight","_updateEventTargets","getInteractionFromPointer","mouseEvent","doOnInteractions","method","path","phase","related","clientX0","clientY0","ctrlKey","altKey","shiftKey","metaKey","button","buttons","detail","axes","box","da","prevScale","velocityX","velocityY","atan2","up","down","swipe","cursorKey","edgeNames","checkResizeEdge","defaultActionChecker","shouldResize","resizeEdges","resizeOptions","actionName","interactionListeners","delegateListener","fakeEvent","delegated","selectors","contexts","delegateUseCapture","call","indexOfElement","interactableGet","callback","Interactable","Node","listenToDocument","set","setOnEvents","phases","ondrop","ondropactivate","ondropdeactivate","ondragenter","ondragleave","ondropmove","onstart","onmove","onend","oninertiastart","setPerAction","option","checker","dropped","dropOverlap","horizontal","vertical","dragRect","cx","cy","overlapArea","overlapRatio","newValue","resizable","squareResize","gesturable","actions","setOptions","thisOption","mode","createSnapGrid","gridOffset","grid","anchors","paths","elementOrigin","allActions","rectCheck","rectChecker","iEvent","onEvent","funcName","search","trim","split","off","eventList","matchFound","fn","useCap","methods","perActions","settings","setting","unset","warnOnce","message","warned","warn","apply","arguments","enableDragging","enableResizing","enableGesturing","downTime","getPointerAverage","getTouchBBox","getTouchDistance","getTouchAngle","newvalue","offsetX","offsetY","gridx","gridy","newX","newY","endAllInteractions","doc","over","out","cancel","frameElement","parentDoc","windowParentError","array","nodeList","replace","limit","elems","lastTime","vendors","currTime","timeToCall","exports","module","define","amd","PictureTest","pictureUrl","isLoaded","dragMoveListener","textEl","textContent","parseFloat","getAttribute","webkitTransform","transform","setAttribute","PictureUpload","selectedFiles","clearFiles","getElementById","UserList","userService","updateUserList","users","userResponse","UserLogin","email","password","login","userCredentials","UserRegistration","firstName","lastName","minLength","register","NavBar","LoginModal","RegistrationModal","SessionService","setCookie","cname","cvalue","exdays","setTime","expires","toUTCString","cookie","getCookie","ca","charAt","substring","cookieName","cookieValue","expirationDays","date","setDate","getDate","nameEQ"],"mappings":"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","file":"app-bundle.js","sourcesContent":["export class App {\n\tconfigureRouter(config, router) {\n\t\tconfig.title = 'WeFrame';\n\t\tconfig.map([\n\t\t\t{\n\t\t\t\troute: ['', '/'],\n\t\t\t\tmoduleId: './components/frame/frame-gallery',\n\t\t\t\ttitle: 'Marcos',\n\t\t\t\tname: 'index'\n\t\t\t},\n\t\t\t{\n\t\t\t\troute: 'frame-admin-list',\n\t\t\t\tmoduleId: './components/frame/frame-list',\n\t\t\t\ttitle: 'Panel de administrador',\n\t\t\t\tname: 'frame-admin-list'\n\t\t\t},\n\t\t\t{\n\t\t\t\troute: 'frame-admin',\n\t\t\t\tmoduleId: './layouts/frame-admin-panel-layout',\n\t\t\t\ttitle: 'Panel de administrador',\n\t\t\t\tname: 'frame-admin'\n\t\t\t},\n\t\t\t{\n\t\t\t\troute: 'user-admin-list',\n\t\t\t\tmoduleId: './components/user/user-list',\n\t\t\t\ttitle: 'Panel de administrador',\n\t\t\t\tname: 'user-admin-list'\n\t\t\t}\n\t\t]);\n\n\t\tthis.router = router;\n\t}\n}\n","export default {\n  debug: true,\n  testing: true,\n  webApiUrl: 'http://weframers-franolea.rhcloud.com',\n  webApiUsersPath: 'users',\n  webApiPicturesPath: 'pictures',\n  webApiFramesPath: 'frames'\n};\n","import environment from './environment';\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources')\n    .plugin('aurelia-validation');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","export class FrameAdminPanelLayout {\r\n    \r\n}","export function configure(config) {\n  //config.globalResources([]);\n}\n","import {HttpClient} from 'aurelia-http-client';\r\nimport environment from '../environment';\r\n\r\nexport class FrameService {\r\n    constructor() {\r\n        this.restClient = new HttpClient();\r\n    }\r\n\r\n    getFrames(pageNumber, pageSize) {\r\n        return this.restClient.createRequest(environment.webApiFramesPath)\r\n                .asGet()\r\n                .withBaseUrl(environment.webApiUrl)\r\n                .withTimeout(5000)\r\n                .send()\r\n    }\r\n\r\n    getFrame(id) {\r\n        return this.restClient.createRequest(environment.webApiFramesPath + `/${id}`)\r\n                .asGet()\r\n                .withBaseUrl(environment.webApiUrl)\r\n                .withTimeout(2000)\r\n                .send()\r\n    }\r\n\r\n    postFrame(frame) {\r\n        return this.restClient.createRequest(environment.webApiFramesPath)\r\n                .asPost()\r\n                .withBaseUrl(environment.webApiUrl)\r\n                .withContent(frame)\r\n                .withTimeout(3000)\r\n                .send()\r\n    }\r\n\r\n    deleteFrame(id) {\r\n        return this.restClient.createRequest(environment.webApiFramesPath)\r\n                .asDelete()\r\n                .withBaseUrl(environment.webApiUrl)\r\n                .withTimeout(3000)\r\n                .send();\r\n    }\r\n}","import {HttpClient} from 'aurelia-http-client';\r\nimport environment from '../environment';\r\n\r\nexport class PictureService {\r\n    constructor() {\r\n        this.restClient = new HttpClient();\r\n    }\r\n\r\n    getPicture(uniquePictureName, isOriginalSize) {\r\n        return this.restClient.createRequest(environment.webApiPicturesPath)\r\n                .asGet()\r\n                .withParams({\r\n                    uniqueName: uniquePictureName,\r\n                    original: isOriginalSize\r\n                })\r\n                .withBaseUrl(environment.webApiUrl)\r\n                .withTimeout(5000)\r\n                .send();\r\n    }\r\n\r\n    putPicture(uniqueName, file, formatName, onProgress) {\r\n        var formData = new FormData();\r\n        formData.append('uniqueName', uniqueName);\r\n        formData.append('file', file);\r\n        formData.append('formatName', formatName);\r\n\r\n        return this.restClient.createRequest(environment.webApiPicturesPath)\r\n            .asPost()\r\n            .withContent(formData)\r\n            .withBaseUrl(environment.webApiUrl)\r\n            .withProgressCallback((evt)=>console.log(evt))\r\n            .send();\r\n    }\r\n}","import { HttpClient } from 'aurelia-http-client';\r\nimport environment from '../environment';\r\n\r\nexport class RestService {\r\n    constructor() {\r\n        this.httpClient = new HttpClient()\r\n            .configure(x => {\r\n                x.withBaseUrl(environment.webApiUrl);\r\n                // x.withHeader('Authorization', 'bearer 123');\r\n            });\r\n    }\r\n\r\n    setAuthorizationHeader(authorizationHeader) {\r\n        this.httpClient\r\n            .configure(x => {\r\n                x.withHeader('Authorization', authorizationHeader);\r\n            });\r\n    }\r\n}","import {HttpClient} from 'aurelia-http-client';\r\nimport environment from '../environment';\r\n\r\nexport class UserService {\r\n    constructor() {\r\n        this.restClient = new HttpClient();\r\n    }\r\n\r\n    getUsers() {\r\n        return getUsers(0, 10);\r\n    }\r\n\r\n    getUsers(pageNumber, pageSize) {\r\n        return this.restClient.createRequest(environment.webApiUsersPath)\r\n                .asGet()\r\n                .withBaseUrl(environment.webApiUrl)\r\n                .withTimeout(5000)\r\n                .send()\r\n    }\r\n\r\n    getUser(id) {\r\n        return this.restClient.createRequest(environment.webApiUsersPath + `/${id}`)\r\n                .asGet()\r\n                .withBaseUrl(environment.webApiUrl)\r\n                .withTimeout(2000)\r\n                .send()\r\n    }\r\n\r\n    postUser(user) {\r\n        return this.restClient.createRequest(environment.webApiUsersPath)\r\n                .asPost()\r\n                .withBaseUrl(environment.webApiUrl)\r\n                .withContent(user)\r\n                .withTimeout(3000)\r\n                .send()\r\n    }\r\n\r\n}","import {bindable} from 'aurelia-framework';\r\nimport {inject} from 'aurelia-framework';\r\n\r\nexport class FrameDetailModal {\r\n    \r\n    // @bindable frame;\r\n\r\n    constructor() {\r\n    }\r\n}","import {inject} from 'aurelia-framework';\r\nimport {FrameService} from '../../services/frame-service';\r\nimport {PictureService} from '../../services/picture-service';\r\n\r\n@inject(FrameService, PictureService)\r\nexport class FrameGallery {\r\n    constructor(frameService, pictureService) {\r\n        this.frameService = frameService;\r\n        this.pictureService = pictureService;\r\n        this.frames = [];\r\n        this.framesPerRow = 6;\r\n        this.error = {};\r\n        this.isWorking = false;\r\n    }\r\n\r\n    created() {\r\n        this.updateFrameList(0,10);\r\n    }\r\n\r\n    updateFrameList(page, size) {\r\n        this.isWorking = true;\r\n        this.frameService.getFrames(page, size).then(\r\n            frameResponse => {\r\n                this.frames = this.frames.concat(JSON.parse(frameResponse.response));\r\n                this.frameRows = Math.ceil(this.frames.length / this.framesPerRow);\r\n                this.frames.forEach((frame) => {\r\n                    this.pictureService.getPicture(frame.picture.imageKey, false).then(\r\n                        (pictureResponse) => {\r\n                            frame.picture = JSON.parse(pictureResponse.response);\r\n                        },\r\n                        (failure) => {\r\n                            console.log(failure);\r\n                        }\r\n                    );\r\n                }, this);\r\n                this.isWorking = false;\r\n            }, \r\n            errorResponse => {\r\n                this.error.title = 'Ups';\r\n                this.error.description = 'Parece que el sistema no response, por favor intenta nuevamente mas tarde.';\r\n                this.isWorking = false;\r\n            }\r\n        );\r\n    }\r\n}","import {inject} from 'aurelia-framework';\r\nimport {FrameService} from '../../services/frame-service';\r\nimport {PictureService} from '../../services/picture-service';\r\n\r\n@inject(FrameService, PictureService)\r\nexport class FrameList {\r\n    constructor(frameService, pictureService) {\r\n        this.frameService = frameService;\r\n        this.pictureService = pictureService;\r\n        // this.frames = [];\r\n        this.error = {};\r\n        this.isWorking = false;\r\n    }\r\n\r\n    created() {\r\n        this.updateFrameList(0,10);\r\n    }\r\n\r\n    updateFrameList(page, size) {\r\n        this.isWorking = true;\r\n        this.frameService.getFrames(page, size)\r\n                .then(\r\n                    frameResponse => {\r\n                        this.frames = JSON.parse(frameResponse.response);\r\n                        this.isWorking = false;\r\n                    }, \r\n                    errorResponse => {\r\n                        this.error.title = 'Ups';\r\n                        this.error.description = 'Parece que el sistema no response, por favor intenta nuevamente mas tarde.';\r\n                        this.isWorking = false;\r\n                    }\r\n                );\r\n    }\r\n\r\n    showDetails(frameId) {\r\n        this.frames.forEach(function(frame) {\r\n            if(frame.id == frameId) {\r\n                this.selectedFrame = frame;\r\n                this.pictureService.getPicture(this.selectedFrame.picture.imageKey, true).then(\r\n                    (success) => {\r\n                        this.selectedFrame.picture.imageUrl = JSON.parse(success.response).imageUrl;\r\n                        this.frameDetailsViewModel.frame = JSON.parse(JSON.stringify(this.selectedFrame));\r\n                        console.log(this.frameDetailsViewModel);\r\n                    },\r\n                    (failure) => {\r\n                        console.log(failure);\r\n                    }\r\n                )\r\n            }\r\n        }, this);\r\n    }\r\n}","import {bindable} from 'aurelia-framework';\r\n\r\nexport class FrameThumbnail {\r\n\r\n    @bindable frame;\r\n\r\n    constructor() {\r\n    }\r\n\r\n    created() {\r\n    }\r\n    \r\n    attached() {\r\n        \r\n    }\r\n\r\n    setHasLoaded() {\r\n        this.hasLoaded = true;\r\n    }\r\n\r\n}","import {bindable} from 'aurelia-framework';\r\nimport {inject, NewInstance} from 'aurelia-framework';\r\nimport {ValidationController, validateTrigger, ValidationRules} from 'aurelia-validation';\r\nimport {FrameService} from '../../services/frame-service';\r\n\r\n@inject(FrameService,NewInstance.of(ValidationController))\r\nexport class FrameUpdateDataForm {\r\n    \r\n    @bindable frame;\r\n\r\n    constructor(frameService, validationController) {\r\n        this.frameService = frameService;\r\n        this.validationController = validationController;\r\n        this.isWorking = false;\r\n        this.success = false;\r\n        this.serverError = {};\r\n    }\r\n\r\n    created() {\r\n        this.validationController.validateTrigger = validateTrigger.manual;\r\n\r\n        ValidationRules\r\n            .ensure(\"frame.name\")\r\n                    .required()\r\n                    .withMessage(\"El nombre unico no puede estar vacio.\")\r\n            .ensure(\"frame.description\")\r\n                    .required()\r\n                    .withMessage(\"La descripcion no puede estar vacia.\")\r\n            .ensure(\"frame.height\")\r\n                    .required()\r\n                    .satisfies(value => value > 0)\r\n                    .withMessage(\"El alto del marco no puede estar vacio o ser menor a 0.\")\r\n            .ensure(\"frame.length\")\r\n                    .required()\r\n                    .satisfies(value => value > 0)\r\n                    .withMessage(\"El ancho del marco no puede estar vacio o ser menor a 0.\")\r\n            .ensure(\"frame.prive\")\r\n                    .required()\r\n                    .satisfies(value => value > 0)\r\n                    .withMessage(\"El precio del marco no puede estar vacio o ser menor a 0.\")\r\n            .on(this);\r\n    }\r\n\r\n    upload() {\r\n        this.success = false;\r\n        this.isWorking = true;\r\n\r\n        console.log(this.imageFiles);\r\n\r\n        this.validationController.validate().then((validation) => {\r\n            if(validation.valid) {\r\n                // this.doUpload();\r\n                setTimeout(() => {\r\n                    this.success = true;\r\n                }, 1000).then(() => this.isWorking = false);\r\n            } else {\r\n                this.isWorking = false\r\n            }\r\n        });\r\n    }\r\n\r\n}","import {inject, NewInstance} from 'aurelia-framework';\r\nimport {ValidationController, validateTrigger, ValidationRules} from 'aurelia-validation';\r\nimport {PictureService} from '../../services/picture-service';\r\nimport {FrameService} from '../../services/frame-service';\r\n\r\n@inject(PictureService,FrameService,NewInstance.of(ValidationController))\r\nexport class FrameUploadForm {\r\n\r\n    constructor(pictureService, frameService, validationController) {\r\n        this.pictureService = pictureService;\r\n        this.frameService = frameService;\r\n        this.validationController = validationController;\r\n        this.isWorking = false;\r\n        this.success = false;\r\n        this.serverError = {};\r\n    }\r\n\r\n    created() {\r\n        this.validationController.validateTrigger = validateTrigger.manual;\r\n\r\n        ValidationRules\r\n            .ensure(\"name\")\r\n                    .required()\r\n                    .withMessage(\"El nombre unico no puede estar vacio.\")\r\n            .ensure(\"uniqueName\")\r\n                    .required()\r\n                    .withMessage(\"El nombre unico no puede estar vacio.\")\r\n            .ensure(\"imageUniqueName\")\r\n                    .required()\r\n                    .withMessage(\"El nombre unico de la imagen no puede estar vacio.\")\r\n            .ensure(\"imageFile\")\r\n                    .required()\r\n                    .withMessage(\"El archivo no puede estar vacio.\")\r\n            .ensure(\"imageFormatName\")\r\n                    .required()\r\n                    .withMessage(\"El nombre del formato de archivo de imagen no puede estar vacio.\")\r\n            .on(this);\r\n    }\r\n\r\n    upload() {\r\n        this.success = false;\r\n        this.isWorking = true;\r\n\r\n        console.log(this.imageFiles);\r\n\r\n        this.validationController.validate().then((validation) => {\r\n            if(validation.valid) {\r\n                this.doUpload();\r\n                // setTimeout(() => {\r\n                //     this.success = true;\r\n                // }, 1000).then(() => this.isWorking = false);\r\n            } else {\r\n                this.isWorking = false\r\n            }\r\n        });\r\n    }\r\n\r\n    doUpload() {\r\n        return this.pictureService.putPicture(\r\n            this.imageUniqueName,\r\n            this.imageFiles[0],\r\n            this.imageFormatName,\r\n            null)\r\n            .then(\r\n                () => {\r\n                    this.doUploadFrame();\r\n                },\r\n                failure => {\r\n                    var failureMessage = JSON.parse(failure.response);\r\n                    this.serverError = {\r\n                        title: failureMessage.title,\r\n                        description: failureMessage.description\r\n                    };\r\n                }\r\n            );\r\n    }\r\n\r\n    doUploadFrame() {\r\n        var frame = {\r\n            name: this.name,\r\n            uniqueName: this.uniqueName,\r\n            description: this.description,\r\n            height: this.height,\r\n            length: this.width,\r\n            picture: {\r\n                imageKey: this.imageUniqueName\r\n            },\r\n            price: this.price\r\n        };\r\n\r\n        this.frameService.postFrame(frame).then(\r\n            () => {\r\n                this.success = true;\r\n            },\r\n            failure => {\r\n                var failureMessage = JSON.parse(failure.response);\r\n                this.serverError = {\r\n                    title: failureMessage.title,\r\n                    description: failureMessage.description\r\n                };\r\n            }\r\n        ).then(() => this.isWorking = false);\r\n    }\r\n\r\n}","import {inject} from 'aurelia-framework';\r\nimport {PictureService} from '../../services/picture-service';\r\n\r\n@inject(PictureService)\r\nexport class CanvasTest {\r\n    constructor(pictureService) {\r\n        this.pictureService = pictureService;\r\n        this.rangeVal = 0;\r\n    }\r\n\r\n    showVal() {\r\n        // console.log(this.rangeVal);\r\n        this.recolor(this.rangeVal);\r\n    }\r\n\r\n    created() {\r\n        console.log(this.rgbToHsl(0,0,0));\r\n        console.log(this.rgbToHsl(255,255,0));\r\n        console.log(this.rgbToHsl(255,255,255));\r\n        this.pictureService.getPicture('testPicture', false).then(\r\n            (success) => {\r\n                console.log('SUCCESS');\r\n                console.log(success);\r\n                var response = JSON.parse(success.response);\r\n                this.drawImage(response.imageUrl);\r\n            },\r\n            (failure) => {\r\n                console.log('FAILURE');\r\n                console.log(failure);\r\n            }\r\n        )\r\n    }\r\n\r\n    drawImage(imageUrl) {\r\n        this.ctx = this.canvas.getContext(\"2d\");\r\n        \r\n        var img = new Image();\r\n        img.crossOrigin = \"anonymous\";\r\n        img.onload = () => {\r\n            this.ctx.drawImage(img, 0, 0, 600, 400);\r\n            this.ctx.drawImage(img, 0, 400, 600, 400);\r\n            // shift blueish colors to greenish colors\r\n            this.recolor(.33);\r\n        };\r\n        img.src = imageUrl;\r\n    }\r\n\r\n    recolor(colorshift) {\r\n        var imgData = this.ctx.getImageData(0, 0, 600, 400);\r\n        var data = imgData.data;\r\n\r\n        for (var i = 0; i < data.length; i += 4) {\r\n            var red = data[i + 0];\r\n            var green = data[i + 1];\r\n            var blue = data[i + 2];\r\n            var alpha = data[i + 3];\r\n\r\n            // skip transparent/semiTransparent pixels\r\n            if (alpha < 200) {\r\n                continue;\r\n            }\r\n\r\n            var hsl = this.rgbToHsl(red, green, blue);\r\n            var hue = hsl.h * 360;\r\n\r\n            // change blueish pixels to the new color\r\n            if (hue > 200 && hue < 300) {\r\n                var newRgb = this.hslToRgb(hsl.h + colorshift, hsl.s, hsl.l);\r\n                data[i + 0] = newRgb.r;\r\n                data[i + 1] = newRgb.g;\r\n                data[i + 2] = newRgb.b;\r\n                data[i + 3] = 255;\r\n            }\r\n        }\r\n        this.ctx.putImageData(imgData, 400, 0);\r\n    }\r\n\r\n\r\n    rgbToHsl(r, g, b) {\r\n        r /= 255, g /= 255, b /= 255;\r\n        var max = Math.max(r, g, b),\r\n            min = Math.min(r, g, b);\r\n        var h, s, l = (max + min) / 2;\r\n\r\n        if (max == min) {\r\n            h = s = 0; // achromatic\r\n        } else {\r\n            var d = max - min;\r\n            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n            switch (max) {\r\n                case r:\r\n                    h = (g - b) / d + (g < b ? 6 : 0);\r\n                    break;\r\n                case g:\r\n                    h = (b - r) / d + 2;\r\n                    break;\r\n                case b:\r\n                    h = (r - g) / d + 4;\r\n                    break;\r\n            }\r\n            h /= 6;\r\n        }\r\n\r\n        return ({\r\n            h: h,\r\n            s: s,\r\n            l: l,\r\n        });\r\n    }\r\n\r\n\r\n    hslToRgb(h, s, l) {\r\n        var r, g, b;\r\n\r\n        if (s == 0) {\r\n            r = g = b = l; // achromatic\r\n        } else {\r\n            function hue2rgb(p, q, t) {\r\n                if (t < 0) t += 1;\r\n                if (t > 1) t -= 1;\r\n                if (t < 1 / 6) return p + (q - p) * 6 * t;\r\n                if (t < 1 / 2) return q;\r\n                if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\r\n                return p;\r\n            }\r\n\r\n            var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n            var p = 2 * l - q;\r\n            r = hue2rgb(p, q, h + 1 / 3);\r\n            g = hue2rgb(p, q, h);\r\n            b = hue2rgb(p, q, h - 1 / 3);\r\n        }\r\n\r\n        return ({\r\n            r: Math.round(r * 255),\r\n            g: Math.round(g * 255),\r\n            b: Math.round(b * 255),\r\n        });\r\n    }\r\n    \r\n}","/**\r\n * interact.js v1.2.6\r\n *\r\n * Copyright (c) 2012-2015 Taye Adeyemi <dev@taye.me>\r\n * Open source under the MIT License.\r\n * https://raw.github.com/taye/interact.js/master/LICENSE\r\n */\r\n(function (realWindow) {\r\n    'use strict';\r\n\r\n    // return early if there's no window to work with (eg. Node.js)\r\n    if (!realWindow) { return; }\r\n\r\n    var // get wrapped window if using Shadow DOM polyfill\r\n        window = (function () {\r\n            // create a TextNode\r\n            var el = realWindow.document.createTextNode('');\r\n\r\n            // check if it's wrapped by a polyfill\r\n            if (el.ownerDocument !== realWindow.document\r\n                && typeof realWindow.wrap === 'function'\r\n                && realWindow.wrap(el) === el) {\r\n                // return wrapped window\r\n                return realWindow.wrap(realWindow);\r\n            }\r\n\r\n            // no Shadow DOM polyfil or native implementation\r\n            return realWindow;\r\n        }()),\r\n\r\n        document           = window.document,\r\n        DocumentFragment   = window.DocumentFragment   || blank,\r\n        SVGElement         = window.SVGElement         || blank,\r\n        SVGSVGElement      = window.SVGSVGElement      || blank,\r\n        SVGElementInstance = window.SVGElementInstance || blank,\r\n        HTMLElement        = window.HTMLElement        || window.Element,\r\n\r\n        PointerEvent = (window.PointerEvent || window.MSPointerEvent),\r\n        pEventTypes,\r\n\r\n        hypot = Math.hypot || function (x, y) { return Math.sqrt(x * x + y * y); },\r\n\r\n        tmpXY = {},     // reduce object creation in getXY()\r\n\r\n        documents       = [],   // all documents being listened to\r\n\r\n        interactables   = [],   // all set interactables\r\n        interactions    = [],   // all interactions\r\n\r\n        dynamicDrop     = false,\r\n\r\n        // {\r\n        //      type: {\r\n        //          selectors: ['selector', ...],\r\n        //          contexts : [document, ...],\r\n        //          listeners: [[listener, useCapture], ...]\r\n        //      }\r\n        //  }\r\n        delegatedEvents = {},\r\n\r\n        defaultOptions = {\r\n            base: {\r\n                accept        : null,\r\n                actionChecker : null,\r\n                styleCursor   : true,\r\n                preventDefault: 'auto',\r\n                origin        : { x: 0, y: 0 },\r\n                deltaSource   : 'page',\r\n                allowFrom     : null,\r\n                ignoreFrom    : null,\r\n                _context      : document,\r\n                dropChecker   : null\r\n            },\r\n\r\n            drag: {\r\n                enabled: false,\r\n                manualStart: true,\r\n                max: Infinity,\r\n                maxPerElement: 1,\r\n\r\n                snap: null,\r\n                restrict: null,\r\n                inertia: null,\r\n                autoScroll: null,\r\n\r\n                axis: 'xy'\r\n            },\r\n\r\n            drop: {\r\n                enabled: false,\r\n                accept: null,\r\n                overlap: 'pointer'\r\n            },\r\n\r\n            resize: {\r\n                enabled: false,\r\n                manualStart: false,\r\n                max: Infinity,\r\n                maxPerElement: 1,\r\n\r\n                snap: null,\r\n                restrict: null,\r\n                inertia: null,\r\n                autoScroll: null,\r\n\r\n                square: false,\r\n                preserveAspectRatio: false,\r\n                axis: 'xy',\r\n\r\n                // use default margin\r\n                margin: NaN,\r\n\r\n                // object with props left, right, top, bottom which are\r\n                // true/false values to resize when the pointer is over that edge,\r\n                // CSS selectors to match the handles for each direction\r\n                // or the Elements for each handle\r\n                edges: null,\r\n\r\n                // a value of 'none' will limit the resize rect to a minimum of 0x0\r\n                // 'negate' will alow the rect to have negative width/height\r\n                // 'reposition' will keep the width/height positive by swapping\r\n                // the top and bottom edges and/or swapping the left and right edges\r\n                invert: 'none'\r\n            },\r\n\r\n            gesture: {\r\n                manualStart: false,\r\n                enabled: false,\r\n                max: Infinity,\r\n                maxPerElement: 1,\r\n\r\n                restrict: null\r\n            },\r\n\r\n            perAction: {\r\n                manualStart: false,\r\n                max: Infinity,\r\n                maxPerElement: 1,\r\n\r\n                snap: {\r\n                    enabled     : false,\r\n                    endOnly     : false,\r\n                    range       : Infinity,\r\n                    targets     : null,\r\n                    offsets     : null,\r\n\r\n                    relativePoints: null\r\n                },\r\n\r\n                restrict: {\r\n                    enabled: false,\r\n                    endOnly: false\r\n                },\r\n\r\n                autoScroll: {\r\n                    enabled     : false,\r\n                    container   : null,     // the item that is scrolled (Window or HTMLElement)\r\n                    margin      : 60,\r\n                    speed       : 300       // the scroll speed in pixels per second\r\n                },\r\n\r\n                inertia: {\r\n                    enabled          : false,\r\n                    resistance       : 10,    // the lambda in exponential decay\r\n                    minSpeed         : 100,   // target speed must be above this for inertia to start\r\n                    endSpeed         : 10,    // the speed at which inertia is slow enough to stop\r\n                    allowResume      : true,  // allow resuming an action in inertia phase\r\n                    zeroResumeDelta  : true,  // if an action is resumed after launch, set dx/dy to 0\r\n                    smoothEndDuration: 300    // animate to snap/restrict endOnly if there's no inertia\r\n                }\r\n            },\r\n\r\n            _holdDuration: 600\r\n        },\r\n\r\n        // Things related to autoScroll\r\n        autoScroll = {\r\n            interaction: null,\r\n            i: null,    // the handle returned by window.setInterval\r\n            x: 0, y: 0, // Direction each pulse is to scroll in\r\n\r\n            // scroll the window by the values in scroll.x/y\r\n            scroll: function () {\r\n                var options = autoScroll.interaction.target.options[autoScroll.interaction.prepared.name].autoScroll,\r\n                    container = options.container || getWindow(autoScroll.interaction.element),\r\n                    now = new Date().getTime(),\r\n                    // change in time in seconds\r\n                    dtx = (now - autoScroll.prevTimeX) / 1000,\r\n                    dty = (now - autoScroll.prevTimeY) / 1000,\r\n                    vx, vy, sx, sy;\r\n\r\n                // displacement\r\n                if (options.velocity) {\r\n                  vx = options.velocity.x;\r\n                  vy = options.velocity.y;\r\n                }\r\n                else {\r\n                  vx = vy = options.speed\r\n                }\r\n \r\n                sx = vx * dtx;\r\n                sy = vy * dty;\r\n\r\n                if (sx >= 1 || sy >= 1) {\r\n                    if (isWindow(container)) {\r\n                        container.scrollBy(autoScroll.x * sx, autoScroll.y * sy);\r\n                    }\r\n                    else if (container) {\r\n                        container.scrollLeft += autoScroll.x * sx;\r\n                        container.scrollTop  += autoScroll.y * sy;\r\n                    }\r\n\r\n                    if (sx >=1) autoScroll.prevTimeX = now;\r\n                    if (sy >= 1) autoScroll.prevTimeY = now;\r\n                }\r\n\r\n                if (autoScroll.isScrolling) {\r\n                    cancelFrame(autoScroll.i);\r\n                    autoScroll.i = reqFrame(autoScroll.scroll);\r\n                }\r\n            },\r\n\r\n            isScrolling: false,\r\n            prevTimeX: 0,\r\n            prevTimeY: 0,\r\n\r\n            start: function (interaction) {\r\n                autoScroll.isScrolling = true;\r\n                cancelFrame(autoScroll.i);\r\n\r\n                autoScroll.interaction = interaction;\r\n                autoScroll.prevTimeX = new Date().getTime();\r\n                autoScroll.prevTimeY = new Date().getTime();\r\n                autoScroll.i = reqFrame(autoScroll.scroll);\r\n            },\r\n\r\n            stop: function () {\r\n                autoScroll.isScrolling = false;\r\n                cancelFrame(autoScroll.i);\r\n            }\r\n        },\r\n\r\n        // Does the browser support touch input?\r\n        supportsTouch = (('ontouchstart' in window) || window.DocumentTouch && document instanceof window.DocumentTouch),\r\n\r\n        // Does the browser support PointerEvents\r\n        supportsPointerEvent = !!PointerEvent,\r\n\r\n        // Less Precision with touch input\r\n        margin = supportsTouch || supportsPointerEvent? 20: 10,\r\n\r\n        pointerMoveTolerance = 1,\r\n\r\n        // for ignoring browser's simulated mouse events\r\n        prevTouchTime = 0,\r\n\r\n        // Allow this many interactions to happen simultaneously\r\n        maxInteractions = Infinity,\r\n\r\n        // Check if is IE9 or older\r\n        actionCursors = (document.all && !window.atob) ? {\r\n            drag    : 'move',\r\n            resizex : 'e-resize',\r\n            resizey : 's-resize',\r\n            resizexy: 'se-resize',\r\n\r\n            resizetop        : 'n-resize',\r\n            resizeleft       : 'w-resize',\r\n            resizebottom     : 's-resize',\r\n            resizeright      : 'e-resize',\r\n            resizetopleft    : 'se-resize',\r\n            resizebottomright: 'se-resize',\r\n            resizetopright   : 'ne-resize',\r\n            resizebottomleft : 'ne-resize',\r\n\r\n            gesture : ''\r\n        } : {\r\n            drag    : 'move',\r\n            resizex : 'ew-resize',\r\n            resizey : 'ns-resize',\r\n            resizexy: 'nwse-resize',\r\n\r\n            resizetop        : 'ns-resize',\r\n            resizeleft       : 'ew-resize',\r\n            resizebottom     : 'ns-resize',\r\n            resizeright      : 'ew-resize',\r\n            resizetopleft    : 'nwse-resize',\r\n            resizebottomright: 'nwse-resize',\r\n            resizetopright   : 'nesw-resize',\r\n            resizebottomleft : 'nesw-resize',\r\n\r\n            gesture : ''\r\n        },\r\n\r\n        actionIsEnabled = {\r\n            drag   : true,\r\n            resize : true,\r\n            gesture: true\r\n        },\r\n\r\n        // because Webkit and Opera still use 'mousewheel' event type\r\n        wheelEvent = 'onmousewheel' in document? 'mousewheel': 'wheel',\r\n\r\n        eventTypes = [\r\n            'dragstart',\r\n            'dragmove',\r\n            'draginertiastart',\r\n            'dragend',\r\n            'dragenter',\r\n            'dragleave',\r\n            'dropactivate',\r\n            'dropdeactivate',\r\n            'dropmove',\r\n            'drop',\r\n            'resizestart',\r\n            'resizemove',\r\n            'resizeinertiastart',\r\n            'resizeend',\r\n            'gesturestart',\r\n            'gesturemove',\r\n            'gestureinertiastart',\r\n            'gestureend',\r\n\r\n            'down',\r\n            'move',\r\n            'up',\r\n            'cancel',\r\n            'tap',\r\n            'doubletap',\r\n            'hold'\r\n        ],\r\n\r\n        globalEvents = {},\r\n\r\n        // Opera Mobile must be handled differently\r\n        isOperaMobile = navigator.appName == 'Opera' &&\r\n            supportsTouch &&\r\n            navigator.userAgent.match('Presto'),\r\n\r\n        // scrolling doesn't change the result of getClientRects on iOS 7\r\n        isIOS7 = (/iP(hone|od|ad)/.test(navigator.platform)\r\n                         && /OS 7[^\\d]/.test(navigator.appVersion)),\r\n\r\n        // prefix matchesSelector\r\n        prefixedMatchesSelector = 'matches' in Element.prototype?\r\n                'matches': 'webkitMatchesSelector' in Element.prototype?\r\n                    'webkitMatchesSelector': 'mozMatchesSelector' in Element.prototype?\r\n                        'mozMatchesSelector': 'oMatchesSelector' in Element.prototype?\r\n                            'oMatchesSelector': 'msMatchesSelector',\r\n\r\n        // will be polyfill function if browser is IE8\r\n        ie8MatchesSelector,\r\n\r\n        // native requestAnimationFrame or polyfill\r\n        reqFrame = realWindow.requestAnimationFrame,\r\n        cancelFrame = realWindow.cancelAnimationFrame,\r\n\r\n        // Events wrapper\r\n        events = (function () {\r\n            var useAttachEvent = ('attachEvent' in window) && !('addEventListener' in window),\r\n                addEvent       = useAttachEvent?  'attachEvent': 'addEventListener',\r\n                removeEvent    = useAttachEvent?  'detachEvent': 'removeEventListener',\r\n                on             = useAttachEvent? 'on': '',\r\n\r\n                elements          = [],\r\n                targets           = [],\r\n                attachedListeners = [];\r\n\r\n            function add (element, type, listener, useCapture) {\r\n                var elementIndex = indexOf(elements, element),\r\n                    target = targets[elementIndex];\r\n\r\n                if (!target) {\r\n                    target = {\r\n                        events: {},\r\n                        typeCount: 0\r\n                    };\r\n\r\n                    elementIndex = elements.push(element) - 1;\r\n                    targets.push(target);\r\n\r\n                    attachedListeners.push((useAttachEvent ? {\r\n                            supplied: [],\r\n                            wrapped : [],\r\n                            useCount: []\r\n                        } : null));\r\n                }\r\n\r\n                if (!target.events[type]) {\r\n                    target.events[type] = [];\r\n                    target.typeCount++;\r\n                }\r\n\r\n                if (!contains(target.events[type], listener)) {\r\n                    var ret;\r\n\r\n                    if (useAttachEvent) {\r\n                        var listeners = attachedListeners[elementIndex],\r\n                            listenerIndex = indexOf(listeners.supplied, listener);\r\n\r\n                        var wrapped = listeners.wrapped[listenerIndex] || function (event) {\r\n                            if (!event.immediatePropagationStopped) {\r\n                                event.target = event.srcElement;\r\n                                event.currentTarget = element;\r\n\r\n                                event.preventDefault = event.preventDefault || preventDef;\r\n                                event.stopPropagation = event.stopPropagation || stopProp;\r\n                                event.stopImmediatePropagation = event.stopImmediatePropagation || stopImmProp;\r\n\r\n                                if (/mouse|click/.test(event.type)) {\r\n                                    event.pageX = event.clientX + getWindow(element).document.documentElement.scrollLeft;\r\n                                    event.pageY = event.clientY + getWindow(element).document.documentElement.scrollTop;\r\n                                }\r\n\r\n                                listener(event);\r\n                            }\r\n                        };\r\n\r\n                        ret = element[addEvent](on + type, wrapped, Boolean(useCapture));\r\n\r\n                        if (listenerIndex === -1) {\r\n                            listeners.supplied.push(listener);\r\n                            listeners.wrapped.push(wrapped);\r\n                            listeners.useCount.push(1);\r\n                        }\r\n                        else {\r\n                            listeners.useCount[listenerIndex]++;\r\n                        }\r\n                    }\r\n                    else {\r\n                        ret = element[addEvent](type, listener, useCapture || false);\r\n                    }\r\n                    target.events[type].push(listener);\r\n\r\n                    return ret;\r\n                }\r\n            }\r\n\r\n            function remove (element, type, listener, useCapture) {\r\n                var i,\r\n                    elementIndex = indexOf(elements, element),\r\n                    target = targets[elementIndex],\r\n                    listeners,\r\n                    listenerIndex,\r\n                    wrapped = listener;\r\n\r\n                if (!target || !target.events) {\r\n                    return;\r\n                }\r\n\r\n                if (useAttachEvent) {\r\n                    listeners = attachedListeners[elementIndex];\r\n                    listenerIndex = indexOf(listeners.supplied, listener);\r\n                    wrapped = listeners.wrapped[listenerIndex];\r\n                }\r\n\r\n                if (type === 'all') {\r\n                    for (type in target.events) {\r\n                        if (target.events.hasOwnProperty(type)) {\r\n                            remove(element, type, 'all');\r\n                        }\r\n                    }\r\n                    return;\r\n                }\r\n\r\n                if (target.events[type]) {\r\n                    var len = target.events[type].length;\r\n\r\n                    if (listener === 'all') {\r\n                        for (i = 0; i < len; i++) {\r\n                            remove(element, type, target.events[type][i], Boolean(useCapture));\r\n                        }\r\n                        return;\r\n                    } else {\r\n                        for (i = 0; i < len; i++) {\r\n                            if (target.events[type][i] === listener) {\r\n                                element[removeEvent](on + type, wrapped, useCapture || false);\r\n                                target.events[type].splice(i, 1);\r\n\r\n                                if (useAttachEvent && listeners) {\r\n                                    listeners.useCount[listenerIndex]--;\r\n                                    if (listeners.useCount[listenerIndex] === 0) {\r\n                                        listeners.supplied.splice(listenerIndex, 1);\r\n                                        listeners.wrapped.splice(listenerIndex, 1);\r\n                                        listeners.useCount.splice(listenerIndex, 1);\r\n                                    }\r\n                                }\r\n\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if (target.events[type] && target.events[type].length === 0) {\r\n                        target.events[type] = null;\r\n                        target.typeCount--;\r\n                    }\r\n                }\r\n\r\n                if (!target.typeCount) {\r\n                    targets.splice(elementIndex, 1);\r\n                    elements.splice(elementIndex, 1);\r\n                    attachedListeners.splice(elementIndex, 1);\r\n                }\r\n            }\r\n\r\n            function preventDef () {\r\n                this.returnValue = false;\r\n            }\r\n\r\n            function stopProp () {\r\n                this.cancelBubble = true;\r\n            }\r\n\r\n            function stopImmProp () {\r\n                this.cancelBubble = true;\r\n                this.immediatePropagationStopped = true;\r\n            }\r\n\r\n            return {\r\n                add: add,\r\n                remove: remove,\r\n                useAttachEvent: useAttachEvent,\r\n\r\n                _elements: elements,\r\n                _targets: targets,\r\n                _attachedListeners: attachedListeners\r\n            };\r\n        }());\r\n\r\n    function blank () {}\r\n\r\n    function isElement (o) {\r\n        if (!o || (typeof o !== 'object')) { return false; }\r\n\r\n        var _window = getWindow(o) || window;\r\n\r\n        return (/object|function/.test(typeof _window.Element)\r\n            ? o instanceof _window.Element //DOM2\r\n            : o.nodeType === 1 && typeof o.nodeName === \"string\");\r\n    }\r\n    function isWindow (thing) { return thing === window || !!(thing && thing.Window) && (thing instanceof thing.Window); }\r\n    function isDocFrag (thing) { return !!thing && thing instanceof DocumentFragment; }\r\n    function isArray (thing) {\r\n        return isObject(thing)\r\n                && (typeof thing.length !== undefined)\r\n                && isFunction(thing.splice);\r\n    }\r\n    function isObject   (thing) { return !!thing && (typeof thing === 'object'); }\r\n    function isFunction (thing) { return typeof thing === 'function'; }\r\n    function isNumber   (thing) { return typeof thing === 'number'  ; }\r\n    function isBool     (thing) { return typeof thing === 'boolean' ; }\r\n    function isString   (thing) { return typeof thing === 'string'  ; }\r\n\r\n    function trySelector (value) {\r\n        if (!isString(value)) { return false; }\r\n\r\n        // an exception will be raised if it is invalid\r\n        document.querySelector(value);\r\n        return true;\r\n    }\r\n\r\n    function extend (dest, source) {\r\n        for (var prop in source) {\r\n            dest[prop] = source[prop];\r\n        }\r\n        return dest;\r\n    }\r\n\r\n    var prefixedPropREs = {\r\n      webkit: /(Movement[XY]|Radius[XY]|RotationAngle|Force)$/\r\n    };\r\n\r\n    function pointerExtend (dest, source) {\r\n        for (var prop in source) {\r\n          var deprecated = false;\r\n\r\n          // skip deprecated prefixed properties\r\n          for (var vendor in prefixedPropREs) {\r\n            if (prop.indexOf(vendor) === 0 && prefixedPropREs[vendor].test(prop)) {\r\n              deprecated = true;\r\n              break;\r\n            }\r\n          }\r\n\r\n          if (!deprecated) {\r\n            dest[prop] = source[prop];\r\n          }\r\n        }\r\n        return dest;\r\n    }\r\n\r\n    function copyCoords (dest, src) {\r\n        dest.page = dest.page || {};\r\n        dest.page.x = src.page.x;\r\n        dest.page.y = src.page.y;\r\n\r\n        dest.client = dest.client || {};\r\n        dest.client.x = src.client.x;\r\n        dest.client.y = src.client.y;\r\n\r\n        dest.timeStamp = src.timeStamp;\r\n    }\r\n\r\n    function setEventXY (targetObj, pointers, interaction) {\r\n        var pointer = (pointers.length > 1\r\n                       ? pointerAverage(pointers)\r\n                       : pointers[0]);\r\n\r\n        getPageXY(pointer, tmpXY, interaction);\r\n        targetObj.page.x = tmpXY.x;\r\n        targetObj.page.y = tmpXY.y;\r\n\r\n        getClientXY(pointer, tmpXY, interaction);\r\n        targetObj.client.x = tmpXY.x;\r\n        targetObj.client.y = tmpXY.y;\r\n\r\n        targetObj.timeStamp = new Date().getTime();\r\n    }\r\n\r\n    function setEventDeltas (targetObj, prev, cur) {\r\n        targetObj.page.x     = cur.page.x      - prev.page.x;\r\n        targetObj.page.y     = cur.page.y      - prev.page.y;\r\n        targetObj.client.x   = cur.client.x    - prev.client.x;\r\n        targetObj.client.y   = cur.client.y    - prev.client.y;\r\n        targetObj.timeStamp = new Date().getTime() - prev.timeStamp;\r\n\r\n        // set pointer velocity\r\n        var dt = Math.max(targetObj.timeStamp / 1000, 0.001);\r\n        targetObj.page.speed   = hypot(targetObj.page.x, targetObj.page.y) / dt;\r\n        targetObj.page.vx      = targetObj.page.x / dt;\r\n        targetObj.page.vy      = targetObj.page.y / dt;\r\n\r\n        targetObj.client.speed = hypot(targetObj.client.x, targetObj.page.y) / dt;\r\n        targetObj.client.vx    = targetObj.client.x / dt;\r\n        targetObj.client.vy    = targetObj.client.y / dt;\r\n    }\r\n\r\n    function isNativePointer (pointer) {\r\n        return (pointer instanceof window.Event\r\n            || (supportsTouch && window.Touch && pointer instanceof window.Touch));\r\n    }\r\n\r\n    // Get specified X/Y coords for mouse or event.touches[0]\r\n    function getXY (type, pointer, xy) {\r\n        xy = xy || {};\r\n        type = type || 'page';\r\n\r\n        xy.x = pointer[type + 'X'];\r\n        xy.y = pointer[type + 'Y'];\r\n\r\n        return xy;\r\n    }\r\n\r\n    function getPageXY (pointer, page) {\r\n        page = page || {};\r\n\r\n        // Opera Mobile handles the viewport and scrolling oddly\r\n        if (isOperaMobile && isNativePointer(pointer)) {\r\n            getXY('screen', pointer, page);\r\n\r\n            page.x += window.scrollX;\r\n            page.y += window.scrollY;\r\n        }\r\n        else {\r\n            getXY('page', pointer, page);\r\n        }\r\n\r\n        return page;\r\n    }\r\n\r\n    function getClientXY (pointer, client) {\r\n        client = client || {};\r\n\r\n        if (isOperaMobile && isNativePointer(pointer)) {\r\n            // Opera Mobile handles the viewport and scrolling oddly\r\n            getXY('screen', pointer, client);\r\n        }\r\n        else {\r\n          getXY('client', pointer, client);\r\n        }\r\n\r\n        return client;\r\n    }\r\n\r\n    function getScrollXY (win) {\r\n        win = win || window;\r\n        return {\r\n            x: win.scrollX || win.document.documentElement.scrollLeft,\r\n            y: win.scrollY || win.document.documentElement.scrollTop\r\n        };\r\n    }\r\n\r\n    function getPointerId (pointer) {\r\n        return isNumber(pointer.pointerId)? pointer.pointerId : pointer.identifier;\r\n    }\r\n\r\n    function getActualElement (element) {\r\n        return (element instanceof SVGElementInstance\r\n            ? element.correspondingUseElement\r\n            : element);\r\n    }\r\n\r\n    function getWindow (node) {\r\n        if (isWindow(node)) {\r\n            return node;\r\n        }\r\n\r\n        var rootNode = (node.ownerDocument || node);\r\n\r\n        return rootNode.defaultView || rootNode.parentWindow || window;\r\n    }\r\n\r\n    function getElementClientRect (element) {\r\n        var clientRect = (element instanceof SVGElement\r\n                            ? element.getBoundingClientRect()\r\n                            : element.getClientRects()[0]);\r\n\r\n        return clientRect && {\r\n            left  : clientRect.left,\r\n            right : clientRect.right,\r\n            top   : clientRect.top,\r\n            bottom: clientRect.bottom,\r\n            width : clientRect.width || clientRect.right - clientRect.left,\r\n            height: clientRect.height || clientRect.bottom - clientRect.top\r\n        };\r\n    }\r\n\r\n    function getElementRect (element) {\r\n        var clientRect = getElementClientRect(element);\r\n\r\n        if (!isIOS7 && clientRect) {\r\n            var scroll = getScrollXY(getWindow(element));\r\n\r\n            clientRect.left   += scroll.x;\r\n            clientRect.right  += scroll.x;\r\n            clientRect.top    += scroll.y;\r\n            clientRect.bottom += scroll.y;\r\n        }\r\n\r\n        return clientRect;\r\n    }\r\n\r\n    function getTouchPair (event) {\r\n        var touches = [];\r\n\r\n        // array of touches is supplied\r\n        if (isArray(event)) {\r\n            touches[0] = event[0];\r\n            touches[1] = event[1];\r\n        }\r\n        // an event\r\n        else {\r\n            if (event.type === 'touchend') {\r\n                if (event.touches.length === 1) {\r\n                    touches[0] = event.touches[0];\r\n                    touches[1] = event.changedTouches[0];\r\n                }\r\n                else if (event.touches.length === 0) {\r\n                    touches[0] = event.changedTouches[0];\r\n                    touches[1] = event.changedTouches[1];\r\n                }\r\n            }\r\n            else {\r\n                touches[0] = event.touches[0];\r\n                touches[1] = event.touches[1];\r\n            }\r\n        }\r\n\r\n        return touches;\r\n    }\r\n\r\n    function pointerAverage (pointers) {\r\n        var average = {\r\n            pageX  : 0,\r\n            pageY  : 0,\r\n            clientX: 0,\r\n            clientY: 0,\r\n            screenX: 0,\r\n            screenY: 0\r\n        };\r\n        var prop;\r\n\r\n        for (var i = 0; i < pointers.length; i++) {\r\n            for (prop in average) {\r\n                average[prop] += pointers[i][prop];\r\n            }\r\n        }\r\n        for (prop in average) {\r\n            average[prop] /= pointers.length;\r\n        }\r\n\r\n        return average;\r\n    }\r\n\r\n    function touchBBox (event) {\r\n        if (!event.length && !(event.touches && event.touches.length > 1)) {\r\n            return;\r\n        }\r\n\r\n        var touches = getTouchPair(event),\r\n            minX = Math.min(touches[0].pageX, touches[1].pageX),\r\n            minY = Math.min(touches[0].pageY, touches[1].pageY),\r\n            maxX = Math.max(touches[0].pageX, touches[1].pageX),\r\n            maxY = Math.max(touches[0].pageY, touches[1].pageY);\r\n\r\n        return {\r\n            x: minX,\r\n            y: minY,\r\n            left: minX,\r\n            top: minY,\r\n            width: maxX - minX,\r\n            height: maxY - minY\r\n        };\r\n    }\r\n\r\n    function touchDistance (event, deltaSource) {\r\n        deltaSource = deltaSource || defaultOptions.deltaSource;\r\n\r\n        var sourceX = deltaSource + 'X',\r\n            sourceY = deltaSource + 'Y',\r\n            touches = getTouchPair(event);\r\n\r\n\r\n        var dx = touches[0][sourceX] - touches[1][sourceX],\r\n            dy = touches[0][sourceY] - touches[1][sourceY];\r\n\r\n        return hypot(dx, dy);\r\n    }\r\n\r\n    function touchAngle (event, prevAngle, deltaSource) {\r\n        deltaSource = deltaSource || defaultOptions.deltaSource;\r\n\r\n        var sourceX = deltaSource + 'X',\r\n            sourceY = deltaSource + 'Y',\r\n            touches = getTouchPair(event),\r\n            dx = touches[0][sourceX] - touches[1][sourceX],\r\n            dy = touches[0][sourceY] - touches[1][sourceY],\r\n            angle = 180 * Math.atan(dy / dx) / Math.PI;\r\n\r\n        if (isNumber(prevAngle)) {\r\n            var dr = angle - prevAngle,\r\n                drClamped = dr % 360;\r\n\r\n            if (drClamped > 315) {\r\n                angle -= 360 + (angle / 360)|0 * 360;\r\n            }\r\n            else if (drClamped > 135) {\r\n                angle -= 180 + (angle / 360)|0 * 360;\r\n            }\r\n            else if (drClamped < -315) {\r\n                angle += 360 + (angle / 360)|0 * 360;\r\n            }\r\n            else if (drClamped < -135) {\r\n                angle += 180 + (angle / 360)|0 * 360;\r\n            }\r\n        }\r\n\r\n        return  angle;\r\n    }\r\n\r\n    function getOriginXY (interactable, element) {\r\n        var origin = interactable\r\n                ? interactable.options.origin\r\n                : defaultOptions.origin;\r\n\r\n        if (origin === 'parent') {\r\n            origin = parentElement(element);\r\n        }\r\n        else if (origin === 'self') {\r\n            origin = interactable.getRect(element);\r\n        }\r\n        else if (trySelector(origin)) {\r\n            origin = closest(element, origin) || { x: 0, y: 0 };\r\n        }\r\n\r\n        if (isFunction(origin)) {\r\n            origin = origin(interactable && element);\r\n        }\r\n\r\n        if (isElement(origin))  {\r\n            origin = getElementRect(origin);\r\n        }\r\n\r\n        origin.x = ('x' in origin)? origin.x : origin.left;\r\n        origin.y = ('y' in origin)? origin.y : origin.top;\r\n\r\n        return origin;\r\n    }\r\n\r\n    // http://stackoverflow.com/a/5634528/2280888\r\n    function _getQBezierValue(t, p1, p2, p3) {\r\n        var iT = 1 - t;\r\n        return iT * iT * p1 + 2 * iT * t * p2 + t * t * p3;\r\n    }\r\n\r\n    function getQuadraticCurvePoint(startX, startY, cpX, cpY, endX, endY, position) {\r\n        return {\r\n            x:  _getQBezierValue(position, startX, cpX, endX),\r\n            y:  _getQBezierValue(position, startY, cpY, endY)\r\n        };\r\n    }\r\n\r\n    // http://gizma.com/easing/\r\n    function easeOutQuad (t, b, c, d) {\r\n        t /= d;\r\n        return -c * t*(t-2) + b;\r\n    }\r\n\r\n    function nodeContains (parent, child) {\r\n        while (child) {\r\n            if (child === parent) {\r\n                return true;\r\n            }\r\n\r\n            child = child.parentNode;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    function closest (child, selector) {\r\n        var parent = parentElement(child);\r\n\r\n        while (isElement(parent)) {\r\n            if (matchesSelector(parent, selector)) { return parent; }\r\n\r\n            parent = parentElement(parent);\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    function parentElement (node) {\r\n        var parent = node.parentNode;\r\n\r\n        if (isDocFrag(parent)) {\r\n            // skip past #shado-root fragments\r\n            while ((parent = parent.host) && isDocFrag(parent)) {}\r\n\r\n            return parent;\r\n        }\r\n\r\n        return parent;\r\n    }\r\n\r\n    function inContext (interactable, element) {\r\n        return interactable._context === element.ownerDocument\r\n                || nodeContains(interactable._context, element);\r\n    }\r\n\r\n    function testIgnore (interactable, interactableElement, element) {\r\n        var ignoreFrom = interactable.options.ignoreFrom;\r\n\r\n        if (!ignoreFrom || !isElement(element)) { return false; }\r\n\r\n        if (isString(ignoreFrom)) {\r\n            return matchesUpTo(element, ignoreFrom, interactableElement);\r\n        }\r\n        else if (isElement(ignoreFrom)) {\r\n            return nodeContains(ignoreFrom, element);\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    function testAllow (interactable, interactableElement, element) {\r\n        var allowFrom = interactable.options.allowFrom;\r\n\r\n        if (!allowFrom) { return true; }\r\n\r\n        if (!isElement(element)) { return false; }\r\n\r\n        if (isString(allowFrom)) {\r\n            return matchesUpTo(element, allowFrom, interactableElement);\r\n        }\r\n        else if (isElement(allowFrom)) {\r\n            return nodeContains(allowFrom, element);\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    function checkAxis (axis, interactable) {\r\n        if (!interactable) { return false; }\r\n\r\n        var thisAxis = interactable.options.drag.axis;\r\n\r\n        return (axis === 'xy' || thisAxis === 'xy' || thisAxis === axis);\r\n    }\r\n\r\n    function checkSnap (interactable, action) {\r\n        var options = interactable.options;\r\n\r\n        if (/^resize/.test(action)) {\r\n            action = 'resize';\r\n        }\r\n\r\n        return options[action].snap && options[action].snap.enabled;\r\n    }\r\n\r\n    function checkRestrict (interactable, action) {\r\n        var options = interactable.options;\r\n\r\n        if (/^resize/.test(action)) {\r\n            action = 'resize';\r\n        }\r\n\r\n        return  options[action].restrict && options[action].restrict.enabled;\r\n    }\r\n\r\n    function checkAutoScroll (interactable, action) {\r\n        var options = interactable.options;\r\n\r\n        if (/^resize/.test(action)) {\r\n            action = 'resize';\r\n        }\r\n\r\n        return  options[action].autoScroll && options[action].autoScroll.enabled;\r\n    }\r\n\r\n    function withinInteractionLimit (interactable, element, action) {\r\n        var options = interactable.options,\r\n            maxActions = options[action.name].max,\r\n            maxPerElement = options[action.name].maxPerElement,\r\n            activeInteractions = 0,\r\n            targetCount = 0,\r\n            targetElementCount = 0;\r\n\r\n        for (var i = 0, len = interactions.length; i < len; i++) {\r\n            var interaction = interactions[i],\r\n                otherAction = interaction.prepared.name,\r\n                active = interaction.interacting();\r\n\r\n            if (!active) { continue; }\r\n\r\n            activeInteractions++;\r\n\r\n            if (activeInteractions >= maxInteractions) {\r\n                return false;\r\n            }\r\n\r\n            if (interaction.target !== interactable) { continue; }\r\n\r\n            targetCount += (otherAction === action.name)|0;\r\n\r\n            if (targetCount >= maxActions) {\r\n                return false;\r\n            }\r\n\r\n            if (interaction.element === element) {\r\n                targetElementCount++;\r\n\r\n                if (otherAction !== action.name || targetElementCount >= maxPerElement) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return maxInteractions > 0;\r\n    }\r\n\r\n    // Test for the element that's \"above\" all other qualifiers\r\n    function indexOfDeepestElement (elements) {\r\n        var dropzone,\r\n            deepestZone = elements[0],\r\n            index = deepestZone? 0: -1,\r\n            parent,\r\n            deepestZoneParents = [],\r\n            dropzoneParents = [],\r\n            child,\r\n            i,\r\n            n;\r\n\r\n        for (i = 1; i < elements.length; i++) {\r\n            dropzone = elements[i];\r\n\r\n            // an element might belong to multiple selector dropzones\r\n            if (!dropzone || dropzone === deepestZone) {\r\n                continue;\r\n            }\r\n\r\n            if (!deepestZone) {\r\n                deepestZone = dropzone;\r\n                index = i;\r\n                continue;\r\n            }\r\n\r\n            // check if the deepest or current are document.documentElement or document.rootElement\r\n            // - if the current dropzone is, do nothing and continue\r\n            if (dropzone.parentNode === dropzone.ownerDocument) {\r\n                continue;\r\n            }\r\n            // - if deepest is, update with the current dropzone and continue to next\r\n            else if (deepestZone.parentNode === dropzone.ownerDocument) {\r\n                deepestZone = dropzone;\r\n                index = i;\r\n                continue;\r\n            }\r\n\r\n            if (!deepestZoneParents.length) {\r\n                parent = deepestZone;\r\n                while (parent.parentNode && parent.parentNode !== parent.ownerDocument) {\r\n                    deepestZoneParents.unshift(parent);\r\n                    parent = parent.parentNode;\r\n                }\r\n            }\r\n\r\n            // if this element is an svg element and the current deepest is\r\n            // an HTMLElement\r\n            if (deepestZone instanceof HTMLElement\r\n                && dropzone instanceof SVGElement\r\n                && !(dropzone instanceof SVGSVGElement)) {\r\n\r\n                if (dropzone === deepestZone.parentNode) {\r\n                    continue;\r\n                }\r\n\r\n                parent = dropzone.ownerSVGElement;\r\n            }\r\n            else {\r\n                parent = dropzone;\r\n            }\r\n\r\n            dropzoneParents = [];\r\n\r\n            while (parent.parentNode !== parent.ownerDocument) {\r\n                dropzoneParents.unshift(parent);\r\n                parent = parent.parentNode;\r\n            }\r\n\r\n            n = 0;\r\n\r\n            // get (position of last common ancestor) + 1\r\n            while (dropzoneParents[n] && dropzoneParents[n] === deepestZoneParents[n]) {\r\n                n++;\r\n            }\r\n\r\n            var parents = [\r\n                dropzoneParents[n - 1],\r\n                dropzoneParents[n],\r\n                deepestZoneParents[n]\r\n            ];\r\n\r\n            child = parents[0].lastChild;\r\n\r\n            while (child) {\r\n                if (child === parents[1]) {\r\n                    deepestZone = dropzone;\r\n                    index = i;\r\n                    deepestZoneParents = [];\r\n\r\n                    break;\r\n                }\r\n                else if (child === parents[2]) {\r\n                    break;\r\n                }\r\n\r\n                child = child.previousSibling;\r\n            }\r\n        }\r\n\r\n        return index;\r\n    }\r\n\r\n    function Interaction () {\r\n        this.target          = null; // current interactable being interacted with\r\n        this.element         = null; // the target element of the interactable\r\n        this.dropTarget      = null; // the dropzone a drag target might be dropped into\r\n        this.dropElement     = null; // the element at the time of checking\r\n        this.prevDropTarget  = null; // the dropzone that was recently dragged away from\r\n        this.prevDropElement = null; // the element at the time of checking\r\n\r\n        this.prepared        = {     // action that's ready to be fired on next move event\r\n            name : null,\r\n            axis : null,\r\n            edges: null\r\n        };\r\n\r\n        this.matches         = [];   // all selectors that are matched by target element\r\n        this.matchElements   = [];   // corresponding elements\r\n\r\n        this.inertiaStatus = {\r\n            active       : false,\r\n            smoothEnd    : false,\r\n            ending       : false,\r\n\r\n            startEvent: null,\r\n            upCoords: {},\r\n\r\n            xe: 0, ye: 0,\r\n            sx: 0, sy: 0,\r\n\r\n            t0: 0,\r\n            vx0: 0, vys: 0,\r\n            duration: 0,\r\n\r\n            resumeDx: 0,\r\n            resumeDy: 0,\r\n\r\n            lambda_v0: 0,\r\n            one_ve_v0: 0,\r\n            i  : null\r\n        };\r\n\r\n        if (isFunction(Function.prototype.bind)) {\r\n            this.boundInertiaFrame = this.inertiaFrame.bind(this);\r\n            this.boundSmoothEndFrame = this.smoothEndFrame.bind(this);\r\n        }\r\n        else {\r\n            var that = this;\r\n\r\n            this.boundInertiaFrame = function () { return that.inertiaFrame(); };\r\n            this.boundSmoothEndFrame = function () { return that.smoothEndFrame(); };\r\n        }\r\n\r\n        this.activeDrops = {\r\n            dropzones: [],      // the dropzones that are mentioned below\r\n            elements : [],      // elements of dropzones that accept the target draggable\r\n            rects    : []       // the rects of the elements mentioned above\r\n        };\r\n\r\n        // keep track of added pointers\r\n        this.pointers    = [];\r\n        this.pointerIds  = [];\r\n        this.downTargets = [];\r\n        this.downTimes   = [];\r\n        this.holdTimers  = [];\r\n\r\n        // Previous native pointer move event coordinates\r\n        this.prevCoords = {\r\n            page     : { x: 0, y: 0 },\r\n            client   : { x: 0, y: 0 },\r\n            timeStamp: 0\r\n        };\r\n        // current native pointer move event coordinates\r\n        this.curCoords = {\r\n            page     : { x: 0, y: 0 },\r\n            client   : { x: 0, y: 0 },\r\n            timeStamp: 0\r\n        };\r\n\r\n        // Starting InteractEvent pointer coordinates\r\n        this.startCoords = {\r\n            page     : { x: 0, y: 0 },\r\n            client   : { x: 0, y: 0 },\r\n            timeStamp: 0\r\n        };\r\n\r\n        // Change in coordinates and time of the pointer\r\n        this.pointerDelta = {\r\n            page     : { x: 0, y: 0, vx: 0, vy: 0, speed: 0 },\r\n            client   : { x: 0, y: 0, vx: 0, vy: 0, speed: 0 },\r\n            timeStamp: 0\r\n        };\r\n\r\n        this.downEvent   = null;    // pointerdown/mousedown/touchstart event\r\n        this.downPointer = {};\r\n\r\n        this._eventTarget    = null;\r\n        this._curEventTarget = null;\r\n\r\n        this.prevEvent = null;      // previous action event\r\n        this.tapTime   = 0;         // time of the most recent tap event\r\n        this.prevTap   = null;\r\n\r\n        this.startOffset    = { left: 0, right: 0, top: 0, bottom: 0 };\r\n        this.restrictOffset = { left: 0, right: 0, top: 0, bottom: 0 };\r\n        this.snapOffsets    = [];\r\n\r\n        this.gesture = {\r\n            start: { x: 0, y: 0 },\r\n\r\n            startDistance: 0,   // distance between two touches of touchStart\r\n            prevDistance : 0,\r\n            distance     : 0,\r\n\r\n            scale: 1,           // gesture.distance / gesture.startDistance\r\n\r\n            startAngle: 0,      // angle of line joining two touches\r\n            prevAngle : 0       // angle of the previous gesture event\r\n        };\r\n\r\n        this.snapStatus = {\r\n            x       : 0, y       : 0,\r\n            dx      : 0, dy      : 0,\r\n            realX   : 0, realY   : 0,\r\n            snappedX: 0, snappedY: 0,\r\n            targets : [],\r\n            locked  : false,\r\n            changed : false\r\n        };\r\n\r\n        this.restrictStatus = {\r\n            dx         : 0, dy         : 0,\r\n            restrictedX: 0, restrictedY: 0,\r\n            snap       : null,\r\n            restricted : false,\r\n            changed    : false\r\n        };\r\n\r\n        this.restrictStatus.snap = this.snapStatus;\r\n\r\n        this.pointerIsDown   = false;\r\n        this.pointerWasMoved = false;\r\n        this.gesturing       = false;\r\n        this.dragging        = false;\r\n        this.resizing        = false;\r\n        this.resizeAxes      = 'xy';\r\n\r\n        this.mouse = false;\r\n\r\n        interactions.push(this);\r\n    }\r\n\r\n    Interaction.prototype = {\r\n        getPageXY  : function (pointer, xy) { return   getPageXY(pointer, xy, this); },\r\n        getClientXY: function (pointer, xy) { return getClientXY(pointer, xy, this); },\r\n        setEventXY : function (target, ptr) { return  setEventXY(target, ptr, this); },\r\n\r\n        pointerOver: function (pointer, event, eventTarget) {\r\n            if (this.prepared.name || !this.mouse) { return; }\r\n\r\n            var curMatches = [],\r\n                curMatchElements = [],\r\n                prevTargetElement = this.element;\r\n\r\n            this.addPointer(pointer);\r\n\r\n            if (this.target\r\n                && (testIgnore(this.target, this.element, eventTarget)\r\n                    || !testAllow(this.target, this.element, eventTarget))) {\r\n                // if the eventTarget should be ignored or shouldn't be allowed\r\n                // clear the previous target\r\n                this.target = null;\r\n                this.element = null;\r\n                this.matches = [];\r\n                this.matchElements = [];\r\n            }\r\n\r\n            var elementInteractable = interactables.get(eventTarget),\r\n                elementAction = (elementInteractable\r\n                                 && !testIgnore(elementInteractable, eventTarget, eventTarget)\r\n                                 && testAllow(elementInteractable, eventTarget, eventTarget)\r\n                                 && validateAction(\r\n                                     elementInteractable.getAction(pointer, event, this, eventTarget),\r\n                                     elementInteractable));\r\n\r\n            if (elementAction && !withinInteractionLimit(elementInteractable, eventTarget, elementAction)) {\r\n                 elementAction = null;\r\n            }\r\n\r\n            function pushCurMatches (interactable, selector) {\r\n                if (interactable\r\n                    && inContext(interactable, eventTarget)\r\n                    && !testIgnore(interactable, eventTarget, eventTarget)\r\n                    && testAllow(interactable, eventTarget, eventTarget)\r\n                    && matchesSelector(eventTarget, selector)) {\r\n\r\n                    curMatches.push(interactable);\r\n                    curMatchElements.push(eventTarget);\r\n                }\r\n            }\r\n\r\n            if (elementAction) {\r\n                this.target = elementInteractable;\r\n                this.element = eventTarget;\r\n                this.matches = [];\r\n                this.matchElements = [];\r\n            }\r\n            else {\r\n                interactables.forEachSelector(pushCurMatches);\r\n\r\n                if (this.validateSelector(pointer, event, curMatches, curMatchElements)) {\r\n                    this.matches = curMatches;\r\n                    this.matchElements = curMatchElements;\r\n\r\n                    this.pointerHover(pointer, event, this.matches, this.matchElements);\r\n                    events.add(eventTarget,\r\n                                        PointerEvent? pEventTypes.move : 'mousemove',\r\n                                        listeners.pointerHover);\r\n                }\r\n                else if (this.target) {\r\n                    if (nodeContains(prevTargetElement, eventTarget)) {\r\n                        this.pointerHover(pointer, event, this.matches, this.matchElements);\r\n                        events.add(this.element,\r\n                                            PointerEvent? pEventTypes.move : 'mousemove',\r\n                                            listeners.pointerHover);\r\n                    }\r\n                    else {\r\n                        this.target = null;\r\n                        this.element = null;\r\n                        this.matches = [];\r\n                        this.matchElements = [];\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        // Check what action would be performed on pointerMove target if a mouse\r\n        // button were pressed and change the cursor accordingly\r\n        pointerHover: function (pointer, event, eventTarget, curEventTarget, matches, matchElements) {\r\n            var target = this.target;\r\n\r\n            if (!this.prepared.name && this.mouse) {\r\n\r\n                var action;\r\n\r\n                // update pointer coords for defaultActionChecker to use\r\n                this.setEventXY(this.curCoords, [pointer]);\r\n\r\n                if (matches) {\r\n                    action = this.validateSelector(pointer, event, matches, matchElements);\r\n                }\r\n                else if (target) {\r\n                    action = validateAction(target.getAction(this.pointers[0], event, this, this.element), this.target);\r\n                }\r\n\r\n                if (target && target.options.styleCursor) {\r\n                    if (action) {\r\n                        target._doc.documentElement.style.cursor = getActionCursor(action);\r\n                    }\r\n                    else {\r\n                        target._doc.documentElement.style.cursor = '';\r\n                    }\r\n                }\r\n            }\r\n            else if (this.prepared.name) {\r\n                this.checkAndPreventDefault(event, target, this.element);\r\n            }\r\n        },\r\n\r\n        pointerOut: function (pointer, event, eventTarget) {\r\n            if (this.prepared.name) { return; }\r\n\r\n            // Remove temporary event listeners for selector Interactables\r\n            if (!interactables.get(eventTarget)) {\r\n                events.remove(eventTarget,\r\n                                       PointerEvent? pEventTypes.move : 'mousemove',\r\n                                       listeners.pointerHover);\r\n            }\r\n\r\n            if (this.target && this.target.options.styleCursor && !this.interacting()) {\r\n                this.target._doc.documentElement.style.cursor = '';\r\n            }\r\n        },\r\n\r\n        selectorDown: function (pointer, event, eventTarget, curEventTarget) {\r\n            var that = this,\r\n                // copy event to be used in timeout for IE8\r\n                eventCopy = events.useAttachEvent? extend({}, event) : event,\r\n                element = eventTarget,\r\n                pointerIndex = this.addPointer(pointer),\r\n                action;\r\n\r\n            this.holdTimers[pointerIndex] = setTimeout(function () {\r\n                that.pointerHold(events.useAttachEvent? eventCopy : pointer, eventCopy, eventTarget, curEventTarget);\r\n            }, defaultOptions._holdDuration);\r\n\r\n            this.pointerIsDown = true;\r\n\r\n            // Check if the down event hits the current inertia target\r\n            if (this.inertiaStatus.active && this.target.selector) {\r\n                // climb up the DOM tree from the event target\r\n                while (isElement(element)) {\r\n\r\n                    // if this element is the current inertia target element\r\n                    if (element === this.element\r\n                        // and the prospective action is the same as the ongoing one\r\n                        && validateAction(this.target.getAction(pointer, event, this, this.element), this.target).name === this.prepared.name) {\r\n\r\n                        // stop inertia so that the next move will be a normal one\r\n                        cancelFrame(this.inertiaStatus.i);\r\n                        this.inertiaStatus.active = false;\r\n\r\n                        this.collectEventTargets(pointer, event, eventTarget, 'down');\r\n                        return;\r\n                    }\r\n                    element = parentElement(element);\r\n                }\r\n            }\r\n\r\n            // do nothing if interacting\r\n            if (this.interacting()) {\r\n                this.collectEventTargets(pointer, event, eventTarget, 'down');\r\n                return;\r\n            }\r\n\r\n            function pushMatches (interactable, selector, context) {\r\n                var elements = ie8MatchesSelector\r\n                    ? context.querySelectorAll(selector)\r\n                    : undefined;\r\n\r\n                if (inContext(interactable, element)\r\n                    && !testIgnore(interactable, element, eventTarget)\r\n                    && testAllow(interactable, element, eventTarget)\r\n                    && matchesSelector(element, selector, elements)) {\r\n\r\n                    that.matches.push(interactable);\r\n                    that.matchElements.push(element);\r\n                }\r\n            }\r\n\r\n            // update pointer coords for defaultActionChecker to use\r\n            this.setEventXY(this.curCoords, [pointer]);\r\n            this.downEvent = event;\r\n\r\n            while (isElement(element) && !action) {\r\n                this.matches = [];\r\n                this.matchElements = [];\r\n\r\n                interactables.forEachSelector(pushMatches);\r\n\r\n                action = this.validateSelector(pointer, event, this.matches, this.matchElements);\r\n                element = parentElement(element);\r\n            }\r\n\r\n            if (action) {\r\n                this.prepared.name  = action.name;\r\n                this.prepared.axis  = action.axis;\r\n                this.prepared.edges = action.edges;\r\n\r\n                this.collectEventTargets(pointer, event, eventTarget, 'down');\r\n\r\n                return this.pointerDown(pointer, event, eventTarget, curEventTarget, action);\r\n            }\r\n            else {\r\n                // do these now since pointerDown isn't being called from here\r\n                this.downTimes[pointerIndex] = new Date().getTime();\r\n                this.downTargets[pointerIndex] = eventTarget;\r\n                pointerExtend(this.downPointer, pointer);\r\n\r\n                copyCoords(this.prevCoords, this.curCoords);\r\n                this.pointerWasMoved = false;\r\n            }\r\n\r\n            this.collectEventTargets(pointer, event, eventTarget, 'down');\r\n        },\r\n\r\n        // Determine action to be performed on next pointerMove and add appropriate\r\n        // style and event Listeners\r\n        pointerDown: function (pointer, event, eventTarget, curEventTarget, forceAction) {\r\n            if (!forceAction && !this.inertiaStatus.active && this.pointerWasMoved && this.prepared.name) {\r\n                this.checkAndPreventDefault(event, this.target, this.element);\r\n\r\n                return;\r\n            }\r\n\r\n            this.pointerIsDown = true;\r\n            this.downEvent = event;\r\n\r\n            var pointerIndex = this.addPointer(pointer),\r\n                action;\r\n\r\n            // If it is the second touch of a multi-touch gesture, keep the\r\n            // target the same and get a new action if a target was set by the\r\n            // first touch\r\n            if (this.pointerIds.length > 1 && this.target._element === this.element) {\r\n                var newAction = validateAction(forceAction || this.target.getAction(pointer, event, this, this.element), this.target);\r\n\r\n                if (withinInteractionLimit(this.target, this.element, newAction)) {\r\n                    action = newAction;\r\n                }\r\n\r\n                this.prepared.name = null;\r\n            }\r\n            // Otherwise, set the target if there is no action prepared\r\n            else if (!this.prepared.name) {\r\n                var interactable = interactables.get(curEventTarget);\r\n\r\n                if (interactable\r\n                    && !testIgnore(interactable, curEventTarget, eventTarget)\r\n                    && testAllow(interactable, curEventTarget, eventTarget)\r\n                    && (action = validateAction(forceAction || interactable.getAction(pointer, event, this, curEventTarget), interactable, eventTarget))\r\n                    && withinInteractionLimit(interactable, curEventTarget, action)) {\r\n                    this.target = interactable;\r\n                    this.element = curEventTarget;\r\n                }\r\n            }\r\n\r\n            var target = this.target,\r\n                options = target && target.options;\r\n\r\n            if (target && (forceAction || !this.prepared.name)) {\r\n                action = action || validateAction(forceAction || target.getAction(pointer, event, this, curEventTarget), target, this.element);\r\n\r\n                this.setEventXY(this.startCoords, this.pointers);\r\n\r\n                if (!action) { return; }\r\n\r\n                if (options.styleCursor) {\r\n                    target._doc.documentElement.style.cursor = getActionCursor(action);\r\n                }\r\n\r\n                this.resizeAxes = action.name === 'resize'? action.axis : null;\r\n\r\n                if (action === 'gesture' && this.pointerIds.length < 2) {\r\n                    action = null;\r\n                }\r\n\r\n                this.prepared.name  = action.name;\r\n                this.prepared.axis  = action.axis;\r\n                this.prepared.edges = action.edges;\r\n\r\n                this.snapStatus.snappedX = this.snapStatus.snappedY =\r\n                    this.restrictStatus.restrictedX = this.restrictStatus.restrictedY = NaN;\r\n\r\n                this.downTimes[pointerIndex] = new Date().getTime();\r\n                this.downTargets[pointerIndex] = eventTarget;\r\n                pointerExtend(this.downPointer, pointer);\r\n\r\n                copyCoords(this.prevCoords, this.startCoords);\r\n                this.pointerWasMoved = false;\r\n\r\n                this.checkAndPreventDefault(event, target, this.element);\r\n            }\r\n            // if inertia is active try to resume action\r\n            else if (this.inertiaStatus.active\r\n                && curEventTarget === this.element\r\n                && validateAction(target.getAction(pointer, event, this, this.element), target).name === this.prepared.name) {\r\n\r\n                cancelFrame(this.inertiaStatus.i);\r\n                this.inertiaStatus.active = false;\r\n\r\n                this.checkAndPreventDefault(event, target, this.element);\r\n            }\r\n        },\r\n\r\n        setModifications: function (coords, preEnd) {\r\n            var target         = this.target,\r\n                shouldMove     = true,\r\n                shouldSnap     = checkSnap(target, this.prepared.name)     && (!target.options[this.prepared.name].snap.endOnly     || preEnd),\r\n                shouldRestrict = checkRestrict(target, this.prepared.name) && (!target.options[this.prepared.name].restrict.endOnly || preEnd);\r\n\r\n            if (shouldSnap    ) { this.setSnapping   (coords); } else { this.snapStatus    .locked     = false; }\r\n            if (shouldRestrict) { this.setRestriction(coords); } else { this.restrictStatus.restricted = false; }\r\n\r\n            if (shouldSnap && this.snapStatus.locked && !this.snapStatus.changed) {\r\n                shouldMove = shouldRestrict && this.restrictStatus.restricted && this.restrictStatus.changed;\r\n            }\r\n            else if (shouldRestrict && this.restrictStatus.restricted && !this.restrictStatus.changed) {\r\n                shouldMove = false;\r\n            }\r\n\r\n            return shouldMove;\r\n        },\r\n\r\n        setStartOffsets: function (action, interactable, element) {\r\n            var rect = interactable.getRect(element),\r\n                origin = getOriginXY(interactable, element),\r\n                snap = interactable.options[this.prepared.name].snap,\r\n                restrict = interactable.options[this.prepared.name].restrict,\r\n                width, height;\r\n\r\n            if (rect) {\r\n                this.startOffset.left = this.startCoords.page.x - rect.left;\r\n                this.startOffset.top  = this.startCoords.page.y - rect.top;\r\n\r\n                this.startOffset.right  = rect.right  - this.startCoords.page.x;\r\n                this.startOffset.bottom = rect.bottom - this.startCoords.page.y;\r\n\r\n                if ('width' in rect) { width = rect.width; }\r\n                else { width = rect.right - rect.left; }\r\n                if ('height' in rect) { height = rect.height; }\r\n                else { height = rect.bottom - rect.top; }\r\n            }\r\n            else {\r\n                this.startOffset.left = this.startOffset.top = this.startOffset.right = this.startOffset.bottom = 0;\r\n            }\r\n\r\n            this.snapOffsets.splice(0);\r\n\r\n            var snapOffset = snap && snap.offset === 'startCoords'\r\n                                ? {\r\n                                    x: this.startCoords.page.x - origin.x,\r\n                                    y: this.startCoords.page.y - origin.y\r\n                                }\r\n                                : snap && snap.offset || { x: 0, y: 0 };\r\n\r\n            if (rect && snap && snap.relativePoints && snap.relativePoints.length) {\r\n                for (var i = 0; i < snap.relativePoints.length; i++) {\r\n                    this.snapOffsets.push({\r\n                        x: this.startOffset.left - (width  * snap.relativePoints[i].x) + snapOffset.x,\r\n                        y: this.startOffset.top  - (height * snap.relativePoints[i].y) + snapOffset.y\r\n                    });\r\n                }\r\n            }\r\n            else {\r\n                this.snapOffsets.push(snapOffset);\r\n            }\r\n\r\n            if (rect && restrict.elementRect) {\r\n                this.restrictOffset.left = this.startOffset.left - (width  * restrict.elementRect.left);\r\n                this.restrictOffset.top  = this.startOffset.top  - (height * restrict.elementRect.top);\r\n\r\n                this.restrictOffset.right  = this.startOffset.right  - (width  * (1 - restrict.elementRect.right));\r\n                this.restrictOffset.bottom = this.startOffset.bottom - (height * (1 - restrict.elementRect.bottom));\r\n            }\r\n            else {\r\n                this.restrictOffset.left = this.restrictOffset.top = this.restrictOffset.right = this.restrictOffset.bottom = 0;\r\n            }\r\n        },\r\n\r\n        /*\\\r\n         * Interaction.start\r\n         [ method ]\r\n         *\r\n         * Start an action with the given Interactable and Element as tartgets. The\r\n         * action must be enabled for the target Interactable and an appropriate number\r\n         * of pointers must be held down  1 for drag/resize, 2 for gesture.\r\n         *\r\n         * Use it with `interactable.<action>able({ manualStart: false })` to always\r\n         * [start actions manually](https://github.com/taye/interact.js/issues/114)\r\n         *\r\n         - action       (object)  The action to be performed - drag, resize, etc.\r\n         - interactable (Interactable) The Interactable to target\r\n         - element      (Element) The DOM Element to target\r\n         = (object) interact\r\n         **\r\n         | interact(target)\r\n         |   .draggable({\r\n         |     // disable the default drag start by down->move\r\n         |     manualStart: true\r\n         |   })\r\n         |   // start dragging after the user holds the pointer down\r\n         |   .on('hold', function (event) {\r\n         |     var interaction = event.interaction;\r\n         |\r\n         |     if (!interaction.interacting()) {\r\n         |       interaction.start({ name: 'drag' },\r\n         |                         event.interactable,\r\n         |                         event.currentTarget);\r\n         |     }\r\n         | });\r\n        \\*/\r\n        start: function (action, interactable, element) {\r\n            if (this.interacting()\r\n                || !this.pointerIsDown\r\n                || this.pointerIds.length < (action.name === 'gesture'? 2 : 1)) {\r\n                return;\r\n            }\r\n\r\n            // if this interaction had been removed after stopping\r\n            // add it back\r\n            if (indexOf(interactions, this) === -1) {\r\n                interactions.push(this);\r\n            }\r\n\r\n            // set the startCoords if there was no prepared action\r\n            if (!this.prepared.name) {\r\n                this.setEventXY(this.startCoords);\r\n            }\r\n\r\n            this.prepared.name  = action.name;\r\n            this.prepared.axis  = action.axis;\r\n            this.prepared.edges = action.edges;\r\n            this.target         = interactable;\r\n            this.element        = element;\r\n\r\n            this.setStartOffsets(action.name, interactable, element);\r\n            this.setModifications(this.startCoords.page);\r\n\r\n            this.prevEvent = this[this.prepared.name + 'Start'](this.downEvent);\r\n        },\r\n\r\n        pointerMove: function (pointer, event, eventTarget, curEventTarget, preEnd) {\r\n            if (this.inertiaStatus.active) {\r\n                var pageUp   = this.inertiaStatus.upCoords.page;\r\n                var clientUp = this.inertiaStatus.upCoords.client;\r\n\r\n                var inertiaPosition = {\r\n                    pageX  : pageUp.x   + this.inertiaStatus.sx,\r\n                    pageY  : pageUp.y   + this.inertiaStatus.sy,\r\n                    clientX: clientUp.x + this.inertiaStatus.sx,\r\n                    clientY: clientUp.y + this.inertiaStatus.sy\r\n                };\r\n\r\n                this.setEventXY(this.curCoords, [inertiaPosition]);\r\n            }\r\n            else {\r\n                this.recordPointer(pointer);\r\n                this.setEventXY(this.curCoords, this.pointers);\r\n            }\r\n\r\n            var duplicateMove = (this.curCoords.page.x === this.prevCoords.page.x\r\n                                 && this.curCoords.page.y === this.prevCoords.page.y\r\n                                 && this.curCoords.client.x === this.prevCoords.client.x\r\n                                 && this.curCoords.client.y === this.prevCoords.client.y);\r\n\r\n            var dx, dy,\r\n                pointerIndex = this.mouse? 0 : indexOf(this.pointerIds, getPointerId(pointer));\r\n\r\n            // register movement greater than pointerMoveTolerance\r\n            if (this.pointerIsDown && !this.pointerWasMoved) {\r\n                dx = this.curCoords.client.x - this.startCoords.client.x;\r\n                dy = this.curCoords.client.y - this.startCoords.client.y;\r\n\r\n                this.pointerWasMoved = hypot(dx, dy) > pointerMoveTolerance;\r\n            }\r\n\r\n            if (!duplicateMove && (!this.pointerIsDown || this.pointerWasMoved)) {\r\n                if (this.pointerIsDown) {\r\n                    clearTimeout(this.holdTimers[pointerIndex]);\r\n                }\r\n\r\n                this.collectEventTargets(pointer, event, eventTarget, 'move');\r\n            }\r\n\r\n            if (!this.pointerIsDown) { return; }\r\n\r\n            if (duplicateMove && this.pointerWasMoved && !preEnd) {\r\n                this.checkAndPreventDefault(event, this.target, this.element);\r\n                return;\r\n            }\r\n\r\n            // set pointer coordinate, time changes and speeds\r\n            setEventDeltas(this.pointerDelta, this.prevCoords, this.curCoords);\r\n\r\n            if (!this.prepared.name) { return; }\r\n\r\n            if (this.pointerWasMoved\r\n                // ignore movement while inertia is active\r\n                && (!this.inertiaStatus.active || (pointer instanceof InteractEvent && /inertiastart/.test(pointer.type)))) {\r\n\r\n                // if just starting an action, calculate the pointer speed now\r\n                if (!this.interacting()) {\r\n                    setEventDeltas(this.pointerDelta, this.prevCoords, this.curCoords);\r\n\r\n                    // check if a drag is in the correct axis\r\n                    if (this.prepared.name === 'drag') {\r\n                        var absX = Math.abs(dx),\r\n                            absY = Math.abs(dy),\r\n                            targetAxis = this.target.options.drag.axis,\r\n                            axis = (absX > absY ? 'x' : absX < absY ? 'y' : 'xy');\r\n\r\n                        // if the movement isn't in the axis of the interactable\r\n                        if (axis !== 'xy' && targetAxis !== 'xy' && targetAxis !== axis) {\r\n                            // cancel the prepared action\r\n                            this.prepared.name = null;\r\n\r\n                            // then try to get a drag from another ineractable\r\n\r\n                            var element = eventTarget;\r\n\r\n                            // check element interactables\r\n                            while (isElement(element)) {\r\n                                var elementInteractable = interactables.get(element);\r\n\r\n                                if (elementInteractable\r\n                                    && elementInteractable !== this.target\r\n                                    && !elementInteractable.options.drag.manualStart\r\n                                    && elementInteractable.getAction(this.downPointer, this.downEvent, this, element).name === 'drag'\r\n                                    && checkAxis(axis, elementInteractable)) {\r\n\r\n                                    this.prepared.name = 'drag';\r\n                                    this.target = elementInteractable;\r\n                                    this.element = element;\r\n                                    break;\r\n                                }\r\n\r\n                                element = parentElement(element);\r\n                            }\r\n\r\n                            // if there's no drag from element interactables,\r\n                            // check the selector interactables\r\n                            if (!this.prepared.name) {\r\n                                var thisInteraction = this;\r\n\r\n                                var getDraggable = function (interactable, selector, context) {\r\n                                    var elements = ie8MatchesSelector\r\n                                        ? context.querySelectorAll(selector)\r\n                                        : undefined;\r\n\r\n                                    if (interactable === thisInteraction.target) { return; }\r\n\r\n                                    if (inContext(interactable, eventTarget)\r\n                                        && !interactable.options.drag.manualStart\r\n                                        && !testIgnore(interactable, element, eventTarget)\r\n                                        && testAllow(interactable, element, eventTarget)\r\n                                        && matchesSelector(element, selector, elements)\r\n                                        && interactable.getAction(thisInteraction.downPointer, thisInteraction.downEvent, thisInteraction, element).name === 'drag'\r\n                                        && checkAxis(axis, interactable)\r\n                                        && withinInteractionLimit(interactable, element, 'drag')) {\r\n\r\n                                        return interactable;\r\n                                    }\r\n                                };\r\n\r\n                                element = eventTarget;\r\n\r\n                                while (isElement(element)) {\r\n                                    var selectorInteractable = interactables.forEachSelector(getDraggable);\r\n\r\n                                    if (selectorInteractable) {\r\n                                        this.prepared.name = 'drag';\r\n                                        this.target = selectorInteractable;\r\n                                        this.element = element;\r\n                                        break;\r\n                                    }\r\n\r\n                                    element = parentElement(element);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                var starting = !!this.prepared.name && !this.interacting();\r\n\r\n                if (starting\r\n                    && (this.target.options[this.prepared.name].manualStart\r\n                        || !withinInteractionLimit(this.target, this.element, this.prepared))) {\r\n                    this.stop(event);\r\n                    return;\r\n                }\r\n\r\n                if (this.prepared.name && this.target) {\r\n                    if (starting) {\r\n                        this.start(this.prepared, this.target, this.element);\r\n                    }\r\n\r\n                    var shouldMove = this.setModifications(this.curCoords.page, preEnd);\r\n\r\n                    // move if snapping or restriction doesn't prevent it\r\n                    if (shouldMove || starting) {\r\n                        this.prevEvent = this[this.prepared.name + 'Move'](event);\r\n                    }\r\n\r\n                    this.checkAndPreventDefault(event, this.target, this.element);\r\n                }\r\n            }\r\n\r\n            copyCoords(this.prevCoords, this.curCoords);\r\n\r\n            if (this.dragging || this.resizing) {\r\n                this.autoScrollMove(pointer);\r\n            }\r\n        },\r\n\r\n        dragStart: function (event) {\r\n            var dragEvent = new InteractEvent(this, event, 'drag', 'start', this.element);\r\n\r\n            this.dragging = true;\r\n            this.target.fire(dragEvent);\r\n\r\n            // reset active dropzones\r\n            this.activeDrops.dropzones = [];\r\n            this.activeDrops.elements  = [];\r\n            this.activeDrops.rects     = [];\r\n\r\n            if (!this.dynamicDrop) {\r\n                this.setActiveDrops(this.element);\r\n            }\r\n\r\n            var dropEvents = this.getDropEvents(event, dragEvent);\r\n\r\n            if (dropEvents.activate) {\r\n                this.fireActiveDrops(dropEvents.activate);\r\n            }\r\n\r\n            return dragEvent;\r\n        },\r\n\r\n        dragMove: function (event) {\r\n            var target = this.target,\r\n                dragEvent  = new InteractEvent(this, event, 'drag', 'move', this.element),\r\n                draggableElement = this.element,\r\n                drop = this.getDrop(dragEvent, event, draggableElement);\r\n\r\n            this.dropTarget = drop.dropzone;\r\n            this.dropElement = drop.element;\r\n\r\n            var dropEvents = this.getDropEvents(event, dragEvent);\r\n\r\n            target.fire(dragEvent);\r\n\r\n            if (dropEvents.leave) { this.prevDropTarget.fire(dropEvents.leave); }\r\n            if (dropEvents.enter) {     this.dropTarget.fire(dropEvents.enter); }\r\n            if (dropEvents.move ) {     this.dropTarget.fire(dropEvents.move ); }\r\n\r\n            this.prevDropTarget  = this.dropTarget;\r\n            this.prevDropElement = this.dropElement;\r\n\r\n            return dragEvent;\r\n        },\r\n\r\n        resizeStart: function (event) {\r\n            var resizeEvent = new InteractEvent(this, event, 'resize', 'start', this.element);\r\n\r\n            if (this.prepared.edges) {\r\n                var startRect = this.target.getRect(this.element);\r\n\r\n                /*\r\n                 * When using the `resizable.square` or `resizable.preserveAspectRatio` options, resizing from one edge\r\n                 * will affect another. E.g. with `resizable.square`, resizing to make the right edge larger will make\r\n                 * the bottom edge larger by the same amount. We call these 'linked' edges. Any linked edges will depend\r\n                 * on the active edges and the edge being interacted with.\r\n                 */\r\n                if (this.target.options.resize.square || this.target.options.resize.preserveAspectRatio) {\r\n                    var linkedEdges = extend({}, this.prepared.edges);\r\n\r\n                    linkedEdges.top    = linkedEdges.top    || (linkedEdges.left   && !linkedEdges.bottom);\r\n                    linkedEdges.left   = linkedEdges.left   || (linkedEdges.top    && !linkedEdges.right );\r\n                    linkedEdges.bottom = linkedEdges.bottom || (linkedEdges.right  && !linkedEdges.top   );\r\n                    linkedEdges.right  = linkedEdges.right  || (linkedEdges.bottom && !linkedEdges.left  );\r\n\r\n                    this.prepared._linkedEdges = linkedEdges;\r\n                }\r\n                else {\r\n                    this.prepared._linkedEdges = null;\r\n                }\r\n\r\n                // if using `resizable.preserveAspectRatio` option, record aspect ratio at the start of the resize\r\n                if (this.target.options.resize.preserveAspectRatio) {\r\n                    this.resizeStartAspectRatio = startRect.width / startRect.height;\r\n                }\r\n\r\n                this.resizeRects = {\r\n                    start     : startRect,\r\n                    current   : extend({}, startRect),\r\n                    restricted: extend({}, startRect),\r\n                    previous  : extend({}, startRect),\r\n                    delta     : {\r\n                        left: 0, right : 0, width : 0,\r\n                        top : 0, bottom: 0, height: 0\r\n                    }\r\n                };\r\n\r\n                resizeEvent.rect = this.resizeRects.restricted;\r\n                resizeEvent.deltaRect = this.resizeRects.delta;\r\n            }\r\n\r\n            this.target.fire(resizeEvent);\r\n\r\n            this.resizing = true;\r\n\r\n            return resizeEvent;\r\n        },\r\n\r\n        resizeMove: function (event) {\r\n            var resizeEvent = new InteractEvent(this, event, 'resize', 'move', this.element);\r\n\r\n            var edges = this.prepared.edges,\r\n                invert = this.target.options.resize.invert,\r\n                invertible = invert === 'reposition' || invert === 'negate';\r\n\r\n            if (edges) {\r\n                var dx = resizeEvent.dx,\r\n                    dy = resizeEvent.dy,\r\n\r\n                    start      = this.resizeRects.start,\r\n                    current    = this.resizeRects.current,\r\n                    restricted = this.resizeRects.restricted,\r\n                    delta      = this.resizeRects.delta,\r\n                    previous   = extend(this.resizeRects.previous, restricted),\r\n\r\n                    originalEdges = edges;\r\n\r\n                // `resize.preserveAspectRatio` takes precedence over `resize.square`\r\n                if (this.target.options.resize.preserveAspectRatio) {\r\n                    var resizeStartAspectRatio = this.resizeStartAspectRatio;\r\n\r\n                    edges = this.prepared._linkedEdges;\r\n\r\n                    if ((originalEdges.left && originalEdges.bottom)\r\n                        || (originalEdges.right && originalEdges.top)) {\r\n                        dy = -dx / resizeStartAspectRatio;\r\n                    }\r\n                    else if (originalEdges.left || originalEdges.right) { dy = dx / resizeStartAspectRatio; }\r\n                    else if (originalEdges.top || originalEdges.bottom) { dx = dy * resizeStartAspectRatio; }\r\n                }\r\n                else if (this.target.options.resize.square) {\r\n                    edges = this.prepared._linkedEdges;\r\n\r\n                    if ((originalEdges.left && originalEdges.bottom)\r\n                        || (originalEdges.right && originalEdges.top)) {\r\n                        dy = -dx;\r\n                    }\r\n                    else if (originalEdges.left || originalEdges.right) { dy = dx; }\r\n                    else if (originalEdges.top || originalEdges.bottom) { dx = dy; }\r\n                }\r\n\r\n                // update the 'current' rect without modifications\r\n                if (edges.top   ) { current.top    += dy; }\r\n                if (edges.bottom) { current.bottom += dy; }\r\n                if (edges.left  ) { current.left   += dx; }\r\n                if (edges.right ) { current.right  += dx; }\r\n\r\n                if (invertible) {\r\n                    // if invertible, copy the current rect\r\n                    extend(restricted, current);\r\n\r\n                    if (invert === 'reposition') {\r\n                        // swap edge values if necessary to keep width/height positive\r\n                        var swap;\r\n\r\n                        if (restricted.top > restricted.bottom) {\r\n                            swap = restricted.top;\r\n\r\n                            restricted.top = restricted.bottom;\r\n                            restricted.bottom = swap;\r\n                        }\r\n                        if (restricted.left > restricted.right) {\r\n                            swap = restricted.left;\r\n\r\n                            restricted.left = restricted.right;\r\n                            restricted.right = swap;\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    // if not invertible, restrict to minimum of 0x0 rect\r\n                    restricted.top    = Math.min(current.top, start.bottom);\r\n                    restricted.bottom = Math.max(current.bottom, start.top);\r\n                    restricted.left   = Math.min(current.left, start.right);\r\n                    restricted.right  = Math.max(current.right, start.left);\r\n                }\r\n\r\n                restricted.width  = restricted.right  - restricted.left;\r\n                restricted.height = restricted.bottom - restricted.top ;\r\n\r\n                for (var edge in restricted) {\r\n                    delta[edge] = restricted[edge] - previous[edge];\r\n                }\r\n\r\n                resizeEvent.edges = this.prepared.edges;\r\n                resizeEvent.rect = restricted;\r\n                resizeEvent.deltaRect = delta;\r\n            }\r\n\r\n            this.target.fire(resizeEvent);\r\n\r\n            return resizeEvent;\r\n        },\r\n\r\n        gestureStart: function (event) {\r\n            var gestureEvent = new InteractEvent(this, event, 'gesture', 'start', this.element);\r\n\r\n            gestureEvent.ds = 0;\r\n\r\n            this.gesture.startDistance = this.gesture.prevDistance = gestureEvent.distance;\r\n            this.gesture.startAngle = this.gesture.prevAngle = gestureEvent.angle;\r\n            this.gesture.scale = 1;\r\n\r\n            this.gesturing = true;\r\n\r\n            this.target.fire(gestureEvent);\r\n\r\n            return gestureEvent;\r\n        },\r\n\r\n        gestureMove: function (event) {\r\n            if (!this.pointerIds.length) {\r\n                return this.prevEvent;\r\n            }\r\n\r\n            var gestureEvent;\r\n\r\n            gestureEvent = new InteractEvent(this, event, 'gesture', 'move', this.element);\r\n            gestureEvent.ds = gestureEvent.scale - this.gesture.scale;\r\n\r\n            this.target.fire(gestureEvent);\r\n\r\n            this.gesture.prevAngle = gestureEvent.angle;\r\n            this.gesture.prevDistance = gestureEvent.distance;\r\n\r\n            if (gestureEvent.scale !== Infinity &&\r\n                gestureEvent.scale !== null &&\r\n                gestureEvent.scale !== undefined  &&\r\n                !isNaN(gestureEvent.scale)) {\r\n\r\n                this.gesture.scale = gestureEvent.scale;\r\n            }\r\n\r\n            return gestureEvent;\r\n        },\r\n\r\n        pointerHold: function (pointer, event, eventTarget) {\r\n            this.collectEventTargets(pointer, event, eventTarget, 'hold');\r\n        },\r\n\r\n        pointerUp: function (pointer, event, eventTarget, curEventTarget) {\r\n            var pointerIndex = this.mouse? 0 : indexOf(this.pointerIds, getPointerId(pointer));\r\n\r\n            clearTimeout(this.holdTimers[pointerIndex]);\r\n\r\n            this.collectEventTargets(pointer, event, eventTarget, 'up' );\r\n            this.collectEventTargets(pointer, event, eventTarget, 'tap');\r\n\r\n            this.pointerEnd(pointer, event, eventTarget, curEventTarget);\r\n\r\n            this.removePointer(pointer);\r\n        },\r\n\r\n        pointerCancel: function (pointer, event, eventTarget, curEventTarget) {\r\n            var pointerIndex = this.mouse? 0 : indexOf(this.pointerIds, getPointerId(pointer));\r\n\r\n            clearTimeout(this.holdTimers[pointerIndex]);\r\n\r\n            this.collectEventTargets(pointer, event, eventTarget, 'cancel');\r\n            this.pointerEnd(pointer, event, eventTarget, curEventTarget);\r\n\r\n            this.removePointer(pointer);\r\n        },\r\n\r\n        // http://www.quirksmode.org/dom/events/click.html\r\n        // >Events leading to dblclick\r\n        //\r\n        // IE8 doesn't fire down event before dblclick.\r\n        // This workaround tries to fire a tap and doubletap after dblclick\r\n        ie8Dblclick: function (pointer, event, eventTarget) {\r\n            if (this.prevTap\r\n                && event.clientX === this.prevTap.clientX\r\n                && event.clientY === this.prevTap.clientY\r\n                && eventTarget   === this.prevTap.target) {\r\n\r\n                this.downTargets[0] = eventTarget;\r\n                this.downTimes[0] = new Date().getTime();\r\n                this.collectEventTargets(pointer, event, eventTarget, 'tap');\r\n            }\r\n        },\r\n\r\n        // End interact move events and stop auto-scroll unless inertia is enabled\r\n        pointerEnd: function (pointer, event, eventTarget, curEventTarget) {\r\n            var endEvent,\r\n                target = this.target,\r\n                options = target && target.options,\r\n                inertiaOptions = options && this.prepared.name && options[this.prepared.name].inertia,\r\n                inertiaStatus = this.inertiaStatus;\r\n\r\n            if (this.interacting()) {\r\n\r\n                if (inertiaStatus.active && !inertiaStatus.ending) { return; }\r\n\r\n                var pointerSpeed,\r\n                    now = new Date().getTime(),\r\n                    inertiaPossible = false,\r\n                    inertia = false,\r\n                    smoothEnd = false,\r\n                    endSnap = checkSnap(target, this.prepared.name) && options[this.prepared.name].snap.endOnly,\r\n                    endRestrict = checkRestrict(target, this.prepared.name) && options[this.prepared.name].restrict.endOnly,\r\n                    dx = 0,\r\n                    dy = 0,\r\n                    startEvent;\r\n\r\n                if (this.dragging) {\r\n                    if      (options.drag.axis === 'x' ) { pointerSpeed = Math.abs(this.pointerDelta.client.vx); }\r\n                    else if (options.drag.axis === 'y' ) { pointerSpeed = Math.abs(this.pointerDelta.client.vy); }\r\n                    else   /*options.drag.axis === 'xy'*/{ pointerSpeed = this.pointerDelta.client.speed; }\r\n                }\r\n                else {\r\n                    pointerSpeed = this.pointerDelta.client.speed;\r\n                }\r\n\r\n                // check if inertia should be started\r\n                inertiaPossible = (inertiaOptions && inertiaOptions.enabled\r\n                                   && this.prepared.name !== 'gesture'\r\n                                   && event !== inertiaStatus.startEvent);\r\n\r\n                inertia = (inertiaPossible\r\n                           && (now - this.curCoords.timeStamp) < 50\r\n                           && pointerSpeed > inertiaOptions.minSpeed\r\n                           && pointerSpeed > inertiaOptions.endSpeed);\r\n\r\n                if (inertiaPossible && !inertia && (endSnap || endRestrict)) {\r\n\r\n                    var snapRestrict = {};\r\n\r\n                    snapRestrict.snap = snapRestrict.restrict = snapRestrict;\r\n\r\n                    if (endSnap) {\r\n                        this.setSnapping(this.curCoords.page, snapRestrict);\r\n                        if (snapRestrict.locked) {\r\n                            dx += snapRestrict.dx;\r\n                            dy += snapRestrict.dy;\r\n                        }\r\n                    }\r\n\r\n                    if (endRestrict) {\r\n                        this.setRestriction(this.curCoords.page, snapRestrict);\r\n                        if (snapRestrict.restricted) {\r\n                            dx += snapRestrict.dx;\r\n                            dy += snapRestrict.dy;\r\n                        }\r\n                    }\r\n\r\n                    if (dx || dy) {\r\n                        smoothEnd = true;\r\n                    }\r\n                }\r\n\r\n                if (inertia || smoothEnd) {\r\n                    copyCoords(inertiaStatus.upCoords, this.curCoords);\r\n\r\n                    this.pointers[0] = inertiaStatus.startEvent = startEvent =\r\n                        new InteractEvent(this, event, this.prepared.name, 'inertiastart', this.element);\r\n\r\n                    inertiaStatus.t0 = now;\r\n\r\n                    target.fire(inertiaStatus.startEvent);\r\n\r\n                    if (inertia) {\r\n                        inertiaStatus.vx0 = this.pointerDelta.client.vx;\r\n                        inertiaStatus.vy0 = this.pointerDelta.client.vy;\r\n                        inertiaStatus.v0 = pointerSpeed;\r\n\r\n                        this.calcInertia(inertiaStatus);\r\n\r\n                        var page = extend({}, this.curCoords.page),\r\n                            origin = getOriginXY(target, this.element),\r\n                            statusObject;\r\n\r\n                        page.x = page.x + inertiaStatus.xe - origin.x;\r\n                        page.y = page.y + inertiaStatus.ye - origin.y;\r\n\r\n                        statusObject = {\r\n                            useStatusXY: true,\r\n                            x: page.x,\r\n                            y: page.y,\r\n                            dx: 0,\r\n                            dy: 0,\r\n                            snap: null\r\n                        };\r\n\r\n                        statusObject.snap = statusObject;\r\n\r\n                        dx = dy = 0;\r\n\r\n                        if (endSnap) {\r\n                            var snap = this.setSnapping(this.curCoords.page, statusObject);\r\n\r\n                            if (snap.locked) {\r\n                                dx += snap.dx;\r\n                                dy += snap.dy;\r\n                            }\r\n                        }\r\n\r\n                        if (endRestrict) {\r\n                            var restrict = this.setRestriction(this.curCoords.page, statusObject);\r\n\r\n                            if (restrict.restricted) {\r\n                                dx += restrict.dx;\r\n                                dy += restrict.dy;\r\n                            }\r\n                        }\r\n\r\n                        inertiaStatus.modifiedXe += dx;\r\n                        inertiaStatus.modifiedYe += dy;\r\n\r\n                        inertiaStatus.i = reqFrame(this.boundInertiaFrame);\r\n                    }\r\n                    else {\r\n                        inertiaStatus.smoothEnd = true;\r\n                        inertiaStatus.xe = dx;\r\n                        inertiaStatus.ye = dy;\r\n\r\n                        inertiaStatus.sx = inertiaStatus.sy = 0;\r\n\r\n                        inertiaStatus.i = reqFrame(this.boundSmoothEndFrame);\r\n                    }\r\n\r\n                    inertiaStatus.active = true;\r\n                    return;\r\n                }\r\n\r\n                if (endSnap || endRestrict) {\r\n                    // fire a move event at the snapped coordinates\r\n                    this.pointerMove(pointer, event, eventTarget, curEventTarget, true);\r\n                }\r\n            }\r\n\r\n            if (this.dragging) {\r\n                endEvent = new InteractEvent(this, event, 'drag', 'end', this.element);\r\n\r\n                var draggableElement = this.element,\r\n                    drop = this.getDrop(endEvent, event, draggableElement);\r\n\r\n                this.dropTarget = drop.dropzone;\r\n                this.dropElement = drop.element;\r\n\r\n                var dropEvents = this.getDropEvents(event, endEvent);\r\n\r\n                if (dropEvents.leave) { this.prevDropTarget.fire(dropEvents.leave); }\r\n                if (dropEvents.enter) {     this.dropTarget.fire(dropEvents.enter); }\r\n                if (dropEvents.drop ) {     this.dropTarget.fire(dropEvents.drop ); }\r\n                if (dropEvents.deactivate) {\r\n                    this.fireActiveDrops(dropEvents.deactivate);\r\n                }\r\n\r\n                target.fire(endEvent);\r\n            }\r\n            else if (this.resizing) {\r\n                endEvent = new InteractEvent(this, event, 'resize', 'end', this.element);\r\n                target.fire(endEvent);\r\n            }\r\n            else if (this.gesturing) {\r\n                endEvent = new InteractEvent(this, event, 'gesture', 'end', this.element);\r\n                target.fire(endEvent);\r\n            }\r\n\r\n            this.stop(event);\r\n        },\r\n\r\n        collectDrops: function (element) {\r\n            var drops = [],\r\n                elements = [],\r\n                i;\r\n\r\n            element = element || this.element;\r\n\r\n            // collect all dropzones and their elements which qualify for a drop\r\n            for (i = 0; i < interactables.length; i++) {\r\n                if (!interactables[i].options.drop.enabled) { continue; }\r\n\r\n                var current = interactables[i],\r\n                    accept = current.options.drop.accept;\r\n\r\n                // test the draggable element against the dropzone's accept setting\r\n                if ((isElement(accept) && accept !== element)\r\n                    || (isString(accept)\r\n                        && !matchesSelector(element, accept))) {\r\n\r\n                    continue;\r\n                }\r\n\r\n                // query for new elements if necessary\r\n                var dropElements = current.selector? current._context.querySelectorAll(current.selector) : [current._element];\r\n\r\n                for (var j = 0, len = dropElements.length; j < len; j++) {\r\n                    var currentElement = dropElements[j];\r\n\r\n                    if (currentElement === element) {\r\n                        continue;\r\n                    }\r\n\r\n                    drops.push(current);\r\n                    elements.push(currentElement);\r\n                }\r\n            }\r\n\r\n            return {\r\n                dropzones: drops,\r\n                elements: elements\r\n            };\r\n        },\r\n\r\n        fireActiveDrops: function (event) {\r\n            var i,\r\n                current,\r\n                currentElement,\r\n                prevElement;\r\n\r\n            // loop through all active dropzones and trigger event\r\n            for (i = 0; i < this.activeDrops.dropzones.length; i++) {\r\n                current = this.activeDrops.dropzones[i];\r\n                currentElement = this.activeDrops.elements [i];\r\n\r\n                // prevent trigger of duplicate events on same element\r\n                if (currentElement !== prevElement) {\r\n                    // set current element as event target\r\n                    event.target = currentElement;\r\n                    current.fire(event);\r\n                }\r\n                prevElement = currentElement;\r\n            }\r\n        },\r\n\r\n        // Collect a new set of possible drops and save them in activeDrops.\r\n        // setActiveDrops should always be called when a drag has just started or a\r\n        // drag event happens while dynamicDrop is true\r\n        setActiveDrops: function (dragElement) {\r\n            // get dropzones and their elements that could receive the draggable\r\n            var possibleDrops = this.collectDrops(dragElement, true);\r\n\r\n            this.activeDrops.dropzones = possibleDrops.dropzones;\r\n            this.activeDrops.elements  = possibleDrops.elements;\r\n            this.activeDrops.rects     = [];\r\n\r\n            for (var i = 0; i < this.activeDrops.dropzones.length; i++) {\r\n                this.activeDrops.rects[i] = this.activeDrops.dropzones[i].getRect(this.activeDrops.elements[i]);\r\n            }\r\n        },\r\n\r\n        getDrop: function (dragEvent, event, dragElement) {\r\n            var validDrops = [];\r\n\r\n            if (dynamicDrop) {\r\n                this.setActiveDrops(dragElement);\r\n            }\r\n\r\n            // collect all dropzones and their elements which qualify for a drop\r\n            for (var j = 0; j < this.activeDrops.dropzones.length; j++) {\r\n                var current        = this.activeDrops.dropzones[j],\r\n                    currentElement = this.activeDrops.elements [j],\r\n                    rect           = this.activeDrops.rects    [j];\r\n\r\n                validDrops.push(current.dropCheck(dragEvent, event, this.target, dragElement, currentElement, rect)\r\n                                ? currentElement\r\n                                : null);\r\n            }\r\n\r\n            // get the most appropriate dropzone based on DOM depth and order\r\n            var dropIndex = indexOfDeepestElement(validDrops),\r\n                dropzone  = this.activeDrops.dropzones[dropIndex] || null,\r\n                element   = this.activeDrops.elements [dropIndex] || null;\r\n\r\n            return {\r\n                dropzone: dropzone,\r\n                element: element\r\n            };\r\n        },\r\n\r\n        getDropEvents: function (pointerEvent, dragEvent) {\r\n            var dropEvents = {\r\n                enter     : null,\r\n                leave     : null,\r\n                activate  : null,\r\n                deactivate: null,\r\n                move      : null,\r\n                drop      : null\r\n            };\r\n\r\n            if (this.dropElement !== this.prevDropElement) {\r\n                // if there was a prevDropTarget, create a dragleave event\r\n                if (this.prevDropTarget) {\r\n                    dropEvents.leave = {\r\n                        target       : this.prevDropElement,\r\n                        dropzone     : this.prevDropTarget,\r\n                        relatedTarget: dragEvent.target,\r\n                        draggable    : dragEvent.interactable,\r\n                        dragEvent    : dragEvent,\r\n                        interaction  : this,\r\n                        timeStamp    : dragEvent.timeStamp,\r\n                        type         : 'dragleave'\r\n                    };\r\n\r\n                    dragEvent.dragLeave = this.prevDropElement;\r\n                    dragEvent.prevDropzone = this.prevDropTarget;\r\n                }\r\n                // if the dropTarget is not null, create a dragenter event\r\n                if (this.dropTarget) {\r\n                    dropEvents.enter = {\r\n                        target       : this.dropElement,\r\n                        dropzone     : this.dropTarget,\r\n                        relatedTarget: dragEvent.target,\r\n                        draggable    : dragEvent.interactable,\r\n                        dragEvent    : dragEvent,\r\n                        interaction  : this,\r\n                        timeStamp    : dragEvent.timeStamp,\r\n                        type         : 'dragenter'\r\n                    };\r\n\r\n                    dragEvent.dragEnter = this.dropElement;\r\n                    dragEvent.dropzone = this.dropTarget;\r\n                }\r\n            }\r\n\r\n            if (dragEvent.type === 'dragend' && this.dropTarget) {\r\n                dropEvents.drop = {\r\n                    target       : this.dropElement,\r\n                    dropzone     : this.dropTarget,\r\n                    relatedTarget: dragEvent.target,\r\n                    draggable    : dragEvent.interactable,\r\n                    dragEvent    : dragEvent,\r\n                    interaction  : this,\r\n                    timeStamp    : dragEvent.timeStamp,\r\n                    type         : 'drop'\r\n                };\r\n\r\n                dragEvent.dropzone = this.dropTarget;\r\n            }\r\n            if (dragEvent.type === 'dragstart') {\r\n                dropEvents.activate = {\r\n                    target       : null,\r\n                    dropzone     : null,\r\n                    relatedTarget: dragEvent.target,\r\n                    draggable    : dragEvent.interactable,\r\n                    dragEvent    : dragEvent,\r\n                    interaction  : this,\r\n                    timeStamp    : dragEvent.timeStamp,\r\n                    type         : 'dropactivate'\r\n                };\r\n            }\r\n            if (dragEvent.type === 'dragend') {\r\n                dropEvents.deactivate = {\r\n                    target       : null,\r\n                    dropzone     : null,\r\n                    relatedTarget: dragEvent.target,\r\n                    draggable    : dragEvent.interactable,\r\n                    dragEvent    : dragEvent,\r\n                    interaction  : this,\r\n                    timeStamp    : dragEvent.timeStamp,\r\n                    type         : 'dropdeactivate'\r\n                };\r\n            }\r\n            if (dragEvent.type === 'dragmove' && this.dropTarget) {\r\n                dropEvents.move = {\r\n                    target       : this.dropElement,\r\n                    dropzone     : this.dropTarget,\r\n                    relatedTarget: dragEvent.target,\r\n                    draggable    : dragEvent.interactable,\r\n                    dragEvent    : dragEvent,\r\n                    interaction  : this,\r\n                    dragmove     : dragEvent,\r\n                    timeStamp    : dragEvent.timeStamp,\r\n                    type         : 'dropmove'\r\n                };\r\n                dragEvent.dropzone = this.dropTarget;\r\n            }\r\n\r\n            return dropEvents;\r\n        },\r\n\r\n        currentAction: function () {\r\n            return (this.dragging && 'drag') || (this.resizing && 'resize') || (this.gesturing && 'gesture') || null;\r\n        },\r\n\r\n        interacting: function () {\r\n            return this.dragging || this.resizing || this.gesturing;\r\n        },\r\n\r\n        clearTargets: function () {\r\n            this.target = this.element = null;\r\n\r\n            this.dropTarget = this.dropElement = this.prevDropTarget = this.prevDropElement = null;\r\n        },\r\n\r\n        stop: function (event) {\r\n            if (this.interacting()) {\r\n                autoScroll.stop();\r\n                this.matches = [];\r\n                this.matchElements = [];\r\n\r\n                var target = this.target;\r\n\r\n                if (target.options.styleCursor) {\r\n                    target._doc.documentElement.style.cursor = '';\r\n                }\r\n\r\n                // prevent Default only if were previously interacting\r\n                if (event && isFunction(event.preventDefault)) {\r\n                    this.checkAndPreventDefault(event, target, this.element);\r\n                }\r\n\r\n                if (this.dragging) {\r\n                    this.activeDrops.dropzones = this.activeDrops.elements = this.activeDrops.rects = null;\r\n                }\r\n            }\r\n\r\n            this.clearTargets();\r\n\r\n            this.pointerIsDown = this.snapStatus.locked = this.dragging = this.resizing = this.gesturing = false;\r\n            this.prepared.name = this.prevEvent = null;\r\n            this.inertiaStatus.resumeDx = this.inertiaStatus.resumeDy = 0;\r\n\r\n            // remove pointers if their ID isn't in this.pointerIds\r\n            for (var i = 0; i < this.pointers.length; i++) {\r\n                if (indexOf(this.pointerIds, getPointerId(this.pointers[i])) === -1) {\r\n                    this.pointers.splice(i, 1);\r\n                }\r\n            }\r\n        },\r\n\r\n        inertiaFrame: function () {\r\n            var inertiaStatus = this.inertiaStatus,\r\n                options = this.target.options[this.prepared.name].inertia,\r\n                lambda = options.resistance,\r\n                t = new Date().getTime() / 1000 - inertiaStatus.t0;\r\n\r\n            if (t < inertiaStatus.te) {\r\n\r\n                var progress =  1 - (Math.exp(-lambda * t) - inertiaStatus.lambda_v0) / inertiaStatus.one_ve_v0;\r\n\r\n                if (inertiaStatus.modifiedXe === inertiaStatus.xe && inertiaStatus.modifiedYe === inertiaStatus.ye) {\r\n                    inertiaStatus.sx = inertiaStatus.xe * progress;\r\n                    inertiaStatus.sy = inertiaStatus.ye * progress;\r\n                }\r\n                else {\r\n                    var quadPoint = getQuadraticCurvePoint(\r\n                            0, 0,\r\n                            inertiaStatus.xe, inertiaStatus.ye,\r\n                            inertiaStatus.modifiedXe, inertiaStatus.modifiedYe,\r\n                            progress);\r\n\r\n                    inertiaStatus.sx = quadPoint.x;\r\n                    inertiaStatus.sy = quadPoint.y;\r\n                }\r\n\r\n                this.pointerMove(inertiaStatus.startEvent, inertiaStatus.startEvent);\r\n\r\n                inertiaStatus.i = reqFrame(this.boundInertiaFrame);\r\n            }\r\n            else {\r\n                inertiaStatus.ending = true;\r\n\r\n                inertiaStatus.sx = inertiaStatus.modifiedXe;\r\n                inertiaStatus.sy = inertiaStatus.modifiedYe;\r\n\r\n                this.pointerMove(inertiaStatus.startEvent, inertiaStatus.startEvent);\r\n                this.pointerEnd(inertiaStatus.startEvent, inertiaStatus.startEvent);\r\n\r\n                inertiaStatus.active = inertiaStatus.ending = false;\r\n            }\r\n        },\r\n\r\n        smoothEndFrame: function () {\r\n            var inertiaStatus = this.inertiaStatus,\r\n                t = new Date().getTime() - inertiaStatus.t0,\r\n                duration = this.target.options[this.prepared.name].inertia.smoothEndDuration;\r\n\r\n            if (t < duration) {\r\n                inertiaStatus.sx = easeOutQuad(t, 0, inertiaStatus.xe, duration);\r\n                inertiaStatus.sy = easeOutQuad(t, 0, inertiaStatus.ye, duration);\r\n\r\n                this.pointerMove(inertiaStatus.startEvent, inertiaStatus.startEvent);\r\n\r\n                inertiaStatus.i = reqFrame(this.boundSmoothEndFrame);\r\n            }\r\n            else {\r\n                inertiaStatus.ending = true;\r\n\r\n                inertiaStatus.sx = inertiaStatus.xe;\r\n                inertiaStatus.sy = inertiaStatus.ye;\r\n\r\n                this.pointerMove(inertiaStatus.startEvent, inertiaStatus.startEvent);\r\n                this.pointerEnd(inertiaStatus.startEvent, inertiaStatus.startEvent);\r\n\r\n                inertiaStatus.smoothEnd =\r\n                  inertiaStatus.active = inertiaStatus.ending = false;\r\n            }\r\n        },\r\n\r\n        addPointer: function (pointer) {\r\n            var id = getPointerId(pointer),\r\n                index = this.mouse? 0 : indexOf(this.pointerIds, id);\r\n\r\n            if (index === -1) {\r\n                index = this.pointerIds.length;\r\n            }\r\n\r\n            this.pointerIds[index] = id;\r\n            this.pointers[index] = pointer;\r\n\r\n            return index;\r\n        },\r\n\r\n        removePointer: function (pointer) {\r\n            var id = getPointerId(pointer),\r\n                index = this.mouse? 0 : indexOf(this.pointerIds, id);\r\n\r\n            if (index === -1) { return; }\r\n\r\n            this.pointers   .splice(index, 1);\r\n            this.pointerIds .splice(index, 1);\r\n            this.downTargets.splice(index, 1);\r\n            this.downTimes  .splice(index, 1);\r\n            this.holdTimers .splice(index, 1);\r\n        },\r\n\r\n        recordPointer: function (pointer) {\r\n            var index = this.mouse? 0: indexOf(this.pointerIds, getPointerId(pointer));\r\n\r\n            if (index === -1) { return; }\r\n\r\n            this.pointers[index] = pointer;\r\n        },\r\n\r\n        collectEventTargets: function (pointer, event, eventTarget, eventType) {\r\n            var pointerIndex = this.mouse? 0 : indexOf(this.pointerIds, getPointerId(pointer));\r\n\r\n            // do not fire a tap event if the pointer was moved before being lifted\r\n            if (eventType === 'tap' && (this.pointerWasMoved\r\n                // or if the pointerup target is different to the pointerdown target\r\n                || !(this.downTargets[pointerIndex] && this.downTargets[pointerIndex] === eventTarget))) {\r\n                return;\r\n            }\r\n\r\n            var targets = [],\r\n                elements = [],\r\n                element = eventTarget;\r\n\r\n            function collectSelectors (interactable, selector, context) {\r\n                var els = ie8MatchesSelector\r\n                        ? context.querySelectorAll(selector)\r\n                        : undefined;\r\n\r\n                if (interactable._iEvents[eventType]\r\n                    && isElement(element)\r\n                    && inContext(interactable, element)\r\n                    && !testIgnore(interactable, element, eventTarget)\r\n                    && testAllow(interactable, element, eventTarget)\r\n                    && matchesSelector(element, selector, els)) {\r\n\r\n                    targets.push(interactable);\r\n                    elements.push(element);\r\n                }\r\n            }\r\n\r\n            while (element) {\r\n                if (interact.isSet(element) && interact(element)._iEvents[eventType]) {\r\n                    targets.push(interact(element));\r\n                    elements.push(element);\r\n                }\r\n\r\n                interactables.forEachSelector(collectSelectors);\r\n\r\n                element = parentElement(element);\r\n            }\r\n\r\n            // create the tap event even if there are no listeners so that\r\n            // doubletap can still be created and fired\r\n            if (targets.length || eventType === 'tap') {\r\n                this.firePointers(pointer, event, eventTarget, targets, elements, eventType);\r\n            }\r\n        },\r\n\r\n        firePointers: function (pointer, event, eventTarget, targets, elements, eventType) {\r\n            var pointerIndex = this.mouse? 0 : indexOf(this.pointerIds, getPointerId(pointer)),\r\n                pointerEvent = {},\r\n                i,\r\n                // for tap events\r\n                interval, createNewDoubleTap;\r\n\r\n            // if it's a doubletap then the event properties would have been\r\n            // copied from the tap event and provided as the pointer argument\r\n            if (eventType === 'doubletap') {\r\n                pointerEvent = pointer;\r\n            }\r\n            else {\r\n                pointerExtend(pointerEvent, event);\r\n                if (event !== pointer) {\r\n                    pointerExtend(pointerEvent, pointer);\r\n                }\r\n\r\n                pointerEvent.preventDefault           = preventOriginalDefault;\r\n                pointerEvent.stopPropagation          = InteractEvent.prototype.stopPropagation;\r\n                pointerEvent.stopImmediatePropagation = InteractEvent.prototype.stopImmediatePropagation;\r\n                pointerEvent.interaction              = this;\r\n\r\n                pointerEvent.timeStamp       = new Date().getTime();\r\n                pointerEvent.originalEvent   = event;\r\n                pointerEvent.originalPointer = pointer;\r\n                pointerEvent.type            = eventType;\r\n                pointerEvent.pointerId       = getPointerId(pointer);\r\n                pointerEvent.pointerType     = this.mouse? 'mouse' : !supportsPointerEvent? 'touch'\r\n                                                    : isString(pointer.pointerType)\r\n                                                        ? pointer.pointerType\r\n                                                        : [,,'touch', 'pen', 'mouse'][pointer.pointerType];\r\n            }\r\n\r\n            if (eventType === 'tap') {\r\n                pointerEvent.dt = pointerEvent.timeStamp - this.downTimes[pointerIndex];\r\n\r\n                interval = pointerEvent.timeStamp - this.tapTime;\r\n                createNewDoubleTap = !!(this.prevTap && this.prevTap.type !== 'doubletap'\r\n                       && this.prevTap.target === pointerEvent.target\r\n                       && interval < 500);\r\n\r\n                pointerEvent.double = createNewDoubleTap;\r\n\r\n                this.tapTime = pointerEvent.timeStamp;\r\n            }\r\n\r\n            for (i = 0; i < targets.length; i++) {\r\n                pointerEvent.currentTarget = elements[i];\r\n                pointerEvent.interactable = targets[i];\r\n                targets[i].fire(pointerEvent);\r\n\r\n                if (pointerEvent.immediatePropagationStopped\r\n                    ||(pointerEvent.propagationStopped && elements[i + 1] !== pointerEvent.currentTarget)) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (createNewDoubleTap) {\r\n                var doubleTap = {};\r\n\r\n                extend(doubleTap, pointerEvent);\r\n\r\n                doubleTap.dt   = interval;\r\n                doubleTap.type = 'doubletap';\r\n\r\n                this.collectEventTargets(doubleTap, event, eventTarget, 'doubletap');\r\n\r\n                this.prevTap = doubleTap;\r\n            }\r\n            else if (eventType === 'tap') {\r\n                this.prevTap = pointerEvent;\r\n            }\r\n        },\r\n\r\n        validateSelector: function (pointer, event, matches, matchElements) {\r\n            for (var i = 0, len = matches.length; i < len; i++) {\r\n                var match = matches[i],\r\n                    matchElement = matchElements[i],\r\n                    action = validateAction(match.getAction(pointer, event, this, matchElement), match);\r\n\r\n                if (action && withinInteractionLimit(match, matchElement, action)) {\r\n                    this.target = match;\r\n                    this.element = matchElement;\r\n\r\n                    return action;\r\n                }\r\n            }\r\n        },\r\n\r\n        setSnapping: function (pageCoords, status) {\r\n            var snap = this.target.options[this.prepared.name].snap,\r\n                targets = [],\r\n                target,\r\n                page,\r\n                i;\r\n\r\n            status = status || this.snapStatus;\r\n\r\n            if (status.useStatusXY) {\r\n                page = { x: status.x, y: status.y };\r\n            }\r\n            else {\r\n                var origin = getOriginXY(this.target, this.element);\r\n\r\n                page = extend({}, pageCoords);\r\n\r\n                page.x -= origin.x;\r\n                page.y -= origin.y;\r\n            }\r\n\r\n            status.realX = page.x;\r\n            status.realY = page.y;\r\n\r\n            page.x = page.x - this.inertiaStatus.resumeDx;\r\n            page.y = page.y - this.inertiaStatus.resumeDy;\r\n\r\n            var len = snap.targets? snap.targets.length : 0;\r\n\r\n            for (var relIndex = 0; relIndex < this.snapOffsets.length; relIndex++) {\r\n                var relative = {\r\n                    x: page.x - this.snapOffsets[relIndex].x,\r\n                    y: page.y - this.snapOffsets[relIndex].y\r\n                };\r\n\r\n                for (i = 0; i < len; i++) {\r\n                    if (isFunction(snap.targets[i])) {\r\n                        target = snap.targets[i](relative.x, relative.y, this);\r\n                    }\r\n                    else {\r\n                        target = snap.targets[i];\r\n                    }\r\n\r\n                    if (!target) { continue; }\r\n\r\n                    targets.push({\r\n                        x: isNumber(target.x) ? (target.x + this.snapOffsets[relIndex].x) : relative.x,\r\n                        y: isNumber(target.y) ? (target.y + this.snapOffsets[relIndex].y) : relative.y,\r\n\r\n                        range: isNumber(target.range)? target.range: snap.range\r\n                    });\r\n                }\r\n            }\r\n\r\n            var closest = {\r\n                    target: null,\r\n                    inRange: false,\r\n                    distance: 0,\r\n                    range: 0,\r\n                    dx: 0,\r\n                    dy: 0\r\n                };\r\n\r\n            for (i = 0, len = targets.length; i < len; i++) {\r\n                target = targets[i];\r\n\r\n                var range = target.range,\r\n                    dx = target.x - page.x,\r\n                    dy = target.y - page.y,\r\n                    distance = hypot(dx, dy),\r\n                    inRange = distance <= range;\r\n\r\n                // Infinite targets count as being out of range\r\n                // compared to non infinite ones that are in range\r\n                if (range === Infinity && closest.inRange && closest.range !== Infinity) {\r\n                    inRange = false;\r\n                }\r\n\r\n                if (!closest.target || (inRange\r\n                    // is the closest target in range?\r\n                    ? (closest.inRange && range !== Infinity\r\n                        // the pointer is relatively deeper in this target\r\n                        ? distance / range < closest.distance / closest.range\r\n                        // this target has Infinite range and the closest doesn't\r\n                        : (range === Infinity && closest.range !== Infinity)\r\n                            // OR this target is closer that the previous closest\r\n                            || distance < closest.distance)\r\n                    // The other is not in range and the pointer is closer to this target\r\n                    : (!closest.inRange && distance < closest.distance))) {\r\n\r\n                    if (range === Infinity) {\r\n                        inRange = true;\r\n                    }\r\n\r\n                    closest.target = target;\r\n                    closest.distance = distance;\r\n                    closest.range = range;\r\n                    closest.inRange = inRange;\r\n                    closest.dx = dx;\r\n                    closest.dy = dy;\r\n\r\n                    status.range = range;\r\n                }\r\n            }\r\n\r\n            var snapChanged;\r\n\r\n            if (closest.target) {\r\n                snapChanged = (status.snappedX !== closest.target.x || status.snappedY !== closest.target.y);\r\n\r\n                status.snappedX = closest.target.x;\r\n                status.snappedY = closest.target.y;\r\n            }\r\n            else {\r\n                snapChanged = true;\r\n\r\n                status.snappedX = NaN;\r\n                status.snappedY = NaN;\r\n            }\r\n\r\n            status.dx = closest.dx;\r\n            status.dy = closest.dy;\r\n\r\n            status.changed = (snapChanged || (closest.inRange && !status.locked));\r\n            status.locked = closest.inRange;\r\n\r\n            return status;\r\n        },\r\n\r\n        setRestriction: function (pageCoords, status) {\r\n            var target = this.target,\r\n                restrict = target && target.options[this.prepared.name].restrict,\r\n                restriction = restrict && restrict.restriction,\r\n                page;\r\n\r\n            if (!restriction) {\r\n                return status;\r\n            }\r\n\r\n            status = status || this.restrictStatus;\r\n\r\n            page = status.useStatusXY\r\n                    ? page = { x: status.x, y: status.y }\r\n                    : page = extend({}, pageCoords);\r\n\r\n            if (status.snap && status.snap.locked) {\r\n                page.x += status.snap.dx || 0;\r\n                page.y += status.snap.dy || 0;\r\n            }\r\n\r\n            page.x -= this.inertiaStatus.resumeDx;\r\n            page.y -= this.inertiaStatus.resumeDy;\r\n\r\n            status.dx = 0;\r\n            status.dy = 0;\r\n            status.restricted = false;\r\n\r\n            var rect, restrictedX, restrictedY;\r\n\r\n            if (isString(restriction)) {\r\n                if (restriction === 'parent') {\r\n                    restriction = parentElement(this.element);\r\n                }\r\n                else if (restriction === 'self') {\r\n                    restriction = target.getRect(this.element);\r\n                }\r\n                else {\r\n                    restriction = closest(this.element, restriction);\r\n                }\r\n\r\n                if (!restriction) { return status; }\r\n            }\r\n\r\n            if (isFunction(restriction)) {\r\n                restriction = restriction(page.x, page.y, this.element);\r\n            }\r\n\r\n            if (isElement(restriction)) {\r\n                restriction = getElementRect(restriction);\r\n            }\r\n\r\n            rect = restriction;\r\n\r\n            if (!restriction) {\r\n                restrictedX = page.x;\r\n                restrictedY = page.y;\r\n            }\r\n            // object is assumed to have\r\n            // x, y, width, height or\r\n            // left, top, right, bottom\r\n            else if ('x' in restriction && 'y' in restriction) {\r\n                restrictedX = Math.max(Math.min(rect.x + rect.width  - this.restrictOffset.right , page.x), rect.x + this.restrictOffset.left);\r\n                restrictedY = Math.max(Math.min(rect.y + rect.height - this.restrictOffset.bottom, page.y), rect.y + this.restrictOffset.top );\r\n            }\r\n            else {\r\n                restrictedX = Math.max(Math.min(rect.right  - this.restrictOffset.right , page.x), rect.left + this.restrictOffset.left);\r\n                restrictedY = Math.max(Math.min(rect.bottom - this.restrictOffset.bottom, page.y), rect.top  + this.restrictOffset.top );\r\n            }\r\n\r\n            status.dx = restrictedX - page.x;\r\n            status.dy = restrictedY - page.y;\r\n\r\n            status.changed = status.restrictedX !== restrictedX || status.restrictedY !== restrictedY;\r\n            status.restricted = !!(status.dx || status.dy);\r\n\r\n            status.restrictedX = restrictedX;\r\n            status.restrictedY = restrictedY;\r\n\r\n            return status;\r\n        },\r\n\r\n        checkAndPreventDefault: function (event, interactable, element) {\r\n            if (!(interactable = interactable || this.target)) { return; }\r\n\r\n            var options = interactable.options,\r\n                prevent = options.preventDefault;\r\n\r\n            if (prevent === 'auto' && element && !/^(input|select|textarea)$/i.test(event.target.nodeName)) {\r\n                // do not preventDefault on pointerdown if the prepared action is a drag\r\n                // and dragging can only start from a certain direction - this allows\r\n                // a touch to pan the viewport if a drag isn't in the right direction\r\n                if (/down|start/i.test(event.type)\r\n                    && this.prepared.name === 'drag' && options.drag.axis !== 'xy') {\r\n\r\n                    return;\r\n                }\r\n\r\n                // with manualStart, only preventDefault while interacting\r\n                if (options[this.prepared.name] && options[this.prepared.name].manualStart\r\n                    && !this.interacting()) {\r\n                    return;\r\n                }\r\n\r\n                event.preventDefault();\r\n                return;\r\n            }\r\n\r\n            if (prevent === 'always') {\r\n                event.preventDefault();\r\n                return;\r\n            }\r\n        },\r\n\r\n        calcInertia: function (status) {\r\n            var inertiaOptions = this.target.options[this.prepared.name].inertia,\r\n                lambda = inertiaOptions.resistance,\r\n                inertiaDur = -Math.log(inertiaOptions.endSpeed / status.v0) / lambda;\r\n\r\n            status.x0 = this.prevEvent.pageX;\r\n            status.y0 = this.prevEvent.pageY;\r\n            status.t0 = status.startEvent.timeStamp / 1000;\r\n            status.sx = status.sy = 0;\r\n\r\n            status.modifiedXe = status.xe = (status.vx0 - inertiaDur) / lambda;\r\n            status.modifiedYe = status.ye = (status.vy0 - inertiaDur) / lambda;\r\n            status.te = inertiaDur;\r\n\r\n            status.lambda_v0 = lambda / status.v0;\r\n            status.one_ve_v0 = 1 - inertiaOptions.endSpeed / status.v0;\r\n        },\r\n\r\n        autoScrollMove: function (pointer) {\r\n            if (!(this.interacting()\r\n                && checkAutoScroll(this.target, this.prepared.name))) {\r\n                return;\r\n            }\r\n\r\n            if (this.inertiaStatus.active) {\r\n                autoScroll.x = autoScroll.y = 0;\r\n                return;\r\n            }\r\n\r\n            var top,\r\n                right,\r\n                bottom,\r\n                left,\r\n                options = this.target.options[this.prepared.name].autoScroll,\r\n                container = options.container || getWindow(this.element);\r\n\r\n            if (isWindow(container)) {\r\n                left   = pointer.clientX < autoScroll.margin;\r\n                top    = pointer.clientY < autoScroll.margin;\r\n                right  = pointer.clientX > container.innerWidth  - autoScroll.margin;\r\n                bottom = pointer.clientY > container.innerHeight - autoScroll.margin;\r\n            }\r\n            else {\r\n                var rect = getElementClientRect(container);\r\n\r\n                left   = pointer.clientX < rect.left   + autoScroll.margin;\r\n                top    = pointer.clientY < rect.top    + autoScroll.margin;\r\n                right  = pointer.clientX > rect.right  - autoScroll.margin;\r\n                bottom = pointer.clientY > rect.bottom - autoScroll.margin;\r\n            }\r\n\r\n            autoScroll.x = (right ? 1: left? -1: 0);\r\n            autoScroll.y = (bottom? 1:  top? -1: 0);\r\n\r\n            if (!autoScroll.isScrolling) {\r\n                // set the autoScroll properties to those of the target\r\n                autoScroll.margin = options.margin;\r\n                autoScroll.speed  = options.speed;\r\n\r\n                autoScroll.start(this);\r\n            }\r\n        },\r\n\r\n        _updateEventTargets: function (target, currentTarget) {\r\n            this._eventTarget    = target;\r\n            this._curEventTarget = currentTarget;\r\n        }\r\n\r\n    };\r\n\r\n    function getInteractionFromPointer (pointer, eventType, eventTarget) {\r\n        var i = 0, len = interactions.length,\r\n            mouseEvent = (/mouse/i.test(pointer.pointerType || eventType)\r\n                          // MSPointerEvent.MSPOINTER_TYPE_MOUSE\r\n                          || pointer.pointerType === 4),\r\n            interaction;\r\n\r\n        var id = getPointerId(pointer);\r\n\r\n        // try to resume inertia with a new pointer\r\n        if (/down|start/i.test(eventType)) {\r\n            for (i = 0; i < len; i++) {\r\n                interaction = interactions[i];\r\n\r\n                var element = eventTarget;\r\n\r\n                if (interaction.inertiaStatus.active && interaction.target.options[interaction.prepared.name].inertia.allowResume\r\n                    && (interaction.mouse === mouseEvent)) {\r\n                    while (element) {\r\n                        // if the element is the interaction element\r\n                        if (element === interaction.element) {\r\n                            return interaction;\r\n                        }\r\n                        element = parentElement(element);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // if it's a mouse interaction\r\n        if (mouseEvent || !(supportsTouch || supportsPointerEvent)) {\r\n\r\n            // find a mouse interaction that's not in inertia phase\r\n            for (i = 0; i < len; i++) {\r\n                if (interactions[i].mouse && !interactions[i].inertiaStatus.active) {\r\n                    return interactions[i];\r\n                }\r\n            }\r\n\r\n            // find any interaction specifically for mouse.\r\n            // if the eventType is a mousedown, and inertia is active\r\n            // ignore the interaction\r\n            for (i = 0; i < len; i++) {\r\n                if (interactions[i].mouse && !(/down/.test(eventType) && interactions[i].inertiaStatus.active)) {\r\n                    return interaction;\r\n                }\r\n            }\r\n\r\n            // create a new interaction for mouse\r\n            interaction = new Interaction();\r\n            interaction.mouse = true;\r\n\r\n            return interaction;\r\n        }\r\n\r\n        // get interaction that has this pointer\r\n        for (i = 0; i < len; i++) {\r\n            if (contains(interactions[i].pointerIds, id)) {\r\n                return interactions[i];\r\n            }\r\n        }\r\n\r\n        // at this stage, a pointerUp should not return an interaction\r\n        if (/up|end|out/i.test(eventType)) {\r\n            return null;\r\n        }\r\n\r\n        // get first idle interaction\r\n        for (i = 0; i < len; i++) {\r\n            interaction = interactions[i];\r\n\r\n            if ((!interaction.prepared.name || (interaction.target.options.gesture.enabled))\r\n                && !interaction.interacting()\r\n                && !(!mouseEvent && interaction.mouse)) {\r\n\r\n                return interaction;\r\n            }\r\n        }\r\n\r\n        return new Interaction();\r\n    }\r\n\r\n    function doOnInteractions (method) {\r\n        return (function (event) {\r\n            var interaction,\r\n                eventTarget = getActualElement(event.path\r\n                                               ? event.path[0]\r\n                                               : event.target),\r\n                curEventTarget = getActualElement(event.currentTarget),\r\n                i;\r\n\r\n            if (supportsTouch && /touch/.test(event.type)) {\r\n                prevTouchTime = new Date().getTime();\r\n\r\n                for (i = 0; i < event.changedTouches.length; i++) {\r\n                    var pointer = event.changedTouches[i];\r\n\r\n                    interaction = getInteractionFromPointer(pointer, event.type, eventTarget);\r\n\r\n                    if (!interaction) { continue; }\r\n\r\n                    interaction._updateEventTargets(eventTarget, curEventTarget);\r\n\r\n                    interaction[method](pointer, event, eventTarget, curEventTarget);\r\n                }\r\n            }\r\n            else {\r\n                if (!supportsPointerEvent && /mouse/.test(event.type)) {\r\n                    // ignore mouse events while touch interactions are active\r\n                    for (i = 0; i < interactions.length; i++) {\r\n                        if (!interactions[i].mouse && interactions[i].pointerIsDown) {\r\n                            return;\r\n                        }\r\n                    }\r\n\r\n                    // try to ignore mouse events that are simulated by the browser\r\n                    // after a touch event\r\n                    if (new Date().getTime() - prevTouchTime < 500) {\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                interaction = getInteractionFromPointer(event, event.type, eventTarget);\r\n\r\n                if (!interaction) { return; }\r\n\r\n                interaction._updateEventTargets(eventTarget, curEventTarget);\r\n\r\n                interaction[method](event, event, eventTarget, curEventTarget);\r\n            }\r\n        });\r\n    }\r\n\r\n    function InteractEvent (interaction, event, action, phase, element, related) {\r\n        var client,\r\n            page,\r\n            target      = interaction.target,\r\n            snapStatus  = interaction.snapStatus,\r\n            restrictStatus  = interaction.restrictStatus,\r\n            pointers    = interaction.pointers,\r\n            deltaSource = (target && target.options || defaultOptions).deltaSource,\r\n            sourceX     = deltaSource + 'X',\r\n            sourceY     = deltaSource + 'Y',\r\n            options     = target? target.options: defaultOptions,\r\n            origin      = getOriginXY(target, element),\r\n            starting    = phase === 'start',\r\n            ending      = phase === 'end',\r\n            coords      = starting? interaction.startCoords : interaction.curCoords;\r\n\r\n        element = element || interaction.element;\r\n\r\n        page   = extend({}, coords.page);\r\n        client = extend({}, coords.client);\r\n\r\n        page.x -= origin.x;\r\n        page.y -= origin.y;\r\n\r\n        client.x -= origin.x;\r\n        client.y -= origin.y;\r\n\r\n        var relativePoints = options[action].snap && options[action].snap.relativePoints ;\r\n\r\n        if (checkSnap(target, action) && !(starting && relativePoints && relativePoints.length)) {\r\n            this.snap = {\r\n                range  : snapStatus.range,\r\n                locked : snapStatus.locked,\r\n                x      : snapStatus.snappedX,\r\n                y      : snapStatus.snappedY,\r\n                realX  : snapStatus.realX,\r\n                realY  : snapStatus.realY,\r\n                dx     : snapStatus.dx,\r\n                dy     : snapStatus.dy\r\n            };\r\n\r\n            if (snapStatus.locked) {\r\n                page.x += snapStatus.dx;\r\n                page.y += snapStatus.dy;\r\n                client.x += snapStatus.dx;\r\n                client.y += snapStatus.dy;\r\n            }\r\n        }\r\n\r\n        if (checkRestrict(target, action) && !(starting && options[action].restrict.elementRect) && restrictStatus.restricted) {\r\n            page.x += restrictStatus.dx;\r\n            page.y += restrictStatus.dy;\r\n            client.x += restrictStatus.dx;\r\n            client.y += restrictStatus.dy;\r\n\r\n            this.restrict = {\r\n                dx: restrictStatus.dx,\r\n                dy: restrictStatus.dy\r\n            };\r\n        }\r\n\r\n        this.pageX     = page.x;\r\n        this.pageY     = page.y;\r\n        this.clientX   = client.x;\r\n        this.clientY   = client.y;\r\n\r\n        this.x0        = interaction.startCoords.page.x - origin.x;\r\n        this.y0        = interaction.startCoords.page.y - origin.y;\r\n        this.clientX0  = interaction.startCoords.client.x - origin.x;\r\n        this.clientY0  = interaction.startCoords.client.y - origin.y;\r\n        this.ctrlKey   = event.ctrlKey;\r\n        this.altKey    = event.altKey;\r\n        this.shiftKey  = event.shiftKey;\r\n        this.metaKey   = event.metaKey;\r\n        this.button    = event.button;\r\n        this.buttons   = event.buttons;\r\n        this.target    = element;\r\n        this.t0        = interaction.downTimes[0];\r\n        this.type      = action + (phase || '');\r\n\r\n        this.interaction = interaction;\r\n        this.interactable = target;\r\n\r\n        var inertiaStatus = interaction.inertiaStatus;\r\n\r\n        if (inertiaStatus.active) {\r\n            this.detail = 'inertia';\r\n        }\r\n\r\n        if (related) {\r\n            this.relatedTarget = related;\r\n        }\r\n\r\n        // end event dx, dy is difference between start and end points\r\n        if (ending) {\r\n            if (deltaSource === 'client') {\r\n                this.dx = client.x - interaction.startCoords.client.x;\r\n                this.dy = client.y - interaction.startCoords.client.y;\r\n            }\r\n            else {\r\n                this.dx = page.x - interaction.startCoords.page.x;\r\n                this.dy = page.y - interaction.startCoords.page.y;\r\n            }\r\n        }\r\n        else if (starting) {\r\n            this.dx = 0;\r\n            this.dy = 0;\r\n        }\r\n        // copy properties from previousmove if starting inertia\r\n        else if (phase === 'inertiastart') {\r\n            this.dx = interaction.prevEvent.dx;\r\n            this.dy = interaction.prevEvent.dy;\r\n        }\r\n        else {\r\n            if (deltaSource === 'client') {\r\n                this.dx = client.x - interaction.prevEvent.clientX;\r\n                this.dy = client.y - interaction.prevEvent.clientY;\r\n            }\r\n            else {\r\n                this.dx = page.x - interaction.prevEvent.pageX;\r\n                this.dy = page.y - interaction.prevEvent.pageY;\r\n            }\r\n        }\r\n        if (interaction.prevEvent && interaction.prevEvent.detail === 'inertia'\r\n            && !inertiaStatus.active\r\n            && options[action].inertia && options[action].inertia.zeroResumeDelta) {\r\n\r\n            inertiaStatus.resumeDx += this.dx;\r\n            inertiaStatus.resumeDy += this.dy;\r\n\r\n            this.dx = this.dy = 0;\r\n        }\r\n\r\n        if (action === 'resize' && interaction.resizeAxes) {\r\n            if (options.resize.square) {\r\n                if (interaction.resizeAxes === 'y') {\r\n                    this.dx = this.dy;\r\n                }\r\n                else {\r\n                    this.dy = this.dx;\r\n                }\r\n                this.axes = 'xy';\r\n            }\r\n            else {\r\n                this.axes = interaction.resizeAxes;\r\n\r\n                if (interaction.resizeAxes === 'x') {\r\n                    this.dy = 0;\r\n                }\r\n                else if (interaction.resizeAxes === 'y') {\r\n                    this.dx = 0;\r\n                }\r\n            }\r\n        }\r\n        else if (action === 'gesture') {\r\n            this.touches = [pointers[0], pointers[1]];\r\n\r\n            if (starting) {\r\n                this.distance = touchDistance(pointers, deltaSource);\r\n                this.box      = touchBBox(pointers);\r\n                this.scale    = 1;\r\n                this.ds       = 0;\r\n                this.angle    = touchAngle(pointers, undefined, deltaSource);\r\n                this.da       = 0;\r\n            }\r\n            else if (ending || event instanceof InteractEvent) {\r\n                this.distance = interaction.prevEvent.distance;\r\n                this.box      = interaction.prevEvent.box;\r\n                this.scale    = interaction.prevEvent.scale;\r\n                this.ds       = this.scale - 1;\r\n                this.angle    = interaction.prevEvent.angle;\r\n                this.da       = this.angle - interaction.gesture.startAngle;\r\n            }\r\n            else {\r\n                this.distance = touchDistance(pointers, deltaSource);\r\n                this.box      = touchBBox(pointers);\r\n                this.scale    = this.distance / interaction.gesture.startDistance;\r\n                this.angle    = touchAngle(pointers, interaction.gesture.prevAngle, deltaSource);\r\n\r\n                this.ds = this.scale - interaction.gesture.prevScale;\r\n                this.da = this.angle - interaction.gesture.prevAngle;\r\n            }\r\n        }\r\n\r\n        if (starting) {\r\n            this.timeStamp = interaction.downTimes[0];\r\n            this.dt        = 0;\r\n            this.duration  = 0;\r\n            this.speed     = 0;\r\n            this.velocityX = 0;\r\n            this.velocityY = 0;\r\n        }\r\n        else if (phase === 'inertiastart') {\r\n            this.timeStamp = interaction.prevEvent.timeStamp;\r\n            this.dt        = interaction.prevEvent.dt;\r\n            this.duration  = interaction.prevEvent.duration;\r\n            this.speed     = interaction.prevEvent.speed;\r\n            this.velocityX = interaction.prevEvent.velocityX;\r\n            this.velocityY = interaction.prevEvent.velocityY;\r\n        }\r\n        else {\r\n            this.timeStamp = new Date().getTime();\r\n            this.dt        = this.timeStamp - interaction.prevEvent.timeStamp;\r\n            this.duration  = this.timeStamp - interaction.downTimes[0];\r\n\r\n            if (event instanceof InteractEvent) {\r\n                var dx = this[sourceX] - interaction.prevEvent[sourceX],\r\n                    dy = this[sourceY] - interaction.prevEvent[sourceY],\r\n                    dt = this.dt / 1000;\r\n\r\n                this.speed = hypot(dx, dy) / dt;\r\n                this.velocityX = dx / dt;\r\n                this.velocityY = dy / dt;\r\n            }\r\n            // if normal move or end event, use previous user event coords\r\n            else {\r\n                // speed and velocity in pixels per second\r\n                this.speed = interaction.pointerDelta[deltaSource].speed;\r\n                this.velocityX = interaction.pointerDelta[deltaSource].vx;\r\n                this.velocityY = interaction.pointerDelta[deltaSource].vy;\r\n            }\r\n        }\r\n\r\n        if ((ending || phase === 'inertiastart')\r\n            && interaction.prevEvent.speed > 600 && this.timeStamp - interaction.prevEvent.timeStamp < 150) {\r\n\r\n            var angle = 180 * Math.atan2(interaction.prevEvent.velocityY, interaction.prevEvent.velocityX) / Math.PI,\r\n                overlap = 22.5;\r\n\r\n            if (angle < 0) {\r\n                angle += 360;\r\n            }\r\n\r\n            var left = 135 - overlap <= angle && angle < 225 + overlap,\r\n                up   = 225 - overlap <= angle && angle < 315 + overlap,\r\n\r\n                right = !left && (315 - overlap <= angle || angle <  45 + overlap),\r\n                down  = !up   &&   45 - overlap <= angle && angle < 135 + overlap;\r\n\r\n            this.swipe = {\r\n                up   : up,\r\n                down : down,\r\n                left : left,\r\n                right: right,\r\n                angle: angle,\r\n                speed: interaction.prevEvent.speed,\r\n                velocity: {\r\n                    x: interaction.prevEvent.velocityX,\r\n                    y: interaction.prevEvent.velocityY\r\n                }\r\n            };\r\n        }\r\n    }\r\n\r\n    InteractEvent.prototype = {\r\n        preventDefault: blank,\r\n        stopImmediatePropagation: function () {\r\n            this.immediatePropagationStopped = this.propagationStopped = true;\r\n        },\r\n        stopPropagation: function () {\r\n            this.propagationStopped = true;\r\n        }\r\n    };\r\n\r\n    function preventOriginalDefault () {\r\n        this.originalEvent.preventDefault();\r\n    }\r\n\r\n    function getActionCursor (action) {\r\n        var cursor = '';\r\n\r\n        if (action.name === 'drag') {\r\n            cursor =  actionCursors.drag;\r\n        }\r\n        if (action.name === 'resize') {\r\n            if (action.axis) {\r\n                cursor =  actionCursors[action.name + action.axis];\r\n            }\r\n            else if (action.edges) {\r\n                var cursorKey = 'resize',\r\n                    edgeNames = ['top', 'bottom', 'left', 'right'];\r\n\r\n                for (var i = 0; i < 4; i++) {\r\n                    if (action.edges[edgeNames[i]]) {\r\n                        cursorKey += edgeNames[i];\r\n                    }\r\n                }\r\n\r\n                cursor = actionCursors[cursorKey];\r\n            }\r\n        }\r\n\r\n        return cursor;\r\n    }\r\n\r\n    function checkResizeEdge (name, value, page, element, interactableElement, rect, margin) {\r\n        // false, '', undefined, null\r\n        if (!value) { return false; }\r\n\r\n        // true value, use pointer coords and element rect\r\n        if (value === true) {\r\n            // if dimensions are negative, \"switch\" edges\r\n            var width = isNumber(rect.width)? rect.width : rect.right - rect.left,\r\n                height = isNumber(rect.height)? rect.height : rect.bottom - rect.top;\r\n\r\n            if (width < 0) {\r\n                if      (name === 'left' ) { name = 'right'; }\r\n                else if (name === 'right') { name = 'left' ; }\r\n            }\r\n            if (height < 0) {\r\n                if      (name === 'top'   ) { name = 'bottom'; }\r\n                else if (name === 'bottom') { name = 'top'   ; }\r\n            }\r\n\r\n            if (name === 'left'  ) { return page.x < ((width  >= 0? rect.left: rect.right ) + margin); }\r\n            if (name === 'top'   ) { return page.y < ((height >= 0? rect.top : rect.bottom) + margin); }\r\n\r\n            if (name === 'right' ) { return page.x > ((width  >= 0? rect.right : rect.left) - margin); }\r\n            if (name === 'bottom') { return page.y > ((height >= 0? rect.bottom: rect.top ) - margin); }\r\n        }\r\n\r\n        // the remaining checks require an element\r\n        if (!isElement(element)) { return false; }\r\n\r\n        return isElement(value)\r\n                    // the value is an element to use as a resize handle\r\n                    ? value === element\r\n                    // otherwise check if element matches value as selector\r\n                    : matchesUpTo(element, value, interactableElement);\r\n    }\r\n\r\n    function defaultActionChecker (pointer, interaction, element) {\r\n        var rect = this.getRect(element),\r\n            shouldResize = false,\r\n            action = null,\r\n            resizeAxes = null,\r\n            resizeEdges,\r\n            page = extend({}, interaction.curCoords.page),\r\n            options = this.options;\r\n\r\n        if (!rect) { return null; }\r\n\r\n        if (actionIsEnabled.resize && options.resize.enabled) {\r\n            var resizeOptions = options.resize;\r\n\r\n            resizeEdges = {\r\n                left: false, right: false, top: false, bottom: false\r\n            };\r\n\r\n            // if using resize.edges\r\n            if (isObject(resizeOptions.edges)) {\r\n                for (var edge in resizeEdges) {\r\n                    resizeEdges[edge] = checkResizeEdge(edge,\r\n                                                        resizeOptions.edges[edge],\r\n                                                        page,\r\n                                                        interaction._eventTarget,\r\n                                                        element,\r\n                                                        rect,\r\n                                                        resizeOptions.margin || margin);\r\n                }\r\n\r\n                resizeEdges.left = resizeEdges.left && !resizeEdges.right;\r\n                resizeEdges.top  = resizeEdges.top  && !resizeEdges.bottom;\r\n\r\n                shouldResize = resizeEdges.left || resizeEdges.right || resizeEdges.top || resizeEdges.bottom;\r\n            }\r\n            else {\r\n                var right  = options.resize.axis !== 'y' && page.x > (rect.right  - margin),\r\n                    bottom = options.resize.axis !== 'x' && page.y > (rect.bottom - margin);\r\n\r\n                shouldResize = right || bottom;\r\n                resizeAxes = (right? 'x' : '') + (bottom? 'y' : '');\r\n            }\r\n        }\r\n\r\n        action = shouldResize\r\n            ? 'resize'\r\n            : actionIsEnabled.drag && options.drag.enabled\r\n                ? 'drag'\r\n                : null;\r\n\r\n        if (actionIsEnabled.gesture\r\n            && interaction.pointerIds.length >=2\r\n            && !(interaction.dragging || interaction.resizing)) {\r\n            action = 'gesture';\r\n        }\r\n\r\n        if (action) {\r\n            return {\r\n                name: action,\r\n                axis: resizeAxes,\r\n                edges: resizeEdges\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    // Check if action is enabled globally and the current target supports it\r\n    // If so, return the validated action. Otherwise, return null\r\n    function validateAction (action, interactable) {\r\n        if (!isObject(action)) { return null; }\r\n\r\n        var actionName = action.name,\r\n            options = interactable.options;\r\n\r\n        if ((  (actionName  === 'resize'   && options.resize.enabled )\r\n            || (actionName      === 'drag'     && options.drag.enabled  )\r\n            || (actionName      === 'gesture'  && options.gesture.enabled))\r\n            && actionIsEnabled[actionName]) {\r\n\r\n            if (actionName === 'resize' || actionName === 'resizeyx') {\r\n                actionName = 'resizexy';\r\n            }\r\n\r\n            return action;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    var listeners = {},\r\n        interactionListeners = [\r\n            'dragStart', 'dragMove', 'resizeStart', 'resizeMove', 'gestureStart', 'gestureMove',\r\n            'pointerOver', 'pointerOut', 'pointerHover', 'selectorDown',\r\n            'pointerDown', 'pointerMove', 'pointerUp', 'pointerCancel', 'pointerEnd',\r\n            'addPointer', 'removePointer', 'recordPointer', 'autoScrollMove'\r\n        ];\r\n\r\n    for (var i = 0, len = interactionListeners.length; i < len; i++) {\r\n        var name = interactionListeners[i];\r\n\r\n        listeners[name] = doOnInteractions(name);\r\n    }\r\n\r\n    // bound to the interactable context when a DOM event\r\n    // listener is added to a selector interactable\r\n    function delegateListener (event, useCapture) {\r\n        var fakeEvent = {},\r\n            delegated = delegatedEvents[event.type],\r\n            eventTarget = getActualElement(event.path\r\n                                           ? event.path[0]\r\n                                           : event.target),\r\n            element = eventTarget;\r\n\r\n        useCapture = useCapture? true: false;\r\n\r\n        // duplicate the event so that currentTarget can be changed\r\n        for (var prop in event) {\r\n            fakeEvent[prop] = event[prop];\r\n        }\r\n\r\n        fakeEvent.originalEvent = event;\r\n        fakeEvent.preventDefault = preventOriginalDefault;\r\n\r\n        // climb up document tree looking for selector matches\r\n        while (isElement(element)) {\r\n            for (var i = 0; i < delegated.selectors.length; i++) {\r\n                var selector = delegated.selectors[i],\r\n                    context = delegated.contexts[i];\r\n\r\n                if (matchesSelector(element, selector)\r\n                    && nodeContains(context, eventTarget)\r\n                    && nodeContains(context, element)) {\r\n\r\n                    var listeners = delegated.listeners[i];\r\n\r\n                    fakeEvent.currentTarget = element;\r\n\r\n                    for (var j = 0; j < listeners.length; j++) {\r\n                        if (listeners[j][1] === useCapture) {\r\n                            listeners[j][0](fakeEvent);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            element = parentElement(element);\r\n        }\r\n    }\r\n\r\n    function delegateUseCapture (event) {\r\n        return delegateListener.call(this, event, true);\r\n    }\r\n\r\n    interactables.indexOfElement = function indexOfElement (element, context) {\r\n        context = context || document;\r\n\r\n        for (var i = 0; i < this.length; i++) {\r\n            var interactable = this[i];\r\n\r\n            if ((interactable.selector === element\r\n                && (interactable._context === context))\r\n                || (!interactable.selector && interactable._element === element)) {\r\n\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    };\r\n\r\n    interactables.get = function interactableGet (element, options) {\r\n        return this[this.indexOfElement(element, options && options.context)];\r\n    };\r\n\r\n    interactables.forEachSelector = function (callback) {\r\n        for (var i = 0; i < this.length; i++) {\r\n            var interactable = this[i];\r\n\r\n            if (!interactable.selector) {\r\n                continue;\r\n            }\r\n\r\n            var ret = callback(interactable, interactable.selector, interactable._context, i, this);\r\n\r\n            if (ret !== undefined) {\r\n                return ret;\r\n            }\r\n        }\r\n    };\r\n\r\n    /*\\\r\n     * interact\r\n     [ method ]\r\n     *\r\n     * The methods of this variable can be used to set elements as\r\n     * interactables and also to change various default settings.\r\n     *\r\n     * Calling it as a function and passing an element or a valid CSS selector\r\n     * string returns an Interactable object which has various methods to\r\n     * configure it.\r\n     *\r\n     - element (Element | string) The HTML or SVG Element to interact with or CSS selector\r\n     = (object) An @Interactable\r\n     *\r\n     > Usage\r\n     | interact(document.getElementById('draggable')).draggable(true);\r\n     |\r\n     | var rectables = interact('rect');\r\n     | rectables\r\n     |     .gesturable(true)\r\n     |     .on('gesturemove', function (event) {\r\n     |         // something cool...\r\n     |     })\r\n     |     .autoScroll(true);\r\n    \\*/\r\n    function interact (element, options) {\r\n        return interactables.get(element, options) || new Interactable(element, options);\r\n    }\r\n\r\n    /*\\\r\n     * Interactable\r\n     [ property ]\r\n     **\r\n     * Object type returned by @interact\r\n    \\*/\r\n    function Interactable (element, options) {\r\n        this._element = element;\r\n        this._iEvents = this._iEvents || {};\r\n\r\n        var _window;\r\n\r\n        if (trySelector(element)) {\r\n            this.selector = element;\r\n\r\n            var context = options && options.context;\r\n\r\n            _window = context? getWindow(context) : window;\r\n\r\n            if (context && (_window.Node\r\n                    ? context instanceof _window.Node\r\n                    : (isElement(context) || context === _window.document))) {\r\n\r\n                this._context = context;\r\n            }\r\n        }\r\n        else {\r\n            _window = getWindow(element);\r\n\r\n            if (isElement(element, _window)) {\r\n\r\n                if (PointerEvent) {\r\n                    events.add(this._element, pEventTypes.down, listeners.pointerDown );\r\n                    events.add(this._element, pEventTypes.move, listeners.pointerHover);\r\n                }\r\n                else {\r\n                    events.add(this._element, 'mousedown' , listeners.pointerDown );\r\n                    events.add(this._element, 'mousemove' , listeners.pointerHover);\r\n                    events.add(this._element, 'touchstart', listeners.pointerDown );\r\n                    events.add(this._element, 'touchmove' , listeners.pointerHover);\r\n                }\r\n            }\r\n        }\r\n\r\n        this._doc = _window.document;\r\n\r\n        if (!contains(documents, this._doc)) {\r\n            listenToDocument(this._doc);\r\n        }\r\n\r\n        interactables.push(this);\r\n\r\n        this.set(options);\r\n    }\r\n\r\n    Interactable.prototype = {\r\n        setOnEvents: function (action, phases) {\r\n            if (action === 'drop') {\r\n                if (isFunction(phases.ondrop)          ) { this.ondrop           = phases.ondrop          ; }\r\n                if (isFunction(phases.ondropactivate)  ) { this.ondropactivate   = phases.ondropactivate  ; }\r\n                if (isFunction(phases.ondropdeactivate)) { this.ondropdeactivate = phases.ondropdeactivate; }\r\n                if (isFunction(phases.ondragenter)     ) { this.ondragenter      = phases.ondragenter     ; }\r\n                if (isFunction(phases.ondragleave)     ) { this.ondragleave      = phases.ondragleave     ; }\r\n                if (isFunction(phases.ondropmove)      ) { this.ondropmove       = phases.ondropmove      ; }\r\n            }\r\n            else {\r\n                action = 'on' + action;\r\n\r\n                if (isFunction(phases.onstart)       ) { this[action + 'start'         ] = phases.onstart         ; }\r\n                if (isFunction(phases.onmove)        ) { this[action + 'move'          ] = phases.onmove          ; }\r\n                if (isFunction(phases.onend)         ) { this[action + 'end'           ] = phases.onend           ; }\r\n                if (isFunction(phases.oninertiastart)) { this[action + 'inertiastart'  ] = phases.oninertiastart  ; }\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.draggable\r\n         [ method ]\r\n         *\r\n         * Gets or sets whether drag actions can be performed on the\r\n         * Interactable\r\n         *\r\n         = (boolean) Indicates if this can be the target of drag events\r\n         | var isDraggable = interact('ul li').draggable();\r\n         * or\r\n         - options (boolean | object) #optional true/false or An object with event listeners to be fired on drag events (object makes the Interactable draggable)\r\n         = (object) This Interactable\r\n         | interact(element).draggable({\r\n         |     onstart: function (event) {},\r\n         |     onmove : function (event) {},\r\n         |     onend  : function (event) {},\r\n         |\r\n         |     // the axis in which the first movement must be\r\n         |     // for the drag sequence to start\r\n         |     // 'xy' by default - any direction\r\n         |     axis: 'x' || 'y' || 'xy',\r\n         |\r\n         |     // max number of drags that can happen concurrently\r\n         |     // with elements of this Interactable. Infinity by default\r\n         |     max: Infinity,\r\n         |\r\n         |     // max number of drags that can target the same element+Interactable\r\n         |     // 1 by default\r\n         |     maxPerElement: 2\r\n         | });\r\n        \\*/\r\n        draggable: function (options) {\r\n            if (isObject(options)) {\r\n                this.options.drag.enabled = options.enabled === false? false: true;\r\n                this.setPerAction('drag', options);\r\n                this.setOnEvents('drag', options);\r\n\r\n                if (/^x$|^y$|^xy$/.test(options.axis)) {\r\n                    this.options.drag.axis = options.axis;\r\n                }\r\n                else if (options.axis === null) {\r\n                    delete this.options.drag.axis;\r\n                }\r\n\r\n                return this;\r\n            }\r\n\r\n            if (isBool(options)) {\r\n                this.options.drag.enabled = options;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.drag;\r\n        },\r\n\r\n        setPerAction: function (action, options) {\r\n            // for all the default per-action options\r\n            for (var option in options) {\r\n                // if this option exists for this action\r\n                if (option in defaultOptions[action]) {\r\n                    // if the option in the options arg is an object value\r\n                    if (isObject(options[option])) {\r\n                        // duplicate the object\r\n                        this.options[action][option] = extend(this.options[action][option] || {}, options[option]);\r\n\r\n                        if (isObject(defaultOptions.perAction[option]) && 'enabled' in defaultOptions.perAction[option]) {\r\n                            this.options[action][option].enabled = options[option].enabled === false? false : true;\r\n                        }\r\n                    }\r\n                    else if (isBool(options[option]) && isObject(defaultOptions.perAction[option])) {\r\n                        this.options[action][option].enabled = options[option];\r\n                    }\r\n                    else if (options[option] !== undefined) {\r\n                        // or if it's not undefined, do a plain assignment\r\n                        this.options[action][option] = options[option];\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.dropzone\r\n         [ method ]\r\n         *\r\n         * Returns or sets whether elements can be dropped onto this\r\n         * Interactable to trigger drop events\r\n         *\r\n         * Dropzones can receive the following events:\r\n         *  - `dropactivate` and `dropdeactivate` when an acceptable drag starts and ends\r\n         *  - `dragenter` and `dragleave` when a draggable enters and leaves the dropzone\r\n         *  - `dragmove` when a draggable that has entered the dropzone is moved\r\n         *  - `drop` when a draggable is dropped into this dropzone\r\n         *\r\n         *  Use the `accept` option to allow only elements that match the given CSS selector or element.\r\n         *\r\n         *  Use the `overlap` option to set how drops are checked for. The allowed values are:\r\n         *   - `'pointer'`, the pointer must be over the dropzone (default)\r\n         *   - `'center'`, the draggable element's center must be over the dropzone\r\n         *   - a number from 0-1 which is the `(intersection area) / (draggable area)`.\r\n         *       e.g. `0.5` for drop to happen when half of the area of the\r\n         *       draggable is over the dropzone\r\n         *\r\n         - options (boolean | object | null) #optional The new value to be set.\r\n         | interact('.drop').dropzone({\r\n         |   accept: '.can-drop' || document.getElementById('single-drop'),\r\n         |   overlap: 'pointer' || 'center' || zeroToOne\r\n         | }\r\n         = (boolean | object) The current setting or this Interactable\r\n        \\*/\r\n        dropzone: function (options) {\r\n            if (isObject(options)) {\r\n                this.options.drop.enabled = options.enabled === false? false: true;\r\n                this.setOnEvents('drop', options);\r\n\r\n                if (/^(pointer|center)$/.test(options.overlap)) {\r\n                    this.options.drop.overlap = options.overlap;\r\n                }\r\n                else if (isNumber(options.overlap)) {\r\n                    this.options.drop.overlap = Math.max(Math.min(1, options.overlap), 0);\r\n                }\r\n                if ('accept' in options) {\r\n                  this.options.drop.accept = options.accept;\r\n                }\r\n                if ('checker' in options) {\r\n                  this.options.drop.checker = options.checker;\r\n                }\r\n\r\n                return this;\r\n            }\r\n\r\n            if (isBool(options)) {\r\n                this.options.drop.enabled = options;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.drop;\r\n        },\r\n\r\n        dropCheck: function (dragEvent, event, draggable, draggableElement, dropElement, rect) {\r\n            var dropped = false;\r\n\r\n            // if the dropzone has no rect (eg. display: none)\r\n            // call the custom dropChecker or just return false\r\n            if (!(rect = rect || this.getRect(dropElement))) {\r\n                return (this.options.drop.checker\r\n                    ? this.options.drop.checker(dragEvent, event, dropped, this, dropElement, draggable, draggableElement)\r\n                    : false);\r\n            }\r\n\r\n            var dropOverlap = this.options.drop.overlap;\r\n\r\n            if (dropOverlap === 'pointer') {\r\n                var page = getPageXY(dragEvent),\r\n                    origin = getOriginXY(draggable, draggableElement),\r\n                    horizontal,\r\n                    vertical;\r\n\r\n                page.x += origin.x;\r\n                page.y += origin.y;\r\n\r\n                horizontal = (page.x > rect.left) && (page.x < rect.right);\r\n                vertical   = (page.y > rect.top ) && (page.y < rect.bottom);\r\n\r\n                dropped = horizontal && vertical;\r\n            }\r\n\r\n            var dragRect = draggable.getRect(draggableElement);\r\n\r\n            if (dropOverlap === 'center') {\r\n                var cx = dragRect.left + dragRect.width  / 2,\r\n                    cy = dragRect.top  + dragRect.height / 2;\r\n\r\n                dropped = cx >= rect.left && cx <= rect.right && cy >= rect.top && cy <= rect.bottom;\r\n            }\r\n\r\n            if (isNumber(dropOverlap)) {\r\n                var overlapArea  = (Math.max(0, Math.min(rect.right , dragRect.right ) - Math.max(rect.left, dragRect.left))\r\n                                  * Math.max(0, Math.min(rect.bottom, dragRect.bottom) - Math.max(rect.top , dragRect.top ))),\r\n                    overlapRatio = overlapArea / (dragRect.width * dragRect.height);\r\n\r\n                dropped = overlapRatio >= dropOverlap;\r\n            }\r\n\r\n            if (this.options.drop.checker) {\r\n                dropped = this.options.drop.checker(dragEvent, event, dropped, this, dropElement, draggable, draggableElement);\r\n            }\r\n\r\n            return dropped;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.dropChecker\r\n         [ method ]\r\n         *\r\n         * DEPRECATED. Use interactable.dropzone({ checker: function... }) instead.\r\n         *\r\n         * Gets or sets the function used to check if a dragged element is\r\n         * over this Interactable.\r\n         *\r\n         - checker (function) #optional The function that will be called when checking for a drop\r\n         = (Function | Interactable) The checker function or this Interactable\r\n         *\r\n         * The checker function takes the following arguments:\r\n         *\r\n         - dragEvent (InteractEvent) The related dragmove or dragend event\r\n         - event (TouchEvent | PointerEvent | MouseEvent) The user move/up/end Event related to the dragEvent\r\n         - dropped (boolean) The value from the default drop checker\r\n         - dropzone (Interactable) The dropzone interactable\r\n         - dropElement (Element) The dropzone element\r\n         - draggable (Interactable) The Interactable being dragged\r\n         - draggableElement (Element) The actual element that's being dragged\r\n         *\r\n         > Usage:\r\n         | interact(target)\r\n         | .dropChecker(function(dragEvent,         // related dragmove or dragend event\r\n         |                       event,             // TouchEvent/PointerEvent/MouseEvent\r\n         |                       dropped,           // bool result of the default checker\r\n         |                       dropzone,          // dropzone Interactable\r\n         |                       dropElement,       // dropzone elemnt\r\n         |                       draggable,         // draggable Interactable\r\n         |                       draggableElement) {// draggable element\r\n         |\r\n         |   return dropped && event.target.hasAttribute('allow-drop');\r\n         | }\r\n        \\*/\r\n        dropChecker: function (checker) {\r\n            if (isFunction(checker)) {\r\n                this.options.drop.checker = checker;\r\n\r\n                return this;\r\n            }\r\n            if (checker === null) {\r\n                delete this.options.getRect;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.drop.checker;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.accept\r\n         [ method ]\r\n         *\r\n         * Deprecated. add an `accept` property to the options object passed to\r\n         * @Interactable.dropzone instead.\r\n         *\r\n         * Gets or sets the Element or CSS selector match that this\r\n         * Interactable accepts if it is a dropzone.\r\n         *\r\n         - newValue (Element | string | null) #optional\r\n         * If it is an Element, then only that element can be dropped into this dropzone.\r\n         * If it is a string, the element being dragged must match it as a selector.\r\n         * If it is null, the accept options is cleared - it accepts any element.\r\n         *\r\n         = (string | Element | null | Interactable) The current accept option if given `undefined` or this Interactable\r\n        \\*/\r\n        accept: function (newValue) {\r\n            if (isElement(newValue)) {\r\n                this.options.drop.accept = newValue;\r\n\r\n                return this;\r\n            }\r\n\r\n            // test if it is a valid CSS selector\r\n            if (trySelector(newValue)) {\r\n                this.options.drop.accept = newValue;\r\n\r\n                return this;\r\n            }\r\n\r\n            if (newValue === null) {\r\n                delete this.options.drop.accept;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.drop.accept;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.resizable\r\n         [ method ]\r\n         *\r\n         * Gets or sets whether resize actions can be performed on the\r\n         * Interactable\r\n         *\r\n         = (boolean) Indicates if this can be the target of resize elements\r\n         | var isResizeable = interact('input[type=text]').resizable();\r\n         * or\r\n         - options (boolean | object) #optional true/false or An object with event listeners to be fired on resize events (object makes the Interactable resizable)\r\n         = (object) This Interactable\r\n         | interact(element).resizable({\r\n         |     onstart: function (event) {},\r\n         |     onmove : function (event) {},\r\n         |     onend  : function (event) {},\r\n         |\r\n         |     edges: {\r\n         |       top   : true,       // Use pointer coords to check for resize.\r\n         |       left  : false,      // Disable resizing from left edge.\r\n         |       bottom: '.resize-s',// Resize if pointer target matches selector\r\n         |       right : handleEl    // Resize if pointer target is the given Element\r\n         |     },\r\n         |\r\n         |     // Width and height can be adjusted independently. When `true`, width and\r\n         |     // height are adjusted at a 1:1 ratio.\r\n         |     square: false,\r\n         |\r\n         |     // Width and height can be adjusted independently. When `true`, width and\r\n         |     // height maintain the aspect ratio they had when resizing started.\r\n         |     preserveAspectRatio: false,\r\n         |\r\n         |     // a value of 'none' will limit the resize rect to a minimum of 0x0\r\n         |     // 'negate' will allow the rect to have negative width/height\r\n         |     // 'reposition' will keep the width/height positive by swapping\r\n         |     // the top and bottom edges and/or swapping the left and right edges\r\n         |     invert: 'none' || 'negate' || 'reposition'\r\n         |\r\n         |     // limit multiple resizes.\r\n         |     // See the explanation in the @Interactable.draggable example\r\n         |     max: Infinity,\r\n         |     maxPerElement: 1,\r\n         | });\r\n        \\*/\r\n        resizable: function (options) {\r\n            if (isObject(options)) {\r\n                this.options.resize.enabled = options.enabled === false? false: true;\r\n                this.setPerAction('resize', options);\r\n                this.setOnEvents('resize', options);\r\n\r\n                if (/^x$|^y$|^xy$/.test(options.axis)) {\r\n                    this.options.resize.axis = options.axis;\r\n                }\r\n                else if (options.axis === null) {\r\n                    this.options.resize.axis = defaultOptions.resize.axis;\r\n                }\r\n\r\n                if (isBool(options.preserveAspectRatio)) {\r\n                    this.options.resize.preserveAspectRatio = options.preserveAspectRatio;\r\n                }\r\n                else if (isBool(options.square)) {\r\n                    this.options.resize.square = options.square;\r\n                }\r\n\r\n                return this;\r\n            }\r\n            if (isBool(options)) {\r\n                this.options.resize.enabled = options;\r\n\r\n                return this;\r\n            }\r\n            return this.options.resize;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.squareResize\r\n         [ method ]\r\n         *\r\n         * Deprecated. Add a `square: true || false` property to @Interactable.resizable instead\r\n         *\r\n         * Gets or sets whether resizing is forced 1:1 aspect\r\n         *\r\n         = (boolean) Current setting\r\n         *\r\n         * or\r\n         *\r\n         - newValue (boolean) #optional\r\n         = (object) this Interactable\r\n        \\*/\r\n        squareResize: function (newValue) {\r\n            if (isBool(newValue)) {\r\n                this.options.resize.square = newValue;\r\n\r\n                return this;\r\n            }\r\n\r\n            if (newValue === null) {\r\n                delete this.options.resize.square;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.resize.square;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.gesturable\r\n         [ method ]\r\n         *\r\n         * Gets or sets whether multitouch gestures can be performed on the\r\n         * Interactable's element\r\n         *\r\n         = (boolean) Indicates if this can be the target of gesture events\r\n         | var isGestureable = interact(element).gesturable();\r\n         * or\r\n         - options (boolean | object) #optional true/false or An object with event listeners to be fired on gesture events (makes the Interactable gesturable)\r\n         = (object) this Interactable\r\n         | interact(element).gesturable({\r\n         |     onstart: function (event) {},\r\n         |     onmove : function (event) {},\r\n         |     onend  : function (event) {},\r\n         |\r\n         |     // limit multiple gestures.\r\n         |     // See the explanation in @Interactable.draggable example\r\n         |     max: Infinity,\r\n         |     maxPerElement: 1,\r\n         | });\r\n        \\*/\r\n        gesturable: function (options) {\r\n            if (isObject(options)) {\r\n                this.options.gesture.enabled = options.enabled === false? false: true;\r\n                this.setPerAction('gesture', options);\r\n                this.setOnEvents('gesture', options);\r\n\r\n                return this;\r\n            }\r\n\r\n            if (isBool(options)) {\r\n                this.options.gesture.enabled = options;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.gesture;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.autoScroll\r\n         [ method ]\r\n         **\r\n         * Deprecated. Add an `autoscroll` property to the options object\r\n         * passed to @Interactable.draggable or @Interactable.resizable instead.\r\n         *\r\n         * Returns or sets whether dragging and resizing near the edges of the\r\n         * window/container trigger autoScroll for this Interactable\r\n         *\r\n         = (object) Object with autoScroll properties\r\n         *\r\n         * or\r\n         *\r\n         - options (object | boolean) #optional\r\n         * options can be:\r\n         * - an object with margin, distance and interval properties,\r\n         * - true or false to enable or disable autoScroll or\r\n         = (Interactable) this Interactable\r\n        \\*/\r\n        autoScroll: function (options) {\r\n            if (isObject(options)) {\r\n                options = extend({ actions: ['drag', 'resize']}, options);\r\n            }\r\n            else if (isBool(options)) {\r\n                options = { actions: ['drag', 'resize'], enabled: options };\r\n            }\r\n\r\n            return this.setOptions('autoScroll', options);\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.snap\r\n         [ method ]\r\n         **\r\n         * Deprecated. Add a `snap` property to the options object passed\r\n         * to @Interactable.draggable or @Interactable.resizable instead.\r\n         *\r\n         * Returns or sets if and how action coordinates are snapped. By\r\n         * default, snapping is relative to the pointer coordinates. You can\r\n         * change this by setting the\r\n         * [`elementOrigin`](https://github.com/taye/interact.js/pull/72).\r\n         **\r\n         = (boolean | object) `false` if snap is disabled; object with snap properties if snap is enabled\r\n         **\r\n         * or\r\n         **\r\n         - options (object | boolean | null) #optional\r\n         = (Interactable) this Interactable\r\n         > Usage\r\n         | interact(document.querySelector('#thing')).snap({\r\n         |     targets: [\r\n         |         // snap to this specific point\r\n         |         {\r\n         |             x: 100,\r\n         |             y: 100,\r\n         |             range: 25\r\n         |         },\r\n         |         // give this function the x and y page coords and snap to the object returned\r\n         |         function (x, y) {\r\n         |             return {\r\n         |                 x: x,\r\n         |                 y: (75 + 50 * Math.sin(x * 0.04)),\r\n         |                 range: 40\r\n         |             };\r\n         |         },\r\n         |         // create a function that snaps to a grid\r\n         |         interact.createSnapGrid({\r\n         |             x: 50,\r\n         |             y: 50,\r\n         |             range: 10,              // optional\r\n         |             offset: { x: 5, y: 10 } // optional\r\n         |         })\r\n         |     ],\r\n         |     // do not snap during normal movement.\r\n         |     // Instead, trigger only one snapped move event\r\n         |     // immediately before the end event.\r\n         |     endOnly: true,\r\n         |\r\n         |     relativePoints: [\r\n         |         { x: 0, y: 0 },  // snap relative to the top left of the element\r\n         |         { x: 1, y: 1 },  // and also to the bottom right\r\n         |     ],  \r\n         |\r\n         |     // offset the snap target coordinates\r\n         |     // can be an object with x/y or 'startCoords'\r\n         |     offset: { x: 50, y: 50 }\r\n         |   }\r\n         | });\r\n        \\*/\r\n        snap: function (options) {\r\n            var ret = this.setOptions('snap', options);\r\n\r\n            if (ret === this) { return this; }\r\n\r\n            return ret.drag;\r\n        },\r\n\r\n        setOptions: function (option, options) {\r\n            var actions = options && isArray(options.actions)\r\n                    ? options.actions\r\n                    : ['drag'];\r\n\r\n            var i;\r\n\r\n            if (isObject(options) || isBool(options)) {\r\n                for (i = 0; i < actions.length; i++) {\r\n                    var action = /resize/.test(actions[i])? 'resize' : actions[i];\r\n\r\n                    if (!isObject(this.options[action])) { continue; }\r\n\r\n                    var thisOption = this.options[action][option];\r\n\r\n                    if (isObject(options)) {\r\n                        extend(thisOption, options);\r\n                        thisOption.enabled = options.enabled === false? false: true;\r\n\r\n                        if (option === 'snap') {\r\n                            if (thisOption.mode === 'grid') {\r\n                                thisOption.targets = [\r\n                                    interact.createSnapGrid(extend({\r\n                                        offset: thisOption.gridOffset || { x: 0, y: 0 }\r\n                                    }, thisOption.grid || {}))\r\n                                ];\r\n                            }\r\n                            else if (thisOption.mode === 'anchor') {\r\n                                thisOption.targets = thisOption.anchors;\r\n                            }\r\n                            else if (thisOption.mode === 'path') {\r\n                                thisOption.targets = thisOption.paths;\r\n                            }\r\n\r\n                            if ('elementOrigin' in options) {\r\n                                thisOption.relativePoints = [options.elementOrigin];\r\n                            }\r\n                        }\r\n                    }\r\n                    else if (isBool(options)) {\r\n                        thisOption.enabled = options;\r\n                    }\r\n                }\r\n\r\n                return this;\r\n            }\r\n\r\n            var ret = {},\r\n                allActions = ['drag', 'resize', 'gesture'];\r\n\r\n            for (i = 0; i < allActions.length; i++) {\r\n                if (option in defaultOptions[allActions[i]]) {\r\n                    ret[allActions[i]] = this.options[allActions[i]][option];\r\n                }\r\n            }\r\n\r\n            return ret;\r\n        },\r\n\r\n\r\n        /*\\\r\n         * Interactable.inertia\r\n         [ method ]\r\n         **\r\n         * Deprecated. Add an `inertia` property to the options object passed\r\n         * to @Interactable.draggable or @Interactable.resizable instead.\r\n         *\r\n         * Returns or sets if and how events continue to run after the pointer is released\r\n         **\r\n         = (boolean | object) `false` if inertia is disabled; `object` with inertia properties if inertia is enabled\r\n         **\r\n         * or\r\n         **\r\n         - options (object | boolean | null) #optional\r\n         = (Interactable) this Interactable\r\n         > Usage\r\n         | // enable and use default settings\r\n         | interact(element).inertia(true);\r\n         |\r\n         | // enable and use custom settings\r\n         | interact(element).inertia({\r\n         |     // value greater than 0\r\n         |     // high values slow the object down more quickly\r\n         |     resistance     : 16,\r\n         |\r\n         |     // the minimum launch speed (pixels per second) that results in inertia start\r\n         |     minSpeed       : 200,\r\n         |\r\n         |     // inertia will stop when the object slows down to this speed\r\n         |     endSpeed       : 20,\r\n         |\r\n         |     // boolean; should actions be resumed when the pointer goes down during inertia\r\n         |     allowResume    : true,\r\n         |\r\n         |     // boolean; should the jump when resuming from inertia be ignored in event.dx/dy\r\n         |     zeroResumeDelta: false,\r\n         |\r\n         |     // if snap/restrict are set to be endOnly and inertia is enabled, releasing\r\n         |     // the pointer without triggering inertia will animate from the release\r\n         |     // point to the snaped/restricted point in the given amount of time (ms)\r\n         |     smoothEndDuration: 300,\r\n         |\r\n         |     // an array of action types that can have inertia (no gesture)\r\n         |     actions        : ['drag', 'resize']\r\n         | });\r\n         |\r\n         | // reset custom settings and use all defaults\r\n         | interact(element).inertia(null);\r\n        \\*/\r\n        inertia: function (options) {\r\n            var ret = this.setOptions('inertia', options);\r\n\r\n            if (ret === this) { return this; }\r\n\r\n            return ret.drag;\r\n        },\r\n\r\n        getAction: function (pointer, event, interaction, element) {\r\n            var action = this.defaultActionChecker(pointer, interaction, element);\r\n\r\n            if (this.options.actionChecker) {\r\n                return this.options.actionChecker(pointer, event, action, this, element, interaction);\r\n            }\r\n\r\n            return action;\r\n        },\r\n\r\n        defaultActionChecker: defaultActionChecker,\r\n\r\n        /*\\\r\n         * Interactable.actionChecker\r\n         [ method ]\r\n         *\r\n         * Gets or sets the function used to check action to be performed on\r\n         * pointerDown\r\n         *\r\n         - checker (function | null) #optional A function which takes a pointer event, defaultAction string, interactable, element and interaction as parameters and returns an object with name property 'drag' 'resize' or 'gesture' and optionally an `edges` object with boolean 'top', 'left', 'bottom' and right props.\r\n         = (Function | Interactable) The checker function or this Interactable\r\n         *\r\n         | interact('.resize-drag')\r\n         |   .resizable(true)\r\n         |   .draggable(true)\r\n         |   .actionChecker(function (pointer, event, action, interactable, element, interaction) {\r\n         |\r\n         |   if (interact.matchesSelector(event.target, '.drag-handle') {\r\n         |     // force drag with handle target\r\n         |     action.name = drag;\r\n         |   }\r\n         |   else {\r\n         |     // resize from the top and right edges\r\n         |     action.name  = 'resize';\r\n         |     action.edges = { top: true, right: true };\r\n         |   }\r\n         |\r\n         |   return action;\r\n         | });\r\n        \\*/\r\n        actionChecker: function (checker) {\r\n            if (isFunction(checker)) {\r\n                this.options.actionChecker = checker;\r\n\r\n                return this;\r\n            }\r\n\r\n            if (checker === null) {\r\n                delete this.options.actionChecker;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.actionChecker;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.getRect\r\n         [ method ]\r\n         *\r\n         * The default function to get an Interactables bounding rect. Can be\r\n         * overridden using @Interactable.rectChecker.\r\n         *\r\n         - element (Element) #optional The element to measure.\r\n         = (object) The object's bounding rectangle.\r\n         o {\r\n         o     top   : 0,\r\n         o     left  : 0,\r\n         o     bottom: 0,\r\n         o     right : 0,\r\n         o     width : 0,\r\n         o     height: 0\r\n         o }\r\n        \\*/\r\n        getRect: function rectCheck (element) {\r\n            element = element || this._element;\r\n\r\n            if (this.selector && !(isElement(element))) {\r\n                element = this._context.querySelector(this.selector);\r\n            }\r\n\r\n            return getElementRect(element);\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.rectChecker\r\n         [ method ]\r\n         *\r\n         * Returns or sets the function used to calculate the interactable's\r\n         * element's rectangle\r\n         *\r\n         - checker (function) #optional A function which returns this Interactable's bounding rectangle. See @Interactable.getRect\r\n         = (function | object) The checker function or this Interactable\r\n        \\*/\r\n        rectChecker: function (checker) {\r\n            if (isFunction(checker)) {\r\n                this.getRect = checker;\r\n\r\n                return this;\r\n            }\r\n\r\n            if (checker === null) {\r\n                delete this.options.getRect;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.getRect;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.styleCursor\r\n         [ method ]\r\n         *\r\n         * Returns or sets whether the action that would be performed when the\r\n         * mouse on the element are checked on `mousemove` so that the cursor\r\n         * may be styled appropriately\r\n         *\r\n         - newValue (boolean) #optional\r\n         = (boolean | Interactable) The current setting or this Interactable\r\n        \\*/\r\n        styleCursor: function (newValue) {\r\n            if (isBool(newValue)) {\r\n                this.options.styleCursor = newValue;\r\n\r\n                return this;\r\n            }\r\n\r\n            if (newValue === null) {\r\n                delete this.options.styleCursor;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.styleCursor;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.preventDefault\r\n         [ method ]\r\n         *\r\n         * Returns or sets whether to prevent the browser's default behaviour\r\n         * in response to pointer events. Can be set to:\r\n         *  - `'always'` to always prevent\r\n         *  - `'never'` to never prevent\r\n         *  - `'auto'` to let interact.js try to determine what would be best\r\n         *\r\n         - newValue (string) #optional `true`, `false` or `'auto'`\r\n         = (string | Interactable) The current setting or this Interactable\r\n        \\*/\r\n        preventDefault: function (newValue) {\r\n            if (/^(always|never|auto)$/.test(newValue)) {\r\n                this.options.preventDefault = newValue;\r\n                return this;\r\n            }\r\n\r\n            if (isBool(newValue)) {\r\n                this.options.preventDefault = newValue? 'always' : 'never';\r\n                return this;\r\n            }\r\n\r\n            return this.options.preventDefault;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.origin\r\n         [ method ]\r\n         *\r\n         * Gets or sets the origin of the Interactable's element.  The x and y\r\n         * of the origin will be subtracted from action event coordinates.\r\n         *\r\n         - origin (object | string) #optional An object eg. { x: 0, y: 0 } or string 'parent', 'self' or any CSS selector\r\n         * OR\r\n         - origin (Element) #optional An HTML or SVG Element whose rect will be used\r\n         **\r\n         = (object) The current origin or this Interactable\r\n        \\*/\r\n        origin: function (newValue) {\r\n            if (trySelector(newValue)) {\r\n                this.options.origin = newValue;\r\n                return this;\r\n            }\r\n            else if (isObject(newValue)) {\r\n                this.options.origin = newValue;\r\n                return this;\r\n            }\r\n\r\n            return this.options.origin;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.deltaSource\r\n         [ method ]\r\n         *\r\n         * Returns or sets the mouse coordinate types used to calculate the\r\n         * movement of the pointer.\r\n         *\r\n         - newValue (string) #optional Use 'client' if you will be scrolling while interacting; Use 'page' if you want autoScroll to work\r\n         = (string | object) The current deltaSource or this Interactable\r\n        \\*/\r\n        deltaSource: function (newValue) {\r\n            if (newValue === 'page' || newValue === 'client') {\r\n                this.options.deltaSource = newValue;\r\n\r\n                return this;\r\n            }\r\n\r\n            return this.options.deltaSource;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.restrict\r\n         [ method ]\r\n         **\r\n         * Deprecated. Add a `restrict` property to the options object passed to\r\n         * @Interactable.draggable, @Interactable.resizable or @Interactable.gesturable instead.\r\n         *\r\n         * Returns or sets the rectangles within which actions on this\r\n         * interactable (after snap calculations) are restricted. By default,\r\n         * restricting is relative to the pointer coordinates. You can change\r\n         * this by setting the\r\n         * [`elementRect`](https://github.com/taye/interact.js/pull/72).\r\n         **\r\n         - options (object) #optional an object with keys drag, resize, and/or gesture whose values are rects, Elements, CSS selectors, or 'parent' or 'self'\r\n         = (object) The current restrictions object or this Interactable\r\n         **\r\n         | interact(element).restrict({\r\n         |     // the rect will be `interact.getElementRect(element.parentNode)`\r\n         |     drag: element.parentNode,\r\n         |\r\n         |     // x and y are relative to the the interactable's origin\r\n         |     resize: { x: 100, y: 100, width: 200, height: 200 }\r\n         | })\r\n         |\r\n         | interact('.draggable').restrict({\r\n         |     // the rect will be the selected element's parent\r\n         |     drag: 'parent',\r\n         |\r\n         |     // do not restrict during normal movement.\r\n         |     // Instead, trigger only one restricted move event\r\n         |     // immediately before the end event.\r\n         |     endOnly: true,\r\n         |\r\n         |     // https://github.com/taye/interact.js/pull/72#issue-41813493\r\n         |     elementRect: { top: 0, left: 0, bottom: 1, right: 1 }\r\n         | });\r\n        \\*/\r\n        restrict: function (options) {\r\n            if (!isObject(options)) {\r\n                return this.setOptions('restrict', options);\r\n            }\r\n\r\n            var actions = ['drag', 'resize', 'gesture'],\r\n                ret;\r\n\r\n            for (var i = 0; i < actions.length; i++) {\r\n                var action = actions[i];\r\n\r\n                if (action in options) {\r\n                    var perAction = extend({\r\n                            actions: [action],\r\n                            restriction: options[action]\r\n                        }, options);\r\n\r\n                    ret = this.setOptions('restrict', perAction);\r\n                }\r\n            }\r\n\r\n            return ret;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.context\r\n         [ method ]\r\n         *\r\n         * Gets the selector context Node of the Interactable. The default is `window.document`.\r\n         *\r\n         = (Node) The context Node of this Interactable\r\n         **\r\n        \\*/\r\n        context: function () {\r\n            return this._context;\r\n        },\r\n\r\n        _context: document,\r\n\r\n        /*\\\r\n         * Interactable.ignoreFrom\r\n         [ method ]\r\n         *\r\n         * If the target of the `mousedown`, `pointerdown` or `touchstart`\r\n         * event or any of it's parents match the given CSS selector or\r\n         * Element, no drag/resize/gesture is started.\r\n         *\r\n         - newValue (string | Element | null) #optional a CSS selector string, an Element or `null` to not ignore any elements\r\n         = (string | Element | object) The current ignoreFrom value or this Interactable\r\n         **\r\n         | interact(element, { ignoreFrom: document.getElementById('no-action') });\r\n         | // or\r\n         | interact(element).ignoreFrom('input, textarea, a');\r\n        \\*/\r\n        ignoreFrom: function (newValue) {\r\n            if (trySelector(newValue)) {            // CSS selector to match event.target\r\n                this.options.ignoreFrom = newValue;\r\n                return this;\r\n            }\r\n\r\n            if (isElement(newValue)) {              // specific element\r\n                this.options.ignoreFrom = newValue;\r\n                return this;\r\n            }\r\n\r\n            return this.options.ignoreFrom;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.allowFrom\r\n         [ method ]\r\n         *\r\n         * A drag/resize/gesture is started only If the target of the\r\n         * `mousedown`, `pointerdown` or `touchstart` event or any of it's\r\n         * parents match the given CSS selector or Element.\r\n         *\r\n         - newValue (string | Element | null) #optional a CSS selector string, an Element or `null` to allow from any element\r\n         = (string | Element | object) The current allowFrom value or this Interactable\r\n         **\r\n         | interact(element, { allowFrom: document.getElementById('drag-handle') });\r\n         | // or\r\n         | interact(element).allowFrom('.handle');\r\n        \\*/\r\n        allowFrom: function (newValue) {\r\n            if (trySelector(newValue)) {            // CSS selector to match event.target\r\n                this.options.allowFrom = newValue;\r\n                return this;\r\n            }\r\n\r\n            if (isElement(newValue)) {              // specific element\r\n                this.options.allowFrom = newValue;\r\n                return this;\r\n            }\r\n\r\n            return this.options.allowFrom;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.element\r\n         [ method ]\r\n         *\r\n         * If this is not a selector Interactable, it returns the element this\r\n         * interactable represents\r\n         *\r\n         = (Element) HTML / SVG Element\r\n        \\*/\r\n        element: function () {\r\n            return this._element;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.fire\r\n         [ method ]\r\n         *\r\n         * Calls listeners for the given InteractEvent type bound globally\r\n         * and directly to this Interactable\r\n         *\r\n         - iEvent (InteractEvent) The InteractEvent object to be fired on this Interactable\r\n         = (Interactable) this Interactable\r\n        \\*/\r\n        fire: function (iEvent) {\r\n            if (!(iEvent && iEvent.type) || !contains(eventTypes, iEvent.type)) {\r\n                return this;\r\n            }\r\n\r\n            var listeners,\r\n                i,\r\n                len,\r\n                onEvent = 'on' + iEvent.type,\r\n                funcName = '';\r\n\r\n            // Interactable#on() listeners\r\n            if (iEvent.type in this._iEvents) {\r\n                listeners = this._iEvents[iEvent.type];\r\n\r\n                for (i = 0, len = listeners.length; i < len && !iEvent.immediatePropagationStopped; i++) {\r\n                    funcName = listeners[i].name;\r\n                    listeners[i](iEvent);\r\n                }\r\n            }\r\n\r\n            // interactable.onevent listener\r\n            if (isFunction(this[onEvent])) {\r\n                funcName = this[onEvent].name;\r\n                this[onEvent](iEvent);\r\n            }\r\n\r\n            // interact.on() listeners\r\n            if (iEvent.type in globalEvents && (listeners = globalEvents[iEvent.type]))  {\r\n\r\n                for (i = 0, len = listeners.length; i < len && !iEvent.immediatePropagationStopped; i++) {\r\n                    funcName = listeners[i].name;\r\n                    listeners[i](iEvent);\r\n                }\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.on\r\n         [ method ]\r\n         *\r\n         * Binds a listener for an InteractEvent or DOM event.\r\n         *\r\n         - eventType  (string | array | object) The types of events to listen for\r\n         - listener   (function) The function to be called on the given event(s)\r\n         - useCapture (boolean) #optional useCapture flag for addEventListener\r\n         = (object) This Interactable\r\n        \\*/\r\n        on: function (eventType, listener, useCapture) {\r\n            var i;\r\n\r\n            if (isString(eventType) && eventType.search(' ') !== -1) {\r\n                eventType = eventType.trim().split(/ +/);\r\n            }\r\n\r\n            if (isArray(eventType)) {\r\n                for (i = 0; i < eventType.length; i++) {\r\n                    this.on(eventType[i], listener, useCapture);\r\n                }\r\n\r\n                return this;\r\n            }\r\n\r\n            if (isObject(eventType)) {\r\n                for (var prop in eventType) {\r\n                    this.on(prop, eventType[prop], listener);\r\n                }\r\n\r\n                return this;\r\n            }\r\n\r\n            if (eventType === 'wheel') {\r\n                eventType = wheelEvent;\r\n            }\r\n\r\n            // convert to boolean\r\n            useCapture = useCapture? true: false;\r\n\r\n            if (contains(eventTypes, eventType)) {\r\n                // if this type of event was never bound to this Interactable\r\n                if (!(eventType in this._iEvents)) {\r\n                    this._iEvents[eventType] = [listener];\r\n                }\r\n                else {\r\n                    this._iEvents[eventType].push(listener);\r\n                }\r\n            }\r\n            // delegated event for selector\r\n            else if (this.selector) {\r\n                if (!delegatedEvents[eventType]) {\r\n                    delegatedEvents[eventType] = {\r\n                        selectors: [],\r\n                        contexts : [],\r\n                        listeners: []\r\n                    };\r\n\r\n                    // add delegate listener functions\r\n                    for (i = 0; i < documents.length; i++) {\r\n                        events.add(documents[i], eventType, delegateListener);\r\n                        events.add(documents[i], eventType, delegateUseCapture, true);\r\n                    }\r\n                }\r\n\r\n                var delegated = delegatedEvents[eventType],\r\n                    index;\r\n\r\n                for (index = delegated.selectors.length - 1; index >= 0; index--) {\r\n                    if (delegated.selectors[index] === this.selector\r\n                        && delegated.contexts[index] === this._context) {\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                if (index === -1) {\r\n                    index = delegated.selectors.length;\r\n\r\n                    delegated.selectors.push(this.selector);\r\n                    delegated.contexts .push(this._context);\r\n                    delegated.listeners.push([]);\r\n                }\r\n\r\n                // keep listener and useCapture flag\r\n                delegated.listeners[index].push([listener, useCapture]);\r\n            }\r\n            else {\r\n                events.add(this._element, eventType, listener, useCapture);\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.off\r\n         [ method ]\r\n         *\r\n         * Removes an InteractEvent or DOM event listener\r\n         *\r\n         - eventType  (string | array | object) The types of events that were listened for\r\n         - listener   (function) The listener function to be removed\r\n         - useCapture (boolean) #optional useCapture flag for removeEventListener\r\n         = (object) This Interactable\r\n        \\*/\r\n        off: function (eventType, listener, useCapture) {\r\n            var i;\r\n\r\n            if (isString(eventType) && eventType.search(' ') !== -1) {\r\n                eventType = eventType.trim().split(/ +/);\r\n            }\r\n\r\n            if (isArray(eventType)) {\r\n                for (i = 0; i < eventType.length; i++) {\r\n                    this.off(eventType[i], listener, useCapture);\r\n                }\r\n\r\n                return this;\r\n            }\r\n\r\n            if (isObject(eventType)) {\r\n                for (var prop in eventType) {\r\n                    this.off(prop, eventType[prop], listener);\r\n                }\r\n\r\n                return this;\r\n            }\r\n\r\n            var eventList,\r\n                index = -1;\r\n\r\n            // convert to boolean\r\n            useCapture = useCapture? true: false;\r\n\r\n            if (eventType === 'wheel') {\r\n                eventType = wheelEvent;\r\n            }\r\n\r\n            // if it is an action event type\r\n            if (contains(eventTypes, eventType)) {\r\n                eventList = this._iEvents[eventType];\r\n\r\n                if (eventList && (index = indexOf(eventList, listener)) !== -1) {\r\n                    this._iEvents[eventType].splice(index, 1);\r\n                }\r\n            }\r\n            // delegated event\r\n            else if (this.selector) {\r\n                var delegated = delegatedEvents[eventType],\r\n                    matchFound = false;\r\n\r\n                if (!delegated) { return this; }\r\n\r\n                // count from last index of delegated to 0\r\n                for (index = delegated.selectors.length - 1; index >= 0; index--) {\r\n                    // look for matching selector and context Node\r\n                    if (delegated.selectors[index] === this.selector\r\n                        && delegated.contexts[index] === this._context) {\r\n\r\n                        var listeners = delegated.listeners[index];\r\n\r\n                        // each item of the listeners array is an array: [function, useCaptureFlag]\r\n                        for (i = listeners.length - 1; i >= 0; i--) {\r\n                            var fn = listeners[i][0],\r\n                                useCap = listeners[i][1];\r\n\r\n                            // check if the listener functions and useCapture flags match\r\n                            if (fn === listener && useCap === useCapture) {\r\n                                // remove the listener from the array of listeners\r\n                                listeners.splice(i, 1);\r\n\r\n                                // if all listeners for this interactable have been removed\r\n                                // remove the interactable from the delegated arrays\r\n                                if (!listeners.length) {\r\n                                    delegated.selectors.splice(index, 1);\r\n                                    delegated.contexts .splice(index, 1);\r\n                                    delegated.listeners.splice(index, 1);\r\n\r\n                                    // remove delegate function from context\r\n                                    events.remove(this._context, eventType, delegateListener);\r\n                                    events.remove(this._context, eventType, delegateUseCapture, true);\r\n\r\n                                    // remove the arrays if they are empty\r\n                                    if (!delegated.selectors.length) {\r\n                                        delegatedEvents[eventType] = null;\r\n                                    }\r\n                                }\r\n\r\n                                // only remove one listener\r\n                                matchFound = true;\r\n                                break;\r\n                            }\r\n                        }\r\n\r\n                        if (matchFound) { break; }\r\n                    }\r\n                }\r\n            }\r\n            // remove listener from this Interatable's element\r\n            else {\r\n                events.remove(this._element, eventType, listener, useCapture);\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.set\r\n         [ method ]\r\n         *\r\n         * Reset the options of this Interactable\r\n         - options (object) The new settings to apply\r\n         = (object) This Interactable\r\n        \\*/\r\n        set: function (options) {\r\n            if (!isObject(options)) {\r\n                options = {};\r\n            }\r\n\r\n            this.options = extend({}, defaultOptions.base);\r\n\r\n            var i,\r\n                actions = ['drag', 'drop', 'resize', 'gesture'],\r\n                methods = ['draggable', 'dropzone', 'resizable', 'gesturable'],\r\n                perActions = extend(extend({}, defaultOptions.perAction), options[action] || {});\r\n\r\n            for (i = 0; i < actions.length; i++) {\r\n                var action = actions[i];\r\n\r\n                this.options[action] = extend({}, defaultOptions[action]);\r\n\r\n                this.setPerAction(action, perActions);\r\n\r\n                this[methods[i]](options[action]);\r\n            }\r\n\r\n            var settings = [\r\n                    'accept', 'actionChecker', 'allowFrom', 'deltaSource',\r\n                    'dropChecker', 'ignoreFrom', 'origin', 'preventDefault',\r\n                    'rectChecker', 'styleCursor'\r\n                ];\r\n\r\n            for (i = 0, len = settings.length; i < len; i++) {\r\n                var setting = settings[i];\r\n\r\n                this.options[setting] = defaultOptions.base[setting];\r\n\r\n                if (setting in options) {\r\n                    this[setting](options[setting]);\r\n                }\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /*\\\r\n         * Interactable.unset\r\n         [ method ]\r\n         *\r\n         * Remove this interactable from the list of interactables and remove\r\n         * it's drag, drop, resize and gesture capabilities\r\n         *\r\n         = (object) @interact\r\n        \\*/\r\n        unset: function () {\r\n            events.remove(this._element, 'all');\r\n\r\n            if (!isString(this.selector)) {\r\n                events.remove(this, 'all');\r\n                if (this.options.styleCursor) {\r\n                    this._element.style.cursor = '';\r\n                }\r\n            }\r\n            else {\r\n                // remove delegated events\r\n                for (var type in delegatedEvents) {\r\n                    var delegated = delegatedEvents[type];\r\n\r\n                    for (var i = 0; i < delegated.selectors.length; i++) {\r\n                        if (delegated.selectors[i] === this.selector\r\n                            && delegated.contexts[i] === this._context) {\r\n\r\n                            delegated.selectors.splice(i, 1);\r\n                            delegated.contexts .splice(i, 1);\r\n                            delegated.listeners.splice(i, 1);\r\n\r\n                            // remove the arrays if they are empty\r\n                            if (!delegated.selectors.length) {\r\n                                delegatedEvents[type] = null;\r\n                            }\r\n                        }\r\n\r\n                        events.remove(this._context, type, delegateListener);\r\n                        events.remove(this._context, type, delegateUseCapture, true);\r\n\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            this.dropzone(false);\r\n\r\n            interactables.splice(indexOf(interactables, this), 1);\r\n\r\n            return interact;\r\n        }\r\n    };\r\n\r\n    function warnOnce (method, message) {\r\n        var warned = false;\r\n\r\n        return function () {\r\n            if (!warned) {\r\n                window.console.warn(message);\r\n                warned = true;\r\n            }\r\n\r\n            return method.apply(this, arguments);\r\n        };\r\n    }\r\n\r\n    Interactable.prototype.snap = warnOnce(Interactable.prototype.snap,\r\n         'Interactable#snap is deprecated. See the new documentation for snapping at http://interactjs.io/docs/snapping');\r\n    Interactable.prototype.restrict = warnOnce(Interactable.prototype.restrict,\r\n         'Interactable#restrict is deprecated. See the new documentation for resticting at http://interactjs.io/docs/restriction');\r\n    Interactable.prototype.inertia = warnOnce(Interactable.prototype.inertia,\r\n         'Interactable#inertia is deprecated. See the new documentation for inertia at http://interactjs.io/docs/inertia');\r\n    Interactable.prototype.autoScroll = warnOnce(Interactable.prototype.autoScroll,\r\n         'Interactable#autoScroll is deprecated. See the new documentation for autoScroll at http://interactjs.io/docs/#autoscroll');\r\n    Interactable.prototype.squareResize = warnOnce(Interactable.prototype.squareResize,\r\n         'Interactable#squareResize is deprecated. See http://interactjs.io/docs/#resize-square');\r\n\r\n    Interactable.prototype.accept = warnOnce(Interactable.prototype.accept,\r\n         'Interactable#accept is deprecated. use Interactable#dropzone({ accept: target }) instead');\r\n    Interactable.prototype.dropChecker = warnOnce(Interactable.prototype.dropChecker,\r\n         'Interactable#dropChecker is deprecated. use Interactable#dropzone({ dropChecker: checkerFunction }) instead');\r\n    Interactable.prototype.context = warnOnce(Interactable.prototype.context,\r\n         'Interactable#context as a method is deprecated. It will soon be a DOM Node instead');\r\n\r\n    /*\\\r\n     * interact.isSet\r\n     [ method ]\r\n     *\r\n     * Check if an element has been set\r\n     - element (Element) The Element being searched for\r\n     = (boolean) Indicates if the element or CSS selector was previously passed to interact\r\n    \\*/\r\n    interact.isSet = function(element, options) {\r\n        return interactables.indexOfElement(element, options && options.context) !== -1;\r\n    };\r\n\r\n    /*\\\r\n     * interact.on\r\n     [ method ]\r\n     *\r\n     * Adds a global listener for an InteractEvent or adds a DOM event to\r\n     * `document`\r\n     *\r\n     - type       (string | array | object) The types of events to listen for\r\n     - listener   (function) The function to be called on the given event(s)\r\n     - useCapture (boolean) #optional useCapture flag for addEventListener\r\n     = (object) interact\r\n    \\*/\r\n    interact.on = function (type, listener, useCapture) {\r\n        if (isString(type) && type.search(' ') !== -1) {\r\n            type = type.trim().split(/ +/);\r\n        }\r\n\r\n        if (isArray(type)) {\r\n            for (var i = 0; i < type.length; i++) {\r\n                interact.on(type[i], listener, useCapture);\r\n            }\r\n\r\n            return interact;\r\n        }\r\n\r\n        if (isObject(type)) {\r\n            for (var prop in type) {\r\n                interact.on(prop, type[prop], listener);\r\n            }\r\n\r\n            return interact;\r\n        }\r\n\r\n        // if it is an InteractEvent type, add listener to globalEvents\r\n        if (contains(eventTypes, type)) {\r\n            // if this type of event was never bound\r\n            if (!globalEvents[type]) {\r\n                globalEvents[type] = [listener];\r\n            }\r\n            else {\r\n                globalEvents[type].push(listener);\r\n            }\r\n        }\r\n        // If non InteractEvent type, addEventListener to document\r\n        else {\r\n            events.add(document, type, listener, useCapture);\r\n        }\r\n\r\n        return interact;\r\n    };\r\n\r\n    /*\\\r\n     * interact.off\r\n     [ method ]\r\n     *\r\n     * Removes a global InteractEvent listener or DOM event from `document`\r\n     *\r\n     - type       (string | array | object) The types of events that were listened for\r\n     - listener   (function) The listener function to be removed\r\n     - useCapture (boolean) #optional useCapture flag for removeEventListener\r\n     = (object) interact\r\n     \\*/\r\n    interact.off = function (type, listener, useCapture) {\r\n        if (isString(type) && type.search(' ') !== -1) {\r\n            type = type.trim().split(/ +/);\r\n        }\r\n\r\n        if (isArray(type)) {\r\n            for (var i = 0; i < type.length; i++) {\r\n                interact.off(type[i], listener, useCapture);\r\n            }\r\n\r\n            return interact;\r\n        }\r\n\r\n        if (isObject(type)) {\r\n            for (var prop in type) {\r\n                interact.off(prop, type[prop], listener);\r\n            }\r\n\r\n            return interact;\r\n        }\r\n\r\n        if (!contains(eventTypes, type)) {\r\n            events.remove(document, type, listener, useCapture);\r\n        }\r\n        else {\r\n            var index;\r\n\r\n            if (type in globalEvents\r\n                && (index = indexOf(globalEvents[type], listener)) !== -1) {\r\n                globalEvents[type].splice(index, 1);\r\n            }\r\n        }\r\n\r\n        return interact;\r\n    };\r\n\r\n    /*\\\r\n     * interact.enableDragging\r\n     [ method ]\r\n     *\r\n     * Deprecated.\r\n     *\r\n     * Returns or sets whether dragging is enabled for any Interactables\r\n     *\r\n     - newValue (boolean) #optional `true` to allow the action; `false` to disable action for all Interactables\r\n     = (boolean | object) The current setting or interact\r\n    \\*/\r\n    interact.enableDragging = warnOnce(function (newValue) {\r\n        if (newValue !== null && newValue !== undefined) {\r\n            actionIsEnabled.drag = newValue;\r\n\r\n            return interact;\r\n        }\r\n        return actionIsEnabled.drag;\r\n    }, 'interact.enableDragging is deprecated and will soon be removed.');\r\n\r\n    /*\\\r\n     * interact.enableResizing\r\n     [ method ]\r\n     *\r\n     * Deprecated.\r\n     *\r\n     * Returns or sets whether resizing is enabled for any Interactables\r\n     *\r\n     - newValue (boolean) #optional `true` to allow the action; `false` to disable action for all Interactables\r\n     = (boolean | object) The current setting or interact\r\n    \\*/\r\n    interact.enableResizing = warnOnce(function (newValue) {\r\n        if (newValue !== null && newValue !== undefined) {\r\n            actionIsEnabled.resize = newValue;\r\n\r\n            return interact;\r\n        }\r\n        return actionIsEnabled.resize;\r\n    }, 'interact.enableResizing is deprecated and will soon be removed.');\r\n\r\n    /*\\\r\n     * interact.enableGesturing\r\n     [ method ]\r\n     *\r\n     * Deprecated.\r\n     *\r\n     * Returns or sets whether gesturing is enabled for any Interactables\r\n     *\r\n     - newValue (boolean) #optional `true` to allow the action; `false` to disable action for all Interactables\r\n     = (boolean | object) The current setting or interact\r\n    \\*/\r\n    interact.enableGesturing = warnOnce(function (newValue) {\r\n        if (newValue !== null && newValue !== undefined) {\r\n            actionIsEnabled.gesture = newValue;\r\n\r\n            return interact;\r\n        }\r\n        return actionIsEnabled.gesture;\r\n    }, 'interact.enableGesturing is deprecated and will soon be removed.');\r\n\r\n    interact.eventTypes = eventTypes;\r\n\r\n    /*\\\r\n     * interact.debug\r\n     [ method ]\r\n     *\r\n     * Returns debugging data\r\n     = (object) An object with properties that outline the current state and expose internal functions and variables\r\n    \\*/\r\n    interact.debug = function () {\r\n        var interaction = interactions[0] || new Interaction();\r\n\r\n        return {\r\n            interactions          : interactions,\r\n            target                : interaction.target,\r\n            dragging              : interaction.dragging,\r\n            resizing              : interaction.resizing,\r\n            gesturing             : interaction.gesturing,\r\n            prepared              : interaction.prepared,\r\n            matches               : interaction.matches,\r\n            matchElements         : interaction.matchElements,\r\n\r\n            prevCoords            : interaction.prevCoords,\r\n            startCoords           : interaction.startCoords,\r\n\r\n            pointerIds            : interaction.pointerIds,\r\n            pointers              : interaction.pointers,\r\n            addPointer            : listeners.addPointer,\r\n            removePointer         : listeners.removePointer,\r\n            recordPointer        : listeners.recordPointer,\r\n\r\n            snap                  : interaction.snapStatus,\r\n            restrict              : interaction.restrictStatus,\r\n            inertia               : interaction.inertiaStatus,\r\n\r\n            downTime              : interaction.downTimes[0],\r\n            downEvent             : interaction.downEvent,\r\n            downPointer           : interaction.downPointer,\r\n            prevEvent             : interaction.prevEvent,\r\n\r\n            Interactable          : Interactable,\r\n            interactables         : interactables,\r\n            pointerIsDown         : interaction.pointerIsDown,\r\n            defaultOptions        : defaultOptions,\r\n            defaultActionChecker  : defaultActionChecker,\r\n\r\n            actionCursors         : actionCursors,\r\n            dragMove              : listeners.dragMove,\r\n            resizeMove            : listeners.resizeMove,\r\n            gestureMove           : listeners.gestureMove,\r\n            pointerUp             : listeners.pointerUp,\r\n            pointerDown           : listeners.pointerDown,\r\n            pointerMove           : listeners.pointerMove,\r\n            pointerHover          : listeners.pointerHover,\r\n\r\n            eventTypes            : eventTypes,\r\n\r\n            events                : events,\r\n            globalEvents          : globalEvents,\r\n            delegatedEvents       : delegatedEvents,\r\n\r\n            prefixedPropREs       : prefixedPropREs\r\n        };\r\n    };\r\n\r\n    // expose the functions used to calculate multi-touch properties\r\n    interact.getPointerAverage = pointerAverage;\r\n    interact.getTouchBBox     = touchBBox;\r\n    interact.getTouchDistance = touchDistance;\r\n    interact.getTouchAngle    = touchAngle;\r\n\r\n    interact.getElementRect         = getElementRect;\r\n    interact.getElementClientRect   = getElementClientRect;\r\n    interact.matchesSelector        = matchesSelector;\r\n    interact.closest                = closest;\r\n\r\n    /*\\\r\n     * interact.margin\r\n     [ method ]\r\n     *\r\n     * Deprecated. Use `interact(target).resizable({ margin: number });` instead.\r\n     * Returns or sets the margin for autocheck resizing used in\r\n     * @Interactable.getAction. That is the distance from the bottom and right\r\n     * edges of an element clicking in which will start resizing\r\n     *\r\n     - newValue (number) #optional\r\n     = (number | interact) The current margin value or interact\r\n    \\*/\r\n    interact.margin = warnOnce(function (newvalue) {\r\n        if (isNumber(newvalue)) {\r\n            margin = newvalue;\r\n\r\n            return interact;\r\n        }\r\n        return margin;\r\n    },\r\n    'interact.margin is deprecated. Use interact(target).resizable({ margin: number }); instead.') ;\r\n\r\n    /*\\\r\n     * interact.supportsTouch\r\n     [ method ]\r\n     *\r\n     = (boolean) Whether or not the browser supports touch input\r\n    \\*/\r\n    interact.supportsTouch = function () {\r\n        return supportsTouch;\r\n    };\r\n\r\n    /*\\\r\n     * interact.supportsPointerEvent\r\n     [ method ]\r\n     *\r\n     = (boolean) Whether or not the browser supports PointerEvents\r\n    \\*/\r\n    interact.supportsPointerEvent = function () {\r\n        return supportsPointerEvent;\r\n    };\r\n\r\n    /*\\\r\n     * interact.stop\r\n     [ method ]\r\n     *\r\n     * Cancels all interactions (end events are not fired)\r\n     *\r\n     - event (Event) An event on which to call preventDefault()\r\n     = (object) interact\r\n    \\*/\r\n    interact.stop = function (event) {\r\n        for (var i = interactions.length - 1; i >= 0; i--) {\r\n            interactions[i].stop(event);\r\n        }\r\n\r\n        return interact;\r\n    };\r\n\r\n    /*\\\r\n     * interact.dynamicDrop\r\n     [ method ]\r\n     *\r\n     * Returns or sets whether the dimensions of dropzone elements are\r\n     * calculated on every dragmove or only on dragstart for the default\r\n     * dropChecker\r\n     *\r\n     - newValue (boolean) #optional True to check on each move. False to check only before start\r\n     = (boolean | interact) The current setting or interact\r\n    \\*/\r\n    interact.dynamicDrop = function (newValue) {\r\n        if (isBool(newValue)) {\r\n            //if (dragging && dynamicDrop !== newValue && !newValue) {\r\n                //calcRects(dropzones);\r\n            //}\r\n\r\n            dynamicDrop = newValue;\r\n\r\n            return interact;\r\n        }\r\n        return dynamicDrop;\r\n    };\r\n\r\n    /*\\\r\n     * interact.pointerMoveTolerance\r\n     [ method ]\r\n     * Returns or sets the distance the pointer must be moved before an action\r\n     * sequence occurs. This also affects tolerance for tap events.\r\n     *\r\n     - newValue (number) #optional The movement from the start position must be greater than this value\r\n     = (number | Interactable) The current setting or interact\r\n    \\*/\r\n    interact.pointerMoveTolerance = function (newValue) {\r\n        if (isNumber(newValue)) {\r\n            pointerMoveTolerance = newValue;\r\n\r\n            return this;\r\n        }\r\n\r\n        return pointerMoveTolerance;\r\n    };\r\n\r\n    /*\\\r\n     * interact.maxInteractions\r\n     [ method ]\r\n     **\r\n     * Returns or sets the maximum number of concurrent interactions allowed.\r\n     * By default only 1 interaction is allowed at a time (for backwards\r\n     * compatibility). To allow multiple interactions on the same Interactables\r\n     * and elements, you need to enable it in the draggable, resizable and\r\n     * gesturable `'max'` and `'maxPerElement'` options.\r\n     **\r\n     - newValue (number) #optional Any number. newValue <= 0 means no interactions.\r\n    \\*/\r\n    interact.maxInteractions = function (newValue) {\r\n        if (isNumber(newValue)) {\r\n            maxInteractions = newValue;\r\n\r\n            return this;\r\n        }\r\n\r\n        return maxInteractions;\r\n    };\r\n\r\n    interact.createSnapGrid = function (grid) {\r\n        return function (x, y) {\r\n            var offsetX = 0,\r\n                offsetY = 0;\r\n\r\n            if (isObject(grid.offset)) {\r\n                offsetX = grid.offset.x;\r\n                offsetY = grid.offset.y;\r\n            }\r\n\r\n            var gridx = Math.round((x - offsetX) / grid.x),\r\n                gridy = Math.round((y - offsetY) / grid.y),\r\n\r\n                newX = gridx * grid.x + offsetX,\r\n                newY = gridy * grid.y + offsetY;\r\n\r\n            return {\r\n                x: newX,\r\n                y: newY,\r\n                range: grid.range\r\n            };\r\n        };\r\n    };\r\n\r\n    function endAllInteractions (event) {\r\n        for (var i = 0; i < interactions.length; i++) {\r\n            interactions[i].pointerEnd(event, event);\r\n        }\r\n    }\r\n\r\n    function listenToDocument (doc) {\r\n        if (contains(documents, doc)) { return; }\r\n\r\n        var win = doc.defaultView || doc.parentWindow;\r\n\r\n        // add delegate event listener\r\n        for (var eventType in delegatedEvents) {\r\n            events.add(doc, eventType, delegateListener);\r\n            events.add(doc, eventType, delegateUseCapture, true);\r\n        }\r\n\r\n        if (PointerEvent) {\r\n            if (PointerEvent === win.MSPointerEvent) {\r\n                pEventTypes = {\r\n                    up: 'MSPointerUp', down: 'MSPointerDown', over: 'mouseover',\r\n                    out: 'mouseout', move: 'MSPointerMove', cancel: 'MSPointerCancel' };\r\n            }\r\n            else {\r\n                pEventTypes = {\r\n                    up: 'pointerup', down: 'pointerdown', over: 'pointerover',\r\n                    out: 'pointerout', move: 'pointermove', cancel: 'pointercancel' };\r\n            }\r\n\r\n            events.add(doc, pEventTypes.down  , listeners.selectorDown );\r\n            events.add(doc, pEventTypes.move  , listeners.pointerMove  );\r\n            events.add(doc, pEventTypes.over  , listeners.pointerOver  );\r\n            events.add(doc, pEventTypes.out   , listeners.pointerOut   );\r\n            events.add(doc, pEventTypes.up    , listeners.pointerUp    );\r\n            events.add(doc, pEventTypes.cancel, listeners.pointerCancel);\r\n\r\n            // autoscroll\r\n            events.add(doc, pEventTypes.move, listeners.autoScrollMove);\r\n        }\r\n        else {\r\n            events.add(doc, 'mousedown', listeners.selectorDown);\r\n            events.add(doc, 'mousemove', listeners.pointerMove );\r\n            events.add(doc, 'mouseup'  , listeners.pointerUp   );\r\n            events.add(doc, 'mouseover', listeners.pointerOver );\r\n            events.add(doc, 'mouseout' , listeners.pointerOut  );\r\n\r\n            events.add(doc, 'touchstart' , listeners.selectorDown );\r\n            events.add(doc, 'touchmove'  , listeners.pointerMove  );\r\n            events.add(doc, 'touchend'   , listeners.pointerUp    );\r\n            events.add(doc, 'touchcancel', listeners.pointerCancel);\r\n\r\n            // autoscroll\r\n            events.add(doc, 'mousemove', listeners.autoScrollMove);\r\n            events.add(doc, 'touchmove', listeners.autoScrollMove);\r\n        }\r\n\r\n        events.add(win, 'blur', endAllInteractions);\r\n\r\n        try {\r\n            if (win.frameElement) {\r\n                var parentDoc = win.frameElement.ownerDocument,\r\n                    parentWindow = parentDoc.defaultView;\r\n\r\n                events.add(parentDoc   , 'mouseup'      , listeners.pointerEnd);\r\n                events.add(parentDoc   , 'touchend'     , listeners.pointerEnd);\r\n                events.add(parentDoc   , 'touchcancel'  , listeners.pointerEnd);\r\n                events.add(parentDoc   , 'pointerup'    , listeners.pointerEnd);\r\n                events.add(parentDoc   , 'MSPointerUp'  , listeners.pointerEnd);\r\n                events.add(parentWindow, 'blur'         , endAllInteractions );\r\n            }\r\n        }\r\n        catch (error) {\r\n            interact.windowParentError = error;\r\n        }\r\n\r\n        // prevent native HTML5 drag on interact.js target elements\r\n        events.add(doc, 'dragstart', function (event) {\r\n            for (var i = 0; i < interactions.length; i++) {\r\n                var interaction = interactions[i];\r\n\r\n                if (interaction.element\r\n                    && (interaction.element === event.target\r\n                        || nodeContains(interaction.element, event.target))) {\r\n\r\n                    interaction.checkAndPreventDefault(event, interaction.target, interaction.element);\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n\r\n        if (events.useAttachEvent) {\r\n            // For IE's lack of Event#preventDefault\r\n            events.add(doc, 'selectstart', function (event) {\r\n                var interaction = interactions[0];\r\n\r\n                if (interaction.currentAction()) {\r\n                    interaction.checkAndPreventDefault(event);\r\n                }\r\n            });\r\n\r\n            // For IE's bad dblclick event sequence\r\n            events.add(doc, 'dblclick', doOnInteractions('ie8Dblclick'));\r\n        }\r\n\r\n        documents.push(doc);\r\n    }\r\n\r\n    listenToDocument(document);\r\n\r\n    function indexOf (array, target) {\r\n        for (var i = 0, len = array.length; i < len; i++) {\r\n            if (array[i] === target) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        return -1;\r\n    }\r\n\r\n    function contains (array, target) {\r\n        return indexOf(array, target) !== -1;\r\n    }\r\n\r\n    function matchesSelector (element, selector, nodeList) {\r\n        if (ie8MatchesSelector) {\r\n            return ie8MatchesSelector(element, selector, nodeList);\r\n        }\r\n\r\n        // remove /deep/ from selectors if shadowDOM polyfill is used\r\n        if (window !== realWindow) {\r\n            selector = selector.replace(/\\/deep\\//g, ' ');\r\n        }\r\n\r\n        return element[prefixedMatchesSelector](selector);\r\n    }\r\n\r\n    function matchesUpTo (element, selector, limit) {\r\n        while (isElement(element)) {\r\n            if (matchesSelector(element, selector)) {\r\n                return true;\r\n            }\r\n\r\n            element = parentElement(element);\r\n\r\n            if (element === limit) {\r\n                return matchesSelector(element, selector);\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    // For IE8's lack of an Element#matchesSelector\r\n    // taken from http://tanalin.com/en/blog/2012/12/matches-selector-ie8/ and modified\r\n    if (!(prefixedMatchesSelector in Element.prototype) || !isFunction(Element.prototype[prefixedMatchesSelector])) {\r\n        ie8MatchesSelector = function (element, selector, elems) {\r\n            elems = elems || element.parentNode.querySelectorAll(selector);\r\n\r\n            for (var i = 0, len = elems.length; i < len; i++) {\r\n                if (elems[i] === element) {\r\n                    return true;\r\n                }\r\n            }\r\n\r\n            return false;\r\n        };\r\n    }\r\n\r\n    // requestAnimationFrame polyfill\r\n    (function() {\r\n        var lastTime = 0,\r\n            vendors = ['ms', 'moz', 'webkit', 'o'];\r\n\r\n        for(var x = 0; x < vendors.length && !realWindow.requestAnimationFrame; ++x) {\r\n            reqFrame = realWindow[vendors[x]+'RequestAnimationFrame'];\r\n            cancelFrame = realWindow[vendors[x]+'CancelAnimationFrame'] || realWindow[vendors[x]+'CancelRequestAnimationFrame'];\r\n        }\r\n\r\n        if (!reqFrame) {\r\n            reqFrame = function(callback) {\r\n                var currTime = new Date().getTime(),\r\n                    timeToCall = Math.max(0, 16 - (currTime - lastTime)),\r\n                    id = setTimeout(function() { callback(currTime + timeToCall); },\r\n                  timeToCall);\r\n                lastTime = currTime + timeToCall;\r\n                return id;\r\n            };\r\n        }\r\n\r\n        if (!cancelFrame) {\r\n            cancelFrame = function(id) {\r\n                clearTimeout(id);\r\n            };\r\n        }\r\n    }());\r\n\r\n    /* global exports: true, module, define */\r\n\r\n    // http://documentcloud.github.io/underscore/docs/underscore.html#section-11\r\n    if (typeof exports !== 'undefined') {\r\n        if (typeof module !== 'undefined' && module.exports) {\r\n            exports = module.exports = interact;\r\n        }\r\n        exports.interact = interact;\r\n    }\r\n    // AMD\r\n    else if (typeof define === 'function' && define.amd) {\r\n        define('interact', function() {\r\n            return interact;\r\n        });\r\n    }\r\n    else {\r\n        realWindow.interact = interact;\r\n    }\r\n\r\n} (typeof window === 'undefined'? undefined : window));","import {inject} from 'aurelia-framework';\r\nimport {PictureService} from '../../services/picture-service';\r\nimport * as interact from './interact';\r\n\r\n@inject(PictureService)\r\nexport class PictureTest {\r\n\r\n    pictureUrl = '';\r\n    isLoaded = false;\r\n    \r\n    constructor(pictureService) {\r\n        this.pictureService = pictureService;\r\n    }\r\n\r\n    created() {\r\n        console.log(interact.interact);\r\n        interact.interact('#dragTest')\r\n                .draggable({\r\n                    // enable inertial throwing\r\n                    inertia: true,\r\n                    // keep the element within the area of it's parent\r\n                    restrict: {\r\n                        restriction: \"parent\",\r\n                        endOnly: true,\r\n                        elementRect: { top: -0.1, left: -0.1, bottom: 1.1, right: 1.1 }\r\n                    },\r\n                    // enable autoScroll\r\n                    autoScroll: true,\r\n                    // call this function on every dragmove event\r\n                    onmove: this.dragMoveListener,\r\n                    // call this function on every dragend event\r\n                    onend: function (event) {\r\n                    var textEl = event.target.querySelector('p');\r\n                        textEl && (textEl.textContent =\r\n                            'moved a distance of '\r\n                            + (Math.sqrt(event.dx * event.dx +\r\n                                        event.dy * event.dy)|0) + 'px');\r\n                    }\r\n                })\r\n                .resizable({\r\n                    preserveAspectRatio: true,\r\n                    edges: { left: true, right: true, bottom: true, top: true }\r\n                })\r\n                .on('resizemove', function (event) {\r\n                    var target = event.target,\r\n                        x = (parseFloat(target.getAttribute('data-x')) || 0),\r\n                        y = (parseFloat(target.getAttribute('data-y')) || 0);\r\n\r\n                    // update the element's style\r\n                    target.style.width  = event.rect.width + 'px';\r\n                    target.style.height = event.rect.height + 'px';\r\n\r\n                    // translate when resizing from top or left edges\r\n                    x += event.deltaRect.left;\r\n                    y += event.deltaRect.top;\r\n\r\n                    target.style.webkitTransform = target.style.transform =\r\n                        'translate(' + x + 'px,' + y + 'px)';\r\n\r\n                    target.setAttribute('data-x', x);\r\n                    target.setAttribute('data-y', y);\r\n                    target.textContent = Math.round(event.rect.width) + '' + Math.round(event.rect.height);\r\n                });\r\n    }\r\n\r\n    test() {\r\n        this.pictureService.getPicture('testFrame', false).then(\r\n            (success) => {\r\n                console.log('SUCCESS');\r\n                console.log(success);\r\n                var response = JSON.parse(success.response);\r\n                this.pictureUrl = response.imageUrl;\r\n                this.isLoaded = true;\r\n            },\r\n            (failure) => {\r\n                console.log('FAILURE');\r\n                console.log(failure);\r\n            }\r\n        )\r\n    }\r\n    \r\n    dragMoveListener(event) {\r\n        // console.log(event);\r\n      var target = event.target,\r\n          // keep the dragged position in the data-x/data-y attributes\r\n          x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx,\r\n          y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;\r\n\r\n      // translate the element\r\n      target.style.webkitTransform =\r\n          target.style.transform =\r\n          'translate(' + x + 'px, ' + y + 'px)';\r\n\r\n      // update the posiion attributes\r\n      target.setAttribute('data-x', x);\r\n      target.setAttribute('data-y', y);\r\n  }\r\n}","import {inject} from 'aurelia-framework';\r\nimport {PictureService} from '../../services/picture-service';\r\n\r\n@inject(PictureService)\r\nexport class PictureUpload {\r\n    constructor(pictureService) {\r\n        this.pictureService = pictureService;\r\n    }\r\n\r\n    doUpload() {\r\n        this.pictureService.putPicture('test-file-upload', this.selectedFiles[0], 'png').then(\r\n            (success) => {\r\n                console.log(success);\r\n            },\r\n            (failure) => {\r\n                console.log(failure);\r\n            }\r\n        );\r\n    }\r\n\r\n     clearFiles() {\r\n        document.getElementById(\"files\").value = \"\";\r\n    }\r\n}","import {inject} from 'aurelia-framework';\r\nimport {UserService} from '../../services/user-service';\r\n\r\n@inject(UserService)\r\nexport class UserList {\r\n    constructor(userService) {\r\n        this.userService = userService;\r\n        // this.users = [];\r\n        this.error = {};\r\n        this.isWorking = false;\r\n    }\r\n\r\n    created() {\r\n        this.updateUserList(0, 10);\r\n    }\r\n\r\n    updateUserList(page, size) {\r\n        this.isWorking = true;\r\n        this.userService.getUsers(page, size)\r\n                .then(\r\n                    userResponse => {\r\n                        this.users = JSON.parse(userResponse.response);\r\n                        this.isWorking = false;\r\n                    }, \r\n                    errorResponse => {\r\n                        this.error.title = 'Ups';\r\n                        this.error.description = 'Parece que el sistema no response, por favor intenta nuevamente mas tarde.';\r\n                        this.isWorking = false;\r\n                    }\r\n                );\r\n    }\r\n\r\n}","import {inject, NewInstance} from 'aurelia-framework';\r\nimport {ValidationController, validateTrigger, ValidationRules} from 'aurelia-validation';\r\nimport {UserService} from '../../services/user-service';\r\n\r\n@inject(UserService,NewInstance.of(ValidationController))\r\nexport class UserLogin {\r\n    \r\n    email = '';\r\n    password = '';\r\n\r\n    constructor(userService, validationController) {\r\n        this.userService = userService;\r\n        this.validationController = validationController;\r\n        this.isWorking = false;\r\n        this.success = false;\r\n        this.serverError = {};\r\n    }\r\n\r\n    created() {\r\n        this.validationController.validateTrigger = validateTrigger.manual;\r\n\r\n        ValidationRules\r\n            .ensure(\"email\").email().required().withMessage(\"Por favor ingrese un email.\")\r\n            .ensure(\"password\").required().withMessage(\"Por favor ingrese la contrasea.\")\r\n            .on(this);\r\n    }\r\n\r\n    login() {\r\n        this.success = false;\r\n        this.isWorking = true;\r\n\r\n        var userCredentials = { \r\n            email: this.email, \r\n            password: this.password\r\n        }\r\n\r\n        setTimeout(() => {\r\n            this.validationController.validate()\r\n                .then((validation) => {\r\n                    if(validation.valid) {\r\n                        this.success = true;\r\n                    }\r\n                }).then(() => this.isWorking = false);\r\n        }, 1000);\r\n    }\r\n}","import {inject, NewInstance} from 'aurelia-framework';\r\nimport {ValidationController, validateTrigger, ValidationRules} from 'aurelia-validation';\r\nimport {UserService} from '../../services/user-service';\r\n\r\n@inject(UserService,NewInstance.of(ValidationController))\r\nexport class UserRegistration {\r\n    \r\n    firstName = '';\r\n    lastName = '';\r\n    email = '';\r\n    password = '';\r\n\r\n    constructor(userService, validationController) {\r\n        this.userService = userService;\r\n        this.validationController = validationController;\r\n        this.isWorking = false;\r\n        this.success = false;\r\n        this.serverError = {};\r\n    }\r\n\r\n    created() {\r\n        this.validationController.validateTrigger = validateTrigger.manual;\r\n\r\n        ValidationRules\r\n            .ensure(\"firstName\").required().withMessage(\"El nombre no puede estar vacio.\")\r\n            .ensure(\"lastName\").required().withMessage(\"El apellido no puede estar vacio.\")\r\n            .ensure(\"email\").email().required().withMessage(\"El email no es valido, por favor ingrese un email valido.\")\r\n            .ensure(\"password\").minLength(8).required().withMessage(\"La contrasea debe tener al menos 8 caracteres\")\r\n            .on(this);\r\n    }\r\n\r\n    register() {\r\n        this.success = false;\r\n        this.isWorking = true;\r\n\r\n        var user = { \r\n            firstName: this.firstName,\r\n            lastName: this.lastName,\r\n            email: this.email, \r\n            password: this.password\r\n        }\r\n\r\n        setTimeout(() => {\r\n            this.validationController.validate()\r\n                .then((validation) => {\r\n                    if(validation.valid) {\r\n                        this.success = true;\r\n                    }\r\n                }).then(() => this.isWorking = false);\r\n        }, 1000);\r\n    }\r\n\r\n    postUser(user) {\r\n        this.userService.postUser(user).then(\r\n            () => {\r\n                this.success = true;\r\n            },\r\n            failure => {\r\n                var failureMessage = JSON.parse(failure.response);\r\n                this.serverError = {\r\n                    title: failureMessage.title,\r\n                    description: failureMessage.description\r\n                };\r\n            }\r\n        ).then(() => this.isWorking = false);\r\n    }\r\n\r\n}","export class NavBar {\r\n    \r\n}","export class LoginModal {\r\n    \r\n}","export class RegistrationModal {\r\n    \r\n}","export class SessionService {\r\n    setCookie(cname, cvalue, exdays) {\r\n        var d = new Date();\r\n        d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));\r\n        var expires = \"expires=\" + d.toUTCString();\r\n        document.cookie = cname + \"=\" + cvalue + \";\" + expires + \";path=/\";\r\n    }\r\n\r\n    getCookie(cname) {\r\n        var name = cname + \"=\";\r\n        var ca = document.cookie.split(';');\r\n        for (var i = 0; i < ca.length; i++) {\r\n            var c = ca[i];\r\n            while (c.charAt(0) == ' ') {\r\n                c = c.substring(1);\r\n            }\r\n            if (c.indexOf(name) == 0) {\r\n                return c.substring(name.length, c.length);\r\n            }\r\n        }\r\n        return \"\";\r\n    }\r\n\r\n}","export class SessionService {\r\n    setCookie(cookieName, cookieValue, expirationDays) {\r\n        var date = new Date();\r\n        date.setDate(date.getDate() + (expirationDays * 24 * 60 * 60 * 1000));\r\n        var expires = \"expires=\" + date.toUTCString();\r\n        document.cookie = cookieName + \"=\" + cookieValue + \";\" + expires + \";path=/\";\r\n    }\r\n\r\n    getCookie(cookieName) {\r\n        var nameEQ = cookieName + \"=\";\r\n        var ca = document.cookie.split(';');\r\n        for(var i=0;i < ca.length;i++) {\r\n            var c = ca[i];\r\n            while (c.charAt(0)==' ') c = c.substring(1,c.length);\r\n            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\r\n        }\r\n        return null;\r\n    }\r\n}"],"sourceRoot":".."}